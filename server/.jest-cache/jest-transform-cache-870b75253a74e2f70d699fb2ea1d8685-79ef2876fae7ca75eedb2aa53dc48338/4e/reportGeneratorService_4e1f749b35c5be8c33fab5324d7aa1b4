df472635e4e5f7d0aced95a7af482829
import { prisma } from '../prisma';
import { generateContent } from './llmService';
import logger from '../logger';
export class ReportGeneratorService {
    prisma;
    constructor(prismaClient) {
        this.prisma = prismaClient || prisma;
    }
    async generateReport(request) {
        try {
            // Fetch student data
            const student = await this.prisma.student.findUnique({
                where: { id: request.studentId },
                include: {
                    user: true,
                    artifacts: {
                        where: {
                            createdAt: {
                                gte: request.startDate,
                                lte: request.endDate,
                            },
                        },
                    },
                    reflections: {
                        where: {
                            createdAt: {
                                gte: request.startDate,
                                lte: request.endDate,
                            },
                        },
                    },
                    goals: {
                        where: {
                            OR: [{ status: 'active' }, { status: 'completed' }],
                        },
                    },
                },
            });
            if (!student) {
                throw new Error('Student not found');
            }
            // Generate report based on type
            let report;
            switch (request.reportType) {
                case 'progress':
                    report = await this.generateProgressReport(student, request);
                    break;
                case 'narrative':
                    report = await this.generateNarrativeReport(student, request);
                    break;
                case 'term_summary':
                    report = await this.generateTermSummary(student, request);
                    break;
                case 'report_card':
                    report = await this.generateReportCard(student, request);
                    break;
                default:
                    throw new Error('Invalid report type');
            }
            return report;
        }
        catch (error) {
            logger.error('Failed to generate report:', error);
            throw error;
        }
    }
    async generateProgressReport(student, request) {
        const sections = [];
        // Assessment functionality removed - focus on artifacts and reflections
        if (student.artifacts.length > 0 || student.reflections.length > 0) {
            sections.push({
                title: request.language === 'fr' ? 'Progrès académique' : 'Academic Progress',
                content: await this.generateProgressFromArtifacts(student.artifacts, student.reflections, request.language),
                data: { artifacts: student.artifacts, reflections: student.reflections },
            });
        }
        // Goals Section
        if (request.includeGoals && student.goals.length > 0) {
            sections.push({
                title: request.language === 'fr' ? 'Objectifs' : 'Goals',
                content: await this.generateGoalsNarrative(student.goals, request.language),
                data: { goals: student.goals },
            });
        }
        // Overall Comments
        const overallComments = await this.generateOverallComments(student, sections, request.language);
        // Next Steps
        const nextSteps = await this.generateNextSteps(student, sections, request.language);
        return {
            studentName: `${student.firstName} ${student.lastName}`,
            period: `${request.startDate.toLocaleDateString()} - ${request.endDate.toLocaleDateString()}`,
            sections,
            overallComments,
            nextSteps,
        };
    }
    async generateNarrativeReport(student, request) {
        // Gather comprehensive data
        const learningJourney = this.compileLearningJourney(student);
        // Generate narrative using LLM
        const prompt = request.language === 'fr'
            ? `Générez un rapport narratif détaillé pour ${student.firstName} ${student.lastName}, couvrant la période du ${request.startDate.toLocaleDateString()} au ${request.endDate.toLocaleDateString()}. Incluez les réalisations, les défis et les domaines de croissance.`
            : `Generate a detailed narrative report for ${student.firstName} ${student.lastName}, covering the period from ${request.startDate.toLocaleDateString()} to ${request.endDate.toLocaleDateString()}. Include achievements, challenges, and areas of growth.`;
        const narrative = await generateContent(prompt, JSON.stringify(learningJourney));
        return {
            studentName: `${student.firstName} ${student.lastName}`,
            period: `${request.startDate.toLocaleDateString()} - ${request.endDate.toLocaleDateString()}`,
            sections: [
                {
                    title: request.language === 'fr' ? 'Rapport narratif' : 'Narrative Report',
                    content: narrative,
                },
            ],
            overallComments: '',
            nextSteps: [],
        };
    }
    async generateTermSummary(student, request) {
        const sections = [];
        // Get subject-specific progress
        const subjectProgress = await this.getSubjectProgress(student);
        for (const subject of subjectProgress) {
            sections.push({
                title: subject.name,
                content: await this.generateSubjectSummary(subject, request.language),
                data: subject,
            });
        }
        // Overall term performance
        const overallComments = await this.generateTermOverview(student, subjectProgress, request.language);
        // Recommendations for next term
        const nextSteps = await this.generateTermRecommendations(student, subjectProgress, request.language);
        return {
            studentName: `${student.firstName} ${student.lastName}`,
            period: request.language === 'fr' ? 'Résumé du trimestre' : 'Term Summary',
            sections,
            overallComments,
            nextSteps,
        };
    }
    async generateReportCard(student, request) {
        const sections = [];
        // Get formal grades/assessments by subject
        const reportCardData = await this.compileReportCardData(student);
        for (const subject of reportCardData) {
            // Generate teacher comments for each subject
            const comments = await this.generateSubjectComments(subject, student, request.language);
            sections.push({
                title: subject.name,
                content: comments,
                data: {
                    grade: subject.grade,
                    outcomes: subject.outcomes,
                },
            });
        }
        // General comments
        const overallComments = await this.generateReportCardComments(student, reportCardData, request.language);
        return {
            studentName: `${student.firstName} ${student.lastName}`,
            period: request.language === 'fr' ? 'Bulletin scolaire' : 'Report Card',
            sections,
            overallComments,
            nextSteps: [],
        };
    }
    // Helper methods
    async generateProgressFromArtifacts(artifacts, reflections, language) {
        const context = {
            artifactCount: artifacts.length,
            reflectionCount: reflections.length,
            recentArtifacts: artifacts
                .slice(0, 3)
                .map((a) => ({ title: a.title, description: a.description })),
            recentReflections: reflections.slice(0, 3).map((r) => ({ content: r.content })),
        };
        const prompt = language === 'fr'
            ? `Décrivez le progrès académique basé sur ${artifacts.length} artefacts et ${reflections.length} réflexions.`
            : `Describe academic progress based on ${artifacts.length} artifacts and ${reflections.length} reflections.`;
        return generateContent(prompt, JSON.stringify(context));
    }
    async generateGoalsNarrative(goals, language) {
        const activeGoals = goals.filter((g) => g.status === 'active');
        const completedGoals = goals.filter((g) => g.status === 'completed');
        const context = {
            active: activeGoals.map((g) => ({ text: g.text })),
            completed: completedGoals.map((g) => ({ text: g.text })),
        };
        const prompt = language === 'fr'
            ? `Décrivez le progrès vers les objectifs de l'élève: ${JSON.stringify(context)}`
            : `Describe the student's progress toward their goals: ${JSON.stringify(context)}`;
        return generateContent(prompt);
    }
    async generateOverallComments(student, sections, language) {
        const context = {
            studentName: `${student.firstName} ${student.lastName}`,
            sectionsCount: sections.length,
            sectionTitles: sections.map((s) => s.title),
        };
        const prompt = language === 'fr'
            ? `Générez des commentaires généraux positifs et encourageants pour ${context.studentName} basés sur leur rapport de progrès.`
            : `Generate positive and encouraging overall comments for ${context.studentName} based on their progress report.`;
        return generateContent(prompt, JSON.stringify(context));
    }
    async generateNextSteps(student, sections, language) {
        const prompt = language === 'fr'
            ? `Suggérez 3-5 prochaines étapes spécifiques pour ${student.firstName} pour continuer leur progrès.`
            : `Suggest 3-5 specific next steps for ${student.firstName} to continue their progress.`;
        const suggestions = await generateContent(prompt, JSON.stringify(sections.map((s) => ({ title: s.title, summary: s.content.substring(0, 100) }))));
        // Parse the suggestions into an array
        return suggestions
            .split('\n')
            .filter((s) => s.trim().length > 0)
            .slice(0, 5);
    }
    compileLearningJourney(student) {
        return {
            artifacts: student.artifacts.map((a) => ({
                title: a.title,
                description: a.description,
                createdAt: a.createdAt,
            })),
            reflections: student.reflections.map((r) => ({
                content: r.content,
                createdAt: r.createdAt,
            })),
            goals: student.goals,
        };
    }
    async getSubjectProgress(student) {
        // Simplified subject progress without deep relations
        const subjects = await this.prisma.subject.findMany({
            where: { userId: student.user.id },
        });
        return subjects.map((subject) => ({
            id: subject.id,
            name: subject.name,
            outcomes: [],
            averageScore: 0, // Assessment functionality removed
        }));
    }
    async generateSubjectSummary(subject, language) {
        const prompt = language === 'fr'
            ? `Résumez la performance de l'élève en ${subject.name} avec une note moyenne de ${subject.averageScore.toFixed(1)}% et couvrant ${subject.outcomes.length} résultats d'apprentissage.`
            : `Summarize the student's performance in ${subject.name} with an average score of ${subject.averageScore.toFixed(1)}% and covering ${subject.outcomes.length} learning outcomes.`;
        return generateContent(prompt);
    }
    async generateTermOverview(student, subjectProgress, language) {
        const overallAverage = subjectProgress.reduce((sum, s) => sum + s.averageScore, 0) / subjectProgress.length;
        const prompt = language === 'fr'
            ? `Générez un aperçu du trimestre pour ${student.firstName} avec une moyenne générale de ${overallAverage.toFixed(1)}% à travers ${subjectProgress.length} matières.`
            : `Generate a term overview for ${student.firstName} with an overall average of ${overallAverage.toFixed(1)}% across ${subjectProgress.length} subjects.`;
        return generateContent(prompt, JSON.stringify(subjectProgress.map((s) => ({ name: s.name, average: s.averageScore }))));
    }
    async generateTermRecommendations(student, subjectProgress, language) {
        const weakSubjects = subjectProgress.filter((s) => s.averageScore < 70);
        const strongSubjects = subjectProgress.filter((s) => s.averageScore >= 85);
        const prompt = language === 'fr'
            ? `Suggérez 3-5 recommandations pour le prochain trimestre basées sur les forces (${strongSubjects.map((s) => s.name).join(', ')}) et les domaines à améliorer (${weakSubjects.map((s) => s.name).join(', ')}).`
            : `Suggest 3-5 recommendations for the next term based on strengths (${strongSubjects.map((s) => s.name).join(', ')}) and areas for improvement (${weakSubjects.map((s) => s.name).join(', ')}).`;
        const recommendations = await generateContent(prompt);
        return recommendations
            .split('\n')
            .filter((r) => r.trim().length > 0)
            .slice(0, 5);
    }
    async compileReportCardData(student) {
        const subjects = await this.prisma.subject.findMany({
            where: { userId: student.user.id },
        });
        return subjects.map((subject) => ({
            id: subject.id,
            name: subject.name,
            grade: 'N/A', // Assessment functionality removed
            outcomes: [],
        }));
    }
    scoreToGrade(score) {
        if (score >= 90)
            return 'A';
        if (score >= 80)
            return 'B';
        if (score >= 70)
            return 'C';
        if (score >= 60)
            return 'D';
        return 'F';
    }
    async generateSubjectComments(subject, student, language) {
        const prompt = language === 'fr'
            ? `Générez des commentaires d'enseignant pour ${student.firstName} en ${subject.name} avec une note de ${subject.grade}. Soyez spécifique et encourageant.`
            : `Generate teacher comments for ${student.firstName} in ${subject.name} with a grade of ${subject.grade}. Be specific and encouraging.`;
        return generateContent(prompt, JSON.stringify({
            outcomes: subject.outcomes.length,
        }));
    }
    async generateReportCardComments(student, reportCardData, language) {
        const overallGrade = reportCardData.reduce((sum, s) => {
            const gradeValue = { A: 4, B: 3, C: 2, D: 1, F: 0 }[s.grade] || 0;
            return sum + gradeValue;
        }, 0) / reportCardData.length;
        const prompt = language === 'fr'
            ? `Générez des commentaires généraux de bulletin pour ${student.firstName} ${student.lastName} avec une performance globale de ${overallGrade.toFixed(1)}/4.0.`
            : `Generate overall report card comments for ${student.firstName} ${student.lastName} with an overall performance of ${overallGrade.toFixed(1)}/4.0.`;
        return generateContent(prompt, JSON.stringify(reportCardData.map((s) => ({ subject: s.name, grade: s.grade }))));
    }
    // Curriculum and Planning Report Methods
    async generateCurriculumCoverageReport(userId) {
        try {
            // Get all curriculum expectations - we'll filter by covered/uncovered later
            const expectations = await this.prisma.curriculumExpectation.findMany();
            // Get all plans with expectations
            const longRangePlans = await this.prisma.longRangePlan.findMany({
                where: { userId },
                include: { expectations: true },
            });
            const unitPlans = await this.prisma.unitPlan.findMany({
                where: { userId },
                include: { expectations: true },
            });
            const lessonPlans = await this.prisma.eTFOLessonPlan.findMany({
                where: { userId },
                include: { expectations: true },
            });
            // Collect all covered expectation IDs
            const coveredExpectationIds = new Set();
            longRangePlans.forEach((plan) => {
                plan.expectations.forEach((exp) => coveredExpectationIds.add(exp.expectationId));
            });
            unitPlans.forEach((plan) => {
                plan.expectations.forEach((exp) => coveredExpectationIds.add(exp.expectationId));
            });
            lessonPlans.forEach((plan) => {
                plan.expectations.forEach((exp) => coveredExpectationIds.add(exp.expectationId));
            });
            // Calculate coverage
            const totalExpectations = expectations.length;
            const coveredExpectations = coveredExpectationIds.size;
            const coveragePercentage = totalExpectations > 0 ? Math.round((coveredExpectations / totalExpectations) * 100) : 0;
            // Find uncovered expectations
            const uncoveredExpectations = expectations
                .filter((exp) => !coveredExpectationIds.has(exp.id))
                .map((exp) => ({
                id: exp.id,
                code: exp.code,
                description: exp.description,
                strand: exp.strand,
            }));
            // Calculate coverage by strand
            const coverageByStrand = {};
            expectations.forEach((exp) => {
                if (!coverageByStrand[exp.strand]) {
                    coverageByStrand[exp.strand] = { total: 0, covered: 0, percentage: 0 };
                }
                coverageByStrand[exp.strand].total++;
                if (coveredExpectationIds.has(exp.id)) {
                    coverageByStrand[exp.strand].covered++;
                }
            });
            // Calculate percentages for each strand
            Object.keys(coverageByStrand).forEach((strand) => {
                const strandData = coverageByStrand[strand];
                strandData.percentage =
                    strandData.total > 0 ? Math.round((strandData.covered / strandData.total) * 100) : 0;
            });
            return {
                totalExpectations,
                coveredExpectations,
                coveragePercentage,
                uncoveredExpectations,
                coverageByStrand,
            };
        }
        catch (error) {
            logger.error('Failed to generate curriculum coverage report:', error);
            throw error;
        }
    }
    async generatePlanningProgressReport(userId) {
        try {
            // Get all planning data for the user
            const longRangePlans = await this.prisma.longRangePlan.findMany({
                where: { userId },
            });
            const unitPlans = await this.prisma.unitPlan.findMany({
                where: { userId },
            });
            const lessonPlans = await this.prisma.eTFOLessonPlan.findMany({
                where: { userId },
            });
            const daybookEntries = await this.prisma.daybookEntry.findMany({
                where: { userId },
            });
            // Calculate completion rates
            const calculateCompletionRate = (plans, isComplete) => {
                const total = plans.length;
                const completed = plans.filter(isComplete).length;
                const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;
                return { total, completed, completionRate };
            };
            return {
                longRangePlans: calculateCompletionRate(longRangePlans, (plan) => plan.goals !== null && plan.goals !== ''),
                unitPlans: calculateCompletionRate(unitPlans, (plan) => plan.bigIdeas !== null && plan.bigIdeas !== ''),
                lessonPlans: calculateCompletionRate(lessonPlans, (plan) => plan.learningGoals !== null && plan.learningGoals !== ''),
                daybookEntries: calculateCompletionRate(daybookEntries, (entry) => entry.whatWorked !== null && entry.whatWorked !== ''),
            };
        }
        catch (error) {
            logger.error('Failed to generate planning progress report:', error);
            throw error;
        }
    }
    async generateLessonPlanReport(lessonId) {
        try {
            const lesson = await this.prisma.eTFOLessonPlan.findUnique({
                where: { id: lessonId },
                include: {
                    unitPlan: {
                        include: {
                            longRangePlan: true,
                        },
                    },
                    expectations: {
                        include: {
                            expectation: true,
                        },
                    },
                    daybookEntry: true,
                    resources: true,
                },
            });
            if (!lesson) {
                throw new Error('Lesson plan not found');
            }
            return {
                lesson: {
                    id: lesson.id,
                    title: lesson.title,
                    date: lesson.date,
                    duration: lesson.duration,
                    mindsOn: lesson.mindsOn || undefined,
                    action: lesson.action || undefined,
                    consolidation: lesson.consolidation || undefined,
                    learningGoals: lesson.learningGoals || undefined,
                    materials: Array.isArray(lesson.materials) ? lesson.materials : undefined,
                    isSubFriendly: lesson.isSubFriendly,
                },
                hierarchy: {
                    longRangePlan: {
                        id: lesson.unitPlan.longRangePlan.id,
                        title: lesson.unitPlan.longRangePlan.title,
                        subject: lesson.unitPlan.longRangePlan.subject || undefined,
                        grade: lesson.unitPlan.longRangePlan.grade || undefined,
                    },
                    unitPlan: {
                        id: lesson.unitPlan.id,
                        title: lesson.unitPlan.title,
                    },
                },
                curriculumAlignment: lesson.expectations.map((exp) => ({
                    id: exp.expectation.id,
                    code: exp.expectation.code,
                    description: exp.expectation.description,
                    strand: exp.expectation.strand,
                })),
                reflection: lesson.daybookEntry
                    ? {
                        whatWorked: lesson.daybookEntry.whatWorked || undefined,
                        overallRating: lesson.daybookEntry.overallRating || undefined,
                        wouldReuseLesson: lesson.daybookEntry.wouldReuseLesson || undefined,
                    }
                    : undefined,
                resources: lesson.resources.map((resource) => ({
                    id: resource.id,
                    title: resource.title,
                    type: resource.type,
                    url: resource.url || undefined,
                })),
            };
        }
        catch (error) {
            logger.error('Failed to generate lesson plan report:', error);
            throw error;
        }
    }
    async generateSubstitutePlanReport(lessonId) {
        try {
            const lesson = await this.prisma.eTFOLessonPlan.findUnique({
                where: { id: lessonId },
                include: {
                    unitPlan: {
                        include: {
                            longRangePlan: true,
                        },
                    },
                    resources: true,
                },
            });
            if (!lesson) {
                throw new Error('Lesson plan not found');
            }
            if (!lesson.isSubFriendly) {
                throw new Error('Lesson plan is not marked as substitute-friendly');
            }
            return {
                title: lesson.title,
                basicInfo: {
                    subject: lesson.unitPlan.longRangePlan.subject || 'Not specified',
                    grade: lesson.unitPlan.longRangePlan.grade || 0,
                    duration: lesson.duration,
                    date: lesson.date,
                },
                materials: Array.isArray(lesson.materials) ? lesson.materials : [],
                activities: {
                    opening: lesson.mindsOn || '',
                    main: lesson.action || '',
                    closing: lesson.consolidation || '',
                },
                specialNotes: lesson.subNotes || undefined,
                resources: lesson.resources.map((resource) => ({
                    id: resource.id,
                    title: resource.title,
                    type: resource.type,
                    content: resource.content || undefined,
                })),
            };
        }
        catch (error) {
            logger.error('Failed to generate substitute plan report:', error);
            throw error;
        }
    }
    async generateUnitOverviewReport(unitId) {
        try {
            const unit = await this.prisma.unitPlan.findUnique({
                where: { id: unitId },
                include: {
                    longRangePlan: true,
                    expectations: {
                        include: {
                            expectation: true,
                        },
                    },
                    lessonPlans: true,
                    resources: true,
                },
            });
            if (!unit) {
                throw new Error('Unit plan not found');
            }
            const totalDuration = unit.lessonPlans.reduce((sum, lesson) => sum + lesson.duration, 0);
            return {
                unit: {
                    id: unit.id,
                    title: unit.title,
                    description: unit.description || undefined,
                    bigIdeas: unit.bigIdeas || undefined,
                    startDate: unit.startDate,
                    endDate: unit.endDate,
                    estimatedHours: unit.estimatedHours,
                },
                hierarchy: {
                    longRangePlan: {
                        id: unit.longRangePlan.id,
                        title: unit.longRangePlan.title,
                        subject: unit.longRangePlan.subject || undefined,
                        grade: unit.longRangePlan.grade || undefined,
                    },
                },
                curriculumAlignment: unit.expectations.map((exp) => ({
                    id: exp.expectation.id,
                    code: exp.expectation.code,
                    description: exp.expectation.description,
                    strand: exp.expectation.strand,
                })),
                lessonSummary: {
                    totalLessons: unit.lessonPlans.length,
                    totalDuration,
                    lessons: unit.lessonPlans.map((lesson) => ({
                        id: lesson.id,
                        title: lesson.title,
                        date: lesson.date,
                        duration: lesson.duration,
                    })),
                },
                resources: unit.resources.map((resource) => ({
                    id: resource.id,
                    title: resource.title,
                    type: resource.type,
                })),
            };
        }
        catch (error) {
            logger.error('Failed to generate unit overview report:', error);
            throw error;
        }
    }
}
export const reportGeneratorService = new ReportGeneratorService();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL21pY2hhZWxtY2lzYWFjL0dpdEh1Yi90ZWFjaGluZy1lbmdpbmUyLjAvc2VydmVyL3NyYy9zZXJ2aWNlcy9yZXBvcnRHZW5lcmF0b3JTZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDbkMsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUMvQyxPQUFPLE1BQU0sTUFBTSxXQUFXLENBQUM7QUFrTy9CLE1BQU0sT0FBTyxzQkFBc0I7SUFDekIsTUFBTSxDQUFnQjtJQUU5QixZQUFZLFlBQTRCO1FBQ3RDLElBQUksQ0FBQyxNQUFNLEdBQUcsWUFBWSxJQUFJLE1BQU0sQ0FBQztJQUN2QyxDQUFDO0lBRUQsS0FBSyxDQUFDLGNBQWMsQ0FBQyxPQUFnQztRQUNuRCxJQUFJLENBQUM7WUFDSCxxQkFBcUI7WUFDckIsTUFBTSxPQUFPLEdBQUcsTUFBTSxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxVQUFVLENBQUM7Z0JBQ25ELEtBQUssRUFBRSxFQUFFLEVBQUUsRUFBRSxPQUFPLENBQUMsU0FBUyxFQUFFO2dCQUNoQyxPQUFPLEVBQUU7b0JBQ1AsSUFBSSxFQUFFLElBQUk7b0JBQ1YsU0FBUyxFQUFFO3dCQUNULEtBQUssRUFBRTs0QkFDTCxTQUFTLEVBQUU7Z0NBQ1QsR0FBRyxFQUFFLE9BQU8sQ0FBQyxTQUFTO2dDQUN0QixHQUFHLEVBQUUsT0FBTyxDQUFDLE9BQU87NkJBQ3JCO3lCQUNGO3FCQUNGO29CQUNELFdBQVcsRUFBRTt3QkFDWCxLQUFLLEVBQUU7NEJBQ0wsU0FBUyxFQUFFO2dDQUNULEdBQUcsRUFBRSxPQUFPLENBQUMsU0FBUztnQ0FDdEIsR0FBRyxFQUFFLE9BQU8sQ0FBQyxPQUFPOzZCQUNyQjt5QkFDRjtxQkFDRjtvQkFDRCxLQUFLLEVBQUU7d0JBQ0wsS0FBSyxFQUFFOzRCQUNMLEVBQUUsRUFBRSxDQUFDLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRSxFQUFF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QUFDLENBQUM7WUFDaEUsTUFBTSxLQUFLLENBQUM7UUFDZCxDQUFDO0lBQ0gsQ0FBQztDQUNGO0FBRUQsTUFBTSxDQUFDLE1BQU0sc0JBQXNCLEdBQUcsSUFBSSxzQkFBc0IsRUFBRSxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9taWNoYWVsbWNpc2FhYy9HaXRIdWIvdGVhY2hpbmctZW5naW5lMi4wL3NlcnZlci9zcmMvc2VydmljZXMvcmVwb3J0R2VuZXJhdG9yU2VydmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuLi9wcmlzbWEnO1xuaW1wb3J0IHsgZ2VuZXJhdGVDb250ZW50IH0gZnJvbSAnLi9sbG1TZXJ2aWNlJztcbmltcG9ydCBsb2dnZXIgZnJvbSAnLi4vbG9nZ2VyJztcblxuZXhwb3J0IGludGVyZmFjZSBSZXBvcnRHZW5lcmF0aW9uUmVxdWVzdCB7XG4gIHN0dWRlbnRJZDogbnVtYmVyO1xuICByZXBvcnRUeXBlOiAncHJvZ3Jlc3MnIHwgJ25hcnJhdGl2ZScgfCAndGVybV9zdW1tYXJ5JyB8ICdyZXBvcnRfY2FyZCc7XG4gIHRlcm1JZD86IG51bWJlcjtcbiAgc3ViamVjdElkPzogbnVtYmVyO1xuICBzdGFydERhdGU6IERhdGU7XG4gIGVuZERhdGU6IERhdGU7XG4gIGxhbmd1YWdlOiAnZW4nIHwgJ2ZyJztcbiAgaW5jbHVkZUFzc2Vzc21lbnRzPzogYm9vbGVhbjtcbiAgaW5jbHVkZUF0dGVuZGFuY2U/OiBib29sZWFuO1xuICBpbmNsdWRlR29hbHM/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEdlbmVyYXRlZFJlcG9ydCB7XG4gIHN0dWRlbnROYW1lOiBzdHJpbmc7XG4gIHBlcmlvZDogc3RyaW5nO1xuICBzZWN0aW9uczogUmVwb3J0U2VjdGlvbltdO1xuICBvdmVyYWxsQ29tbWVudHM6IHN0cmluZztcbiAgbmV4dFN0ZXBzOiBzdHJpbmdbXTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZXBvcnRTZWN0aW9uIHtcbiAgdGl0bGU6IHN0cmluZztcbiAgY29udGVudDogc3RyaW5nO1xuICBkYXRhPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG59XG5cbi8vIFR5cGUgZGVmaW5pdGlvbnMgZm9yIHN0dWRlbnQgZGF0YSB3aXRoIHJlbGF0aW9uc1xuaW50ZXJmYWNlIFN0dWRlbnRXaXRoUmVsYXRpb25zIHtcbiAgaWQ6IG51bWJlcjtcbiAgZmlyc3ROYW1lOiBzdHJpbmc7XG4gIGxhc3ROYW1lOiBzdHJpbmc7XG4gIHVzZXI6IHsgaWQ6IG51bWJlciB9O1xuICBhcnRpZmFjdHM6IEFydGlmYWN0W107XG4gIHJlZmxlY3Rpb25zOiBSZWZsZWN0aW9uW107XG4gIGdvYWxzOiBHb2FsW107XG59XG5cbmludGVyZmFjZSBBcnRpZmFjdCB7XG4gIGlkOiBudW1iZXI7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmcgfCBudWxsO1xuICBjcmVhdGVkQXQ6IERhdGU7XG59XG5cbmludGVyZmFjZSBSZWZsZWN0aW9uIHtcbiAgaWQ6IG51bWJlcjtcbiAgY29udGVudDogc3RyaW5nO1xuICBjcmVhdGVkQXQ6IERhdGU7XG59XG5cbmludGVyZmFjZSBHb2FsIHtcbiAgaWQ6IG51bWJlcjtcbiAgdGV4dDogc3RyaW5nO1xuICBzdGF0dXM6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFN1YmplY3RQcm9ncmVzcyB7XG4gIGlkOiBudW1iZXI7XG4gIG5hbWU6IHN0cmluZztcbiAgb3V0Y29tZXM6IHN0cmluZ1tdO1xuICBhdmVyYWdlU2NvcmU6IG51bWJlcjtcbiAgW2tleTogc3RyaW5nXTogdW5rbm93bjtcbn1cblxuaW50ZXJmYWNlIFN1YmplY3RSZXBvcnRDYXJkIHtcbiAgaWQ6IG51bWJlcjtcbiAgbmFtZTogc3RyaW5nO1xuICBncmFkZTogc3RyaW5nO1xuICBvdXRjb21lczogc3RyaW5nW107XG59XG5cbi8vIFR5cGUgZGVmaW5pdGlvbnMgZm9yIGN1cnJpY3VsdW0gYW5kIHBsYW5uaW5nIHJlcG9ydHNcbmV4cG9ydCBpbnRlcmZhY2UgQ3VycmljdWx1bUNvdmVyYWdlUmVwb3J0IHtcbiAgdG90YWxFeHBlY3RhdGlvbnM6IG51bWJlcjtcbiAgY292ZXJlZEV4cGVjdGF0aW9uczogbnVtYmVyO1xuICBjb3ZlcmFnZVBlcmNlbnRhZ2U6IG51bWJlcjtcbiAgdW5jb3ZlcmVkRXhwZWN0YXRpb25zOiBBcnJheTx7XG4gICAgaWQ6IHN0cmluZztcbiAgICBjb2RlOiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgICBzdHJhbmQ6IHN0cmluZztcbiAgfT47XG4gIGNvdmVyYWdlQnlTdHJhbmQ6IFJlY29yZDxcbiAgICBzdHJpbmcsXG4gICAge1xuICAgICAgdG90YWw6IG51bWJlcjtcbiAgICAgIGNvdmVyZWQ6IG51bWJlcjtcbiAgICAgIHBlcmNlbnRhZ2U6IG51bWJlcjtcbiAgICB9XG4gID47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGxhbm5pbmdQcm9ncmVzc1JlcG9ydCB7XG4gIGxvbmdSYW5nZVBsYW5zOiB7XG4gICAgdG90YWw6IG51bWJlcjtcbiAgICBjb21wbGV0ZWQ6IG51bWJlcjtcbiAgICBjb21wbGV0aW9uUmF0ZTogbnVtYmVyO1xuICB9O1xuICB1bml0UGxhbnM6IHtcbiAgICB0b3RhbDogbnVtYmVyO1xuICAgIGNvbXBsZXRlZDogbnVtYmVyO1xuICAgIGNvbXBsZXRpb25SYXRlOiBudW1iZXI7XG4gIH07XG4gIGxlc3NvblBsYW5zOiB7XG4gICAgdG90YWw6IG51bWJlcjtcbiAgICBjb21wbGV0ZWQ6IG51bWJlcjtcbiAgICBjb21wbGV0aW9uUmF0ZTogbnVtYmVyO1xuICB9O1xuICBkYXlib29rRW50cmllczoge1xuICAgIHRvdGFsOiBudW1iZXI7XG4gICAgY29tcGxldGVkOiBudW1iZXI7XG4gICAgY29tcGxldGlvblJhdGU6IG51bWJlcjtcbiAgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMZXNzb25QbGFuUmVwb3J0IHtcbiAgbGVzc29uOiB7XG4gICAgaWQ6IHN0cmluZztcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIGRhdGU6IERhdGU7XG4gICAgZHVyYXRpb246IG51bWJlcjtcbiAgICBtaW5kc09uPzogc3RyaW5nO1xuICAgIGFjdGlvbj86IHN0cmluZztcbiAgICBjb25zb2xpZGF0aW9uPzogc3RyaW5nO1xuICAgIGxlYXJuaW5nR29hbHM/OiBzdHJpbmc7XG4gICAgbWF0ZXJpYWxzPzogc3RyaW5nW107XG4gICAgaXNTdWJGcmllbmRseTogYm9vbGVhbjtcbiAgfTtcbiAgaGllcmFyY2h5OiB7XG4gICAgbG9uZ1JhbmdlUGxhbjoge1xuICAgICAgaWQ6IHN0cmluZztcbiAgICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgICBzdWJqZWN0Pzogc3RyaW5nO1xuICAgICAgZ3JhZGU/OiBudW1iZXI7XG4gICAgfTtcbiAgICB1bml0UGxhbjoge1xuICAgICAgaWQ6IHN0cmluZztcbiAgICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgfTtcbiAgfTtcbiAgY3VycmljdWx1bUFsaWdubWVudDogQXJyYXk8e1xuICAgIGlkOiBzdHJpbmc7XG4gICAgY29kZTogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAgc3RyYW5kOiBzdHJpbmc7XG4gIH0+O1xuICByZWZsZWN0aW9uPzoge1xuICAgIHdoYXRXb3JrZWQ/OiBzdHJpbmc7XG4gICAgb3ZlcmFsbFJhdGluZz86IG51bWJlcjtcbiAgICB3b3VsZFJldXNlTGVzc29uPzogYm9vbGVhbjtcbiAgfTtcbiAgcmVzb3VyY2VzOiBBcnJheTx7XG4gICAgaWQ6IHN0cmluZztcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIHR5cGU6IHN0cmluZztcbiAgICB1cmw/OiBzdHJpbmc7XG4gIH0+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFN1YnN0aXR1dGVQbGFuUmVwb3J0IHtcbiAgdGl0bGU6IHN0cmluZztcbiAgYmFzaWNJbmZvOiB7XG4gICAgc3ViamVjdDogc3RyaW5nO1xuICAgIGdyYWRlOiBudW1iZXI7XG4gICAgZHVyYXRpb246IG51bWJlcjtcbiAgICBkYXRlOiBEYXRlO1xuICB9O1xuICBtYXRlcmlhbHM6IHN0cmluZ1tdO1xuICBhY3Rpdml0aWVzOiB7XG4gICAgb3BlbmluZzogc3RyaW5nO1xuICAgIG1haW46IHN0cmluZztcbiAgICBjbG9zaW5nOiBzdHJpbmc7XG4gIH07XG4gIHNwZWNpYWxOb3Rlcz86IHN0cmluZztcbiAgcmVzb3VyY2VzOiBBcnJheTx7XG4gICAgaWQ6IHN0cmluZztcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIHR5cGU6IHN0cmluZztcbiAgICBjb250ZW50Pzogc3RyaW5nO1xuICB9Pjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBVbml0T3ZlcnZpZXdSZXBvcnQge1xuICB1bml0OiB7XG4gICAgaWQ6IHN0cmluZztcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuICAgIGJpZ0lkZWFzPzogc3RyaW5nO1xuICAgIHN0YXJ0RGF0ZTogRGF0ZTtcbiAgICBlbmREYXRlOiBEYXRlO1xuICAgIGVzdGltYXRlZEhvdXJzOiBudW1iZXI7XG4gIH07XG4gIGhpZXJhcmNoeToge1xuICAgIGxvbmdSYW5nZVBsYW46IHtcbiAgICAgIGlkOiBzdHJpbmc7XG4gICAgICB0aXRsZTogc3RyaW5nO1xuICAgICAgc3ViamVjdD86IHN0cmluZztcbiAgICAgIGdyYWRlPzogbnVtYmVyO1xuICAgIH07XG4gIH07XG4gIGN1cnJpY3VsdW1BbGlnbm1lbnQ6IEFycmF5PHtcbiAgICBpZDogc3RyaW5nO1xuICAgIGNvZGU6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIHN0cmFuZDogc3RyaW5nO1xuICB9PjtcbiAgbGVzc29uU3VtbWFyeToge1xuICAgIHRvdGFsTGVzc29uczogbnVtYmVyO1xuICAgIHRvdGFsRHVyYXRpb246IG51bWJlcjtcbiAgICBsZXNzb25zOiBBcnJheTx7XG4gICAgICBpZDogc3RyaW5nO1xuICAgICAgdGl0bGU6IHN0cmluZztcbiAgICAgIGRhdGU6IERhdGU7XG4gICAgICBkdXJhdGlvbjogbnVtYmVyO1xuICAgIH0+O1xuICB9O1xuICByZXNvdXJjZXM6IEFycmF5PHtcbiAgICBpZDogc3RyaW5nO1xuICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgdHlwZTogc3RyaW5nO1xuICB9Pjtcbn1cblxuZXhwb3J0IGNsYXNzIFJlcG9ydEdlbmVyYXRvclNlcnZpY2Uge1xuICBwcml2YXRlIHByaXNtYTogdHlwZW9mIHByaXNtYTtcblxuICBjb25zdHJ1Y3RvcihwcmlzbWFDbGllbnQ/OiB0eXBlb2YgcHJpc21hKSB7XG4gICAgdGhpcy5wcmlzbWEgPSBwcmlzbWFDbGllbnQgfHwgcHJpc21hO1xuICB9XG5cbiAgYXN5bmMgZ2VuZXJhdGVSZXBvcnQocmVxdWVzdDogUmVwb3J0R2VuZXJhdGlvblJlcXVlc3QpOiBQcm9taXNlPEdlbmVyYXRlZFJlcG9ydD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBGZXRjaCBzdHVkZW50IGRhdGFcbiAgICAgIGNvbnN0IHN0dWRlbnQgPSBhd2FpdCB0aGlzLnByaXNtYS5zdHVkZW50LmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBpZDogcmVxdWVzdC5zdHVkZW50SWQgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIHVzZXI6IHRydWUsXG4gICAgICAgICAgYXJ0aWZhY3RzOiB7XG4gICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICBndGU6IHJlcXVlc3Quc3RhcnREYXRlLFxuICAgICAgICAgICAgICAgIGx0ZTogcmVxdWVzdC5lbmREYXRlLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlZmxlY3Rpb25zOiB7XG4gICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICBndGU6IHJlcXVlc3Quc3RhcnREYXRlLFxuICAgICAgICAgICAgICAgIGx0ZTogcmVxdWVzdC5lbmREYXRlLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGdvYWxzOiB7XG4gICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICBPUjogW3sgc3RhdHVzOiAnYWN0aXZlJyB9LCB7IHN0YXR1czogJ2NvbXBsZXRlZCcgfV0sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFzdHVkZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignU3R1ZGVudCBub3QgZm91bmQnKTtcbiAgICAgIH1cblxuICAgICAgLy8gR2VuZXJhdGUgcmVwb3J0IGJhc2VkIG9uIHR5cGVcbiAgICAgIGxldCByZXBvcnQ6IEdlbmVyYXRlZFJlcG9ydDtcblxuICAgICAgc3dpdGNoIChyZXF1ZXN0LnJlcG9ydFR5cGUpIHtcbiAgICAgICAgY2FzZSAncHJvZ3Jlc3MnOlxuICAgICAgICAgIHJlcG9ydCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVQcm9ncmVzc1JlcG9ydChzdHVkZW50LCByZXF1ZXN0KTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnbmFycmF0aXZlJzpcbiAgICAgICAgICByZXBvcnQgPSBhd2FpdCB0aGlzLmdlbmVyYXRlTmFycmF0aXZlUmVwb3J0KHN0dWRlbnQsIHJlcXVlc3QpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICd0ZXJtX3N1bW1hcnknOlxuICAgICAgICAgIHJlcG9ydCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVUZXJtU3VtbWFyeShzdHVkZW50LCByZXF1ZXN0KTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAncmVwb3J0X2NhcmQnOlxuICAgICAgICAgIHJlcG9ydCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVSZXBvcnRDYXJkKHN0dWRlbnQsIHJlcXVlc3QpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCByZXBvcnQgdHlwZScpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVwb3J0O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBnZW5lcmF0ZSByZXBvcnQ6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVByb2dyZXNzUmVwb3J0KFxuICAgIHN0dWRlbnQ6IFN0dWRlbnRXaXRoUmVsYXRpb25zLFxuICAgIHJlcXVlc3Q6IFJlcG9ydEdlbmVyYXRpb25SZXF1ZXN0LFxuICApOiBQcm9taXNlPEdlbmVyYXRlZFJlcG9ydD4ge1xuICAgIGNvbnN0IHNlY3Rpb25zOiBSZXBvcnRTZWN0aW9uW10gPSBbXTtcblxuICAgIC8vIEFzc2Vzc21lbnQgZnVuY3Rpb25hbGl0eSByZW1vdmVkIC0gZm9jdXMgb24gYXJ0aWZhY3RzIGFuZCByZWZsZWN0aW9uc1xuICAgIGlmIChzdHVkZW50LmFydGlmYWN0cy5sZW5ndGggPiAwIHx8IHN0dWRlbnQucmVmbGVjdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgc2VjdGlvbnMucHVzaCh7XG4gICAgICAgIHRpdGxlOiByZXF1ZXN0Lmxhbmd1YWdlID09PSAnZnInID8gJ1Byb2dyw6hzIGFjYWTDqW1pcXVlJyA6ICdBY2FkZW1pYyBQcm9ncmVzcycsXG4gICAgICAgIGNvbnRlbnQ6IGF3YWl0IHRoaXMuZ2VuZXJhdGVQcm9ncmVzc0Zyb21BcnRpZmFjdHMoXG4gICAgICAgICAgc3R1ZGVudC5hcnRpZmFjdHMsXG4gICAgICAgICAgc3R1ZGVudC5yZWZsZWN0aW9ucyxcbiAgICAgICAgICByZXF1ZXN0Lmxhbmd1YWdlLFxuICAgICAgICApLFxuICAgICAgICBkYXRhOiB7IGFydGlmYWN0czogc3R1ZGVudC5hcnRpZmFjdHMsIHJlZmxlY3Rpb25zOiBzdHVkZW50LnJlZmxlY3Rpb25zIH0sXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBHb2FscyBTZWN0aW9uXG4gICAgaWYgKHJlcXVlc3QuaW5jbHVkZUdvYWxzICYmIHN0dWRlbnQuZ29hbHMubGVuZ3RoID4gMCkge1xuICAgICAgc2VjdGlvbnMucHVzaCh7XG4gICAgICAgIHRpdGxlOiByZXF1ZXN0Lmxhbmd1YWdlID09PSAnZnInID8gJ09iamVjdGlmcycgOiAnR29hbHMnLFxuICAgICAgICBjb250ZW50OiBhd2FpdCB0aGlzLmdlbmVyYXRlR29hbHNOYXJyYXRpdmUoc3R1ZGVudC5nb2FscywgcmVxdWVzdC5sYW5ndWFnZSksXG4gICAgICAgIGRhdGE6IHsgZ29hbHM6IHN0dWRlbnQuZ29hbHMgfSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIE92ZXJhbGwgQ29tbWVudHNcbiAgICBjb25zdCBvdmVyYWxsQ29tbWVudHMgPSBhd2FpdCB0aGlzLmdlbmVyYXRlT3ZlcmFsbENvbW1lbnRzKHN0dWRlbnQsIHNlY3Rpb25zLCByZXF1ZXN0Lmxhbmd1YWdlKTtcblxuICAgIC8vIE5leHQgU3RlcHNcbiAgICBjb25zdCBuZXh0U3RlcHMgPSBhd2FpdCB0aGlzLmdlbmVyYXRlTmV4dFN0ZXBzKHN0dWRlbnQsIHNlY3Rpb25zLCByZXF1ZXN0Lmxhbmd1YWdlKTtcblxuICAgIHJldHVybiB7XG4gICAgICBzdHVkZW50TmFtZTogYCR7c3R1ZGVudC5maXJzdE5hbWV9ICR7c3R1ZGVudC5sYXN0TmFtZX1gLFxuICAgICAgcGVyaW9kOiBgJHtyZXF1ZXN0LnN0YXJ0RGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKX0gLSAke3JlcXVlc3QuZW5kRGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKX1gLFxuICAgICAgc2VjdGlvbnMsXG4gICAgICBvdmVyYWxsQ29tbWVudHMsXG4gICAgICBuZXh0U3RlcHMsXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVOYXJyYXRpdmVSZXBvcnQoXG4gICAgc3R1ZGVudDogU3R1ZGVudFdpdGhSZWxhdGlvbnMsXG4gICAgcmVxdWVzdDogUmVwb3J0R2VuZXJhdGlvblJlcXVlc3QsXG4gICk6IFByb21pc2U8R2VuZXJhdGVkUmVwb3J0PiB7XG4gICAgLy8gR2F0aGVyIGNvbXByZWhlbnNpdmUgZGF0YVxuICAgIGNvbnN0IGxlYXJuaW5nSm91cm5leSA9IHRoaXMuY29tcGlsZUxlYXJuaW5nSm91cm5leShzdHVkZW50KTtcblxuICAgIC8vIEdlbmVyYXRlIG5hcnJhdGl2ZSB1c2luZyBMTE1cbiAgICBjb25zdCBwcm9tcHQgPVxuICAgICAgcmVxdWVzdC5sYW5ndWFnZSA9PT0gJ2ZyJ1xuICAgICAgICA/IGBHw6luw6lyZXogdW4gcmFwcG9ydCBuYXJyYXRpZiBkw6l0YWlsbMOpIHBvdXIgJHtzdHVkZW50LmZpcnN0TmFtZX0gJHtzdHVkZW50Lmxhc3ROYW1lfSwgY291dnJhbnQgbGEgcMOpcmlvZGUgZHUgJHtyZXF1ZXN0LnN0YXJ0RGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKX0gYXUgJHtyZXF1ZXN0LmVuZERhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCl9LiBJbmNsdWV6IGxlcyByw6lhbGlzYXRpb25zLCBsZXMgZMOpZmlzIGV0IGxlcyBkb21haW5lcyBkZSBjcm9pc3NhbmNlLmBcbiAgICAgICAgOiBgR2VuZXJhdGUgYSBkZXRhaWxlZCBuYXJyYXRpdmUgcmVwb3J0IGZvciAke3N0dWRlbnQuZmlyc3ROYW1lfSAke3N0dWRlbnQubGFzdE5hbWV9LCBjb3ZlcmluZyB0aGUgcGVyaW9kIGZyb20gJHtyZXF1ZXN0LnN0YXJ0RGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKX0gdG8gJHtyZXF1ZXN0LmVuZERhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCl9LiBJbmNsdWRlIGFjaGlldmVtZW50cywgY2hhbGxlbmdlcywgYW5kIGFyZWFzIG9mIGdyb3d0aC5gO1xuXG4gICAgY29uc3QgbmFycmF0aXZlID0gYXdhaXQgZ2VuZXJhdGVDb250ZW50KHByb21wdCwgSlNPTi5zdHJpbmdpZnkobGVhcm5pbmdKb3VybmV5KSk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3R1ZGVudE5hbWU6IGAke3N0dWRlbnQuZmlyc3ROYW1lfSAke3N0dWRlbnQubGFzdE5hbWV9YCxcbiAgICAgIHBlcmlvZDogYCR7cmVxdWVzdC5zdGFydERhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCl9IC0gJHtyZXF1ZXN0LmVuZERhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCl9YCxcbiAgICAgIHNlY3Rpb25zOiBbXG4gICAgICAgIHtcbiAgICAgICAgICB0aXRsZTogcmVxdWVzdC5sYW5ndWFnZSA9PT0gJ2ZyJyA/ICdSYXBwb3J0IG5hcnJhdGlmJyA6ICdOYXJyYXRpdmUgUmVwb3J0JyxcbiAgICAgICAgICBjb250ZW50OiBuYXJyYXRpdmUsXG4gICAgICAgIH0sXG4gICAgICBdLFxuICAgICAgb3ZlcmFsbENvbW1lbnRzOiAnJyxcbiAgICAgIG5leHRTdGVwczogW10sXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVUZXJtU3VtbWFyeShcbiAgICBzdHVkZW50OiBTdHVkZW50V2l0aFJlbGF0aW9ucyxcbiAgICByZXF1ZXN0OiBSZXBvcnRHZW5lcmF0aW9uUmVxdWVzdCxcbiAgKTogUHJvbWlzZTxHZW5lcmF0ZWRSZXBvcnQ+IHtcbiAgICBjb25zdCBzZWN0aW9uczogUmVwb3J0U2VjdGlvbltdID0gW107XG5cbiAgICAvLyBHZXQgc3ViamVjdC1zcGVjaWZpYyBwcm9ncmVzc1xuICAgIGNvbnN0IHN1YmplY3RQcm9ncmVzcyA9IGF3YWl0IHRoaXMuZ2V0U3ViamVjdFByb2dyZXNzKHN0dWRlbnQpO1xuXG4gICAgZm9yIChjb25zdCBzdWJqZWN0IG9mIHN1YmplY3RQcm9ncmVzcykge1xuICAgICAgc2VjdGlvbnMucHVzaCh7XG4gICAgICAgIHRpdGxlOiBzdWJqZWN0Lm5hbWUsXG4gICAgICAgIGNvbnRlbnQ6IGF3YWl0IHRoaXMuZ2VuZXJhdGVTdWJqZWN0U3VtbWFyeShzdWJqZWN0LCByZXF1ZXN0Lmxhbmd1YWdlKSxcbiAgICAgICAgZGF0YTogc3ViamVjdCxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIE92ZXJhbGwgdGVybSBwZXJmb3JtYW5jZVxuICAgIGNvbnN0IG92ZXJhbGxDb21tZW50cyA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVUZXJtT3ZlcnZpZXcoXG4gICAgICBzdHVkZW50LFxuICAgICAgc3ViamVjdFByb2dyZXNzLFxuICAgICAgcmVxdWVzdC5sYW5ndWFnZSxcbiAgICApO1xuXG4gICAgLy8gUmVjb21tZW5kYXRpb25zIGZvciBuZXh0IHRlcm1cbiAgICBjb25zdCBuZXh0U3RlcHMgPSBhd2FpdCB0aGlzLmdlbmVyYXRlVGVybVJlY29tbWVuZGF0aW9ucyhcbiAgICAgIHN0dWRlbnQsXG4gICAgICBzdWJqZWN0UHJvZ3Jlc3MsXG4gICAgICByZXF1ZXN0Lmxhbmd1YWdlLFxuICAgICk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3R1ZGVudE5hbWU6IGAke3N0dWRlbnQuZmlyc3ROYW1lfSAke3N0dWRlbnQubGFzdE5hbWV9YCxcbiAgICAgIHBlcmlvZDogcmVxdWVzdC5sYW5ndWFnZSA9PT0gJ2ZyJyA/ICdSw6lzdW3DqSBkdSB0cmltZXN0cmUnIDogJ1Rlcm0gU3VtbWFyeScsXG4gICAgICBzZWN0aW9ucyxcbiAgICAgIG92ZXJhbGxDb21tZW50cyxcbiAgICAgIG5leHRTdGVwcyxcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVJlcG9ydENhcmQoXG4gICAgc3R1ZGVudDogU3R1ZGVudFdpdGhSZWxhdGlvbnMsXG4gICAgcmVxdWVzdDogUmVwb3J0R2VuZXJhdGlvblJlcXVlc3QsXG4gICk6IFByb21pc2U8R2VuZXJhdGVkUmVwb3J0PiB7XG4gICAgY29uc3Qgc2VjdGlvbnM6IFJlcG9ydFNlY3Rpb25bXSA9IFtdO1xuXG4gICAgLy8gR2V0IGZvcm1hbCBncmFkZXMvYXNzZXNzbWVudHMgYnkgc3ViamVjdFxuICAgIGNvbnN0IHJlcG9ydENhcmREYXRhID0gYXdhaXQgdGhpcy5jb21waWxlUmVwb3J0Q2FyZERhdGEoc3R1ZGVudCk7XG5cbiAgICBmb3IgKGNvbnN0IHN1YmplY3Qgb2YgcmVwb3J0Q2FyZERhdGEpIHtcbiAgICAgIC8vIEdlbmVyYXRlIHRlYWNoZXIgY29tbWVudHMgZm9yIGVhY2ggc3ViamVjdFxuICAgICAgY29uc3QgY29tbWVudHMgPSBhd2FpdCB0aGlzLmdlbmVyYXRlU3ViamVjdENvbW1lbnRzKHN1YmplY3QsIHN0dWRlbnQsIHJlcXVlc3QubGFuZ3VhZ2UpO1xuXG4gICAgICBzZWN0aW9ucy5wdXNoKHtcbiAgICAgICAgdGl0bGU6IHN1YmplY3QubmFtZSxcbiAgICAgICAgY29udGVudDogY29tbWVudHMsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBncmFkZTogc3ViamVjdC5ncmFkZSxcbiAgICAgICAgICBvdXRjb21lczogc3ViamVjdC5vdXRjb21lcyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEdlbmVyYWwgY29tbWVudHNcbiAgICBjb25zdCBvdmVyYWxsQ29tbWVudHMgPSBhd2FpdCB0aGlzLmdlbmVyYXRlUmVwb3J0Q2FyZENvbW1lbnRzKFxuICAgICAgc3R1ZGVudCxcbiAgICAgIHJlcG9ydENhcmREYXRhLFxuICAgICAgcmVxdWVzdC5sYW5ndWFnZSxcbiAgICApO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN0dWRlbnROYW1lOiBgJHtzdHVkZW50LmZpcnN0TmFtZX0gJHtzdHVkZW50Lmxhc3ROYW1lfWAsXG4gICAgICBwZXJpb2Q6IHJlcXVlc3QubGFuZ3VhZ2UgPT09ICdmcicgPyAnQnVsbGV0aW4gc2NvbGFpcmUnIDogJ1JlcG9ydCBDYXJkJyxcbiAgICAgIHNlY3Rpb25zLFxuICAgICAgb3ZlcmFsbENvbW1lbnRzLFxuICAgICAgbmV4dFN0ZXBzOiBbXSxcbiAgICB9O1xuICB9XG5cbiAgLy8gSGVscGVyIG1ldGhvZHNcbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVByb2dyZXNzRnJvbUFydGlmYWN0cyhcbiAgICBhcnRpZmFjdHM6IEFydGlmYWN0W10sXG4gICAgcmVmbGVjdGlvbnM6IFJlZmxlY3Rpb25bXSxcbiAgICBsYW5ndWFnZTogJ2VuJyB8ICdmcicsXG4gICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgY29udGV4dCA9IHtcbiAgICAgIGFydGlmYWN0Q291bnQ6IGFydGlmYWN0cy5sZW5ndGgsXG4gICAgICByZWZsZWN0aW9uQ291bnQ6IHJlZmxlY3Rpb25zLmxlbmd0aCxcbiAgICAgIHJlY2VudEFydGlmYWN0czogYXJ0aWZhY3RzXG4gICAgICAgIC5zbGljZSgwLCAzKVxuICAgICAgICAubWFwKChhKSA9PiAoeyB0aXRsZTogYS50aXRsZSwgZGVzY3JpcHRpb246IGEuZGVzY3JpcHRpb24gfSkpLFxuICAgICAgcmVjZW50UmVmbGVjdGlvbnM6IHJlZmxlY3Rpb25zLnNsaWNlKDAsIDMpLm1hcCgocikgPT4gKHsgY29udGVudDogci5jb250ZW50IH0pKSxcbiAgICB9O1xuXG4gICAgY29uc3QgcHJvbXB0ID1cbiAgICAgIGxhbmd1YWdlID09PSAnZnInXG4gICAgICAgID8gYETDqWNyaXZleiBsZSBwcm9ncsOocyBhY2Fkw6ltaXF1ZSBiYXPDqSBzdXIgJHthcnRpZmFjdHMubGVuZ3RofSBhcnRlZmFjdHMgZXQgJHtyZWZsZWN0aW9ucy5sZW5ndGh9IHLDqWZsZXhpb25zLmBcbiAgICAgICAgOiBgRGVzY3JpYmUgYWNhZGVtaWMgcHJvZ3Jlc3MgYmFzZWQgb24gJHthcnRpZmFjdHMubGVuZ3RofSBhcnRpZmFjdHMgYW5kICR7cmVmbGVjdGlvbnMubGVuZ3RofSByZWZsZWN0aW9ucy5gO1xuXG4gICAgcmV0dXJuIGdlbmVyYXRlQ29udGVudChwcm9tcHQsIEpTT04uc3RyaW5naWZ5KGNvbnRleHQpKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVHb2Fsc05hcnJhdGl2ZShnb2FsczogR29hbFtdLCBsYW5ndWFnZTogJ2VuJyB8ICdmcicpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGFjdGl2ZUdvYWxzID0gZ29hbHMuZmlsdGVyKChnKSA9PiBnLnN0YXR1cyA9PT0gJ2FjdGl2ZScpO1xuICAgIGNvbnN0IGNvbXBsZXRlZEdvYWxzID0gZ29hbHMuZmlsdGVyKChnKSA9PiBnLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcpO1xuXG4gICAgY29uc3QgY29udGV4dCA9IHtcbiAgICAgIGFjdGl2ZTogYWN0aXZlR29hbHMubWFwKChnKSA9PiAoeyB0ZXh0OiBnLnRleHQgfSkpLFxuICAgICAgY29tcGxldGVkOiBjb21wbGV0ZWRHb2Fscy5tYXAoKGcpID0+ICh7IHRleHQ6IGcudGV4dCB9KSksXG4gICAgfTtcblxuICAgIGNvbnN0IHByb21wdCA9XG4gICAgICBsYW5ndWFnZSA9PT0gJ2ZyJ1xuICAgICAgICA/IGBEw6ljcml2ZXogbGUgcHJvZ3LDqHMgdmVycyBsZXMgb2JqZWN0aWZzIGRlIGwnw6lsw6h2ZTogJHtKU09OLnN0cmluZ2lmeShjb250ZXh0KX1gXG4gICAgICAgIDogYERlc2NyaWJlIHRoZSBzdHVkZW50J3MgcHJvZ3Jlc3MgdG93YXJkIHRoZWlyIGdvYWxzOiAke0pTT04uc3RyaW5naWZ5KGNvbnRleHQpfWA7XG5cbiAgICByZXR1cm4gZ2VuZXJhdGVDb250ZW50KHByb21wdCk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlT3ZlcmFsbENvbW1lbnRzKFxuICAgIHN0dWRlbnQ6IFN0dWRlbnRXaXRoUmVsYXRpb25zLFxuICAgIHNlY3Rpb25zOiBSZXBvcnRTZWN0aW9uW10sXG4gICAgbGFuZ3VhZ2U6ICdlbicgfCAnZnInLFxuICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGNvbnRleHQgPSB7XG4gICAgICBzdHVkZW50TmFtZTogYCR7c3R1ZGVudC5maXJzdE5hbWV9ICR7c3R1ZGVudC5sYXN0TmFtZX1gLFxuICAgICAgc2VjdGlvbnNDb3VudDogc2VjdGlvbnMubGVuZ3RoLFxuICAgICAgc2VjdGlvblRpdGxlczogc2VjdGlvbnMubWFwKChzKSA9PiBzLnRpdGxlKSxcbiAgICB9O1xuXG4gICAgY29uc3QgcHJvbXB0ID1cbiAgICAgIGxhbmd1YWdlID09PSAnZnInXG4gICAgICAgID8gYEfDqW7DqXJleiBkZXMgY29tbWVudGFpcmVzIGfDqW7DqXJhdXggcG9zaXRpZnMgZXQgZW5jb3VyYWdlYW50cyBwb3VyICR7Y29udGV4dC5zdHVkZW50TmFtZX0gYmFzw6lzIHN1ciBsZXVyIHJhcHBvcnQgZGUgcHJvZ3LDqHMuYFxuICAgICAgICA6IGBHZW5lcmF0ZSBwb3NpdGl2ZSBhbmQgZW5jb3VyYWdpbmcgb3ZlcmFsbCBjb21tZW50cyBmb3IgJHtjb250ZXh0LnN0dWRlbnROYW1lfSBiYXNlZCBvbiB0aGVpciBwcm9ncmVzcyByZXBvcnQuYDtcblxuICAgIHJldHVybiBnZW5lcmF0ZUNvbnRlbnQocHJvbXB0LCBKU09OLnN0cmluZ2lmeShjb250ZXh0KSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlTmV4dFN0ZXBzKFxuICAgIHN0dWRlbnQ6IFN0dWRlbnRXaXRoUmVsYXRpb25zLFxuICAgIHNlY3Rpb25zOiBSZXBvcnRTZWN0aW9uW10sXG4gICAgbGFuZ3VhZ2U6ICdlbicgfCAnZnInLFxuICApOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgY29uc3QgcHJvbXB0ID1cbiAgICAgIGxhbmd1YWdlID09PSAnZnInXG4gICAgICAgID8gYFN1Z2fDqXJleiAzLTUgcHJvY2hhaW5lcyDDqXRhcGVzIHNww6ljaWZpcXVlcyBwb3VyICR7c3R1ZGVudC5maXJzdE5hbWV9IHBvdXIgY29udGludWVyIGxldXIgcHJvZ3LDqHMuYFxuICAgICAgICA6IGBTdWdnZXN0IDMtNSBzcGVjaWZpYyBuZXh0IHN0ZXBzIGZvciAke3N0dWRlbnQuZmlyc3ROYW1lfSB0byBjb250aW51ZSB0aGVpciBwcm9ncmVzcy5gO1xuXG4gICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBhd2FpdCBnZW5lcmF0ZUNvbnRlbnQoXG4gICAgICBwcm9tcHQsXG4gICAgICBKU09OLnN0cmluZ2lmeShcbiAgICAgICAgc2VjdGlvbnMubWFwKChzKSA9PiAoeyB0aXRsZTogcy50aXRsZSwgc3VtbWFyeTogcy5jb250ZW50LnN1YnN0cmluZygwLCAxMDApIH0pKSxcbiAgICAgICksXG4gICAgKTtcblxuICAgIC8vIFBhcnNlIHRoZSBzdWdnZXN0aW9ucyBpbnRvIGFuIGFycmF5XG4gICAgcmV0dXJuIHN1Z2dlc3Rpb25zXG4gICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAuZmlsdGVyKChzKSA9PiBzLnRyaW0oKS5sZW5ndGggPiAwKVxuICAgICAgLnNsaWNlKDAsIDUpO1xuICB9XG5cbiAgcHJpdmF0ZSBjb21waWxlTGVhcm5pbmdKb3VybmV5KHN0dWRlbnQ6IFN0dWRlbnRXaXRoUmVsYXRpb25zKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFydGlmYWN0czogc3R1ZGVudC5hcnRpZmFjdHMubWFwKChhKSA9PiAoe1xuICAgICAgICB0aXRsZTogYS50aXRsZSxcbiAgICAgICAgZGVzY3JpcHRpb246IGEuZGVzY3JpcHRpb24sXG4gICAgICAgIGNyZWF0ZWRBdDogYS5jcmVhdGVkQXQsXG4gICAgICB9KSksXG4gICAgICByZWZsZWN0aW9uczogc3R1ZGVudC5yZWZsZWN0aW9ucy5tYXAoKHIpID0+ICh7XG4gICAgICAgIGNvbnRlbnQ6IHIuY29udGVudCxcbiAgICAgICAgY3JlYXRlZEF0OiByLmNyZWF0ZWRBdCxcbiAgICAgIH0pKSxcbiAgICAgIGdvYWxzOiBzdHVkZW50LmdvYWxzLFxuICAgIH07XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdldFN1YmplY3RQcm9ncmVzcyhcbiAgICBzdHVkZW50OiBTdHVkZW50V2l0aFJlbGF0aW9ucyAmIHsgdXNlcjogeyBpZDogbnVtYmVyIH0gfSxcbiAgKTogUHJvbWlzZTxTdWJqZWN0UHJvZ3Jlc3NbXT4ge1xuICAgIC8vIFNpbXBsaWZpZWQgc3ViamVjdCBwcm9ncmVzcyB3aXRob3V0IGRlZXAgcmVsYXRpb25zXG4gICAgY29uc3Qgc3ViamVjdHMgPSBhd2FpdCB0aGlzLnByaXNtYS5zdWJqZWN0LmZpbmRNYW55KHtcbiAgICAgIHdoZXJlOiB7IHVzZXJJZDogc3R1ZGVudC51c2VyLmlkIH0sXG4gICAgfSk7XG5cbiAgICByZXR1cm4gc3ViamVjdHMubWFwKChzdWJqZWN0KSA9PiAoe1xuICAgICAgaWQ6IHN1YmplY3QuaWQsXG4gICAgICBuYW1lOiBzdWJqZWN0Lm5hbWUsXG4gICAgICBvdXRjb21lczogW10sXG4gICAgICBhdmVyYWdlU2NvcmU6IDAsIC8vIEFzc2Vzc21lbnQgZnVuY3Rpb25hbGl0eSByZW1vdmVkXG4gICAgfSkpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVN1YmplY3RTdW1tYXJ5KFxuICAgIHN1YmplY3Q6IFN1YmplY3RQcm9ncmVzcyxcbiAgICBsYW5ndWFnZTogJ2VuJyB8ICdmcicsXG4gICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgcHJvbXB0ID1cbiAgICAgIGxhbmd1YWdlID09PSAnZnInXG4gICAgICAgID8gYFLDqXN1bWV6IGxhIHBlcmZvcm1hbmNlIGRlIGwnw6lsw6h2ZSBlbiAke3N1YmplY3QubmFtZX0gYXZlYyB1bmUgbm90ZSBtb3llbm5lIGRlICR7c3ViamVjdC5hdmVyYWdlU2NvcmUudG9GaXhlZCgxKX0lIGV0IGNvdXZyYW50ICR7c3ViamVjdC5vdXRjb21lcy5sZW5ndGh9IHLDqXN1bHRhdHMgZCdhcHByZW50aXNzYWdlLmBcbiAgICAgICAgOiBgU3VtbWFyaXplIHRoZSBzdHVkZW50J3MgcGVyZm9ybWFuY2UgaW4gJHtzdWJqZWN0Lm5hbWV9IHdpdGggYW4gYXZlcmFnZSBzY29yZSBvZiAke3N1YmplY3QuYXZlcmFnZVNjb3JlLnRvRml4ZWQoMSl9JSBhbmQgY292ZXJpbmcgJHtzdWJqZWN0Lm91dGNvbWVzLmxlbmd0aH0gbGVhcm5pbmcgb3V0Y29tZXMuYDtcblxuICAgIHJldHVybiBnZW5lcmF0ZUNvbnRlbnQocHJvbXB0KTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVUZXJtT3ZlcnZpZXcoXG4gICAgc3R1ZGVudDogU3R1ZGVudFdpdGhSZWxhdGlvbnMsXG4gICAgc3ViamVjdFByb2dyZXNzOiBTdWJqZWN0UHJvZ3Jlc3NbXSxcbiAgICBsYW5ndWFnZTogJ2VuJyB8ICdmcicsXG4gICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3Qgb3ZlcmFsbEF2ZXJhZ2UgPVxuICAgICAgc3ViamVjdFByb2dyZXNzLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBzLmF2ZXJhZ2VTY29yZSwgMCkgLyBzdWJqZWN0UHJvZ3Jlc3MubGVuZ3RoO1xuXG4gICAgY29uc3QgcHJvbXB0ID1cbiAgICAgIGxhbmd1YWdlID09PSAnZnInXG4gICAgICAgID8gYEfDqW7DqXJleiB1biBhcGVyw6d1IGR1IHRyaW1lc3RyZSBwb3VyICR7c3R1ZGVudC5maXJzdE5hbWV9IGF2ZWMgdW5lIG1veWVubmUgZ8OpbsOpcmFsZSBkZSAke292ZXJhbGxBdmVyYWdlLnRvRml4ZWQoMSl9JSDDoCB0cmF2ZXJzICR7c3ViamVjdFByb2dyZXNzLmxlbmd0aH0gbWF0acOocmVzLmBcbiAgICAgICAgOiBgR2VuZXJhdGUgYSB0ZXJtIG92ZXJ2aWV3IGZvciAke3N0dWRlbnQuZmlyc3ROYW1lfSB3aXRoIGFuIG92ZXJhbGwgYXZlcmFnZSBvZiAke292ZXJhbGxBdmVyYWdlLnRvRml4ZWQoMSl9JSBhY3Jvc3MgJHtzdWJqZWN0UHJvZ3Jlc3MubGVuZ3RofSBzdWJqZWN0cy5gO1xuXG4gICAgcmV0dXJuIGdlbmVyYXRlQ29udGVudChcbiAgICAgIHByb21wdCxcbiAgICAgIEpTT04uc3RyaW5naWZ5KHN1YmplY3RQcm9ncmVzcy5tYXAoKHMpID0+ICh7IG5hbWU6IHMubmFtZSwgYXZlcmFnZTogcy5hdmVyYWdlU2NvcmUgfSkpKSxcbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVRlcm1SZWNvbW1lbmRhdGlvbnMoXG4gICAgc3R1ZGVudDogU3R1ZGVudFdpdGhSZWxhdGlvbnMsXG4gICAgc3ViamVjdFByb2dyZXNzOiBTdWJqZWN0UHJvZ3Jlc3NbXSxcbiAgICBsYW5ndWFnZTogJ2VuJyB8ICdmcicsXG4gICk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBjb25zdCB3ZWFrU3ViamVjdHMgPSBzdWJqZWN0UHJvZ3Jlc3MuZmlsdGVyKChzKSA9PiBzLmF2ZXJhZ2VTY29yZSA8IDcwKTtcbiAgICBjb25zdCBzdHJvbmdTdWJqZWN0cyA9IHN1YmplY3RQcm9ncmVzcy5maWx0ZXIoKHMpID0+IHMuYXZlcmFnZVNjb3JlID49IDg1KTtcblxuICAgIGNvbnN0IHByb21wdCA9XG4gICAgICBsYW5ndWFnZSA9PT0gJ2ZyJ1xuICAgICAgICA/IGBTdWdnw6lyZXogMy01IHJlY29tbWFuZGF0aW9ucyBwb3VyIGxlIHByb2NoYWluIHRyaW1lc3RyZSBiYXPDqWVzIHN1ciBsZXMgZm9yY2VzICgke3N0cm9uZ1N1YmplY3RzLm1hcCgocykgPT4gcy5uYW1lKS5qb2luKCcsICcpfSkgZXQgbGVzIGRvbWFpbmVzIMOgIGFtw6lsaW9yZXIgKCR7d2Vha1N1YmplY3RzLm1hcCgocykgPT4gcy5uYW1lKS5qb2luKCcsICcpfSkuYFxuICAgICAgICA6IGBTdWdnZXN0IDMtNSByZWNvbW1lbmRhdGlvbnMgZm9yIHRoZSBuZXh0IHRlcm0gYmFzZWQgb24gc3RyZW5ndGhzICgke3N0cm9uZ1N1YmplY3RzLm1hcCgocykgPT4gcy5uYW1lKS5qb2luKCcsICcpfSkgYW5kIGFyZWFzIGZvciBpbXByb3ZlbWVudCAoJHt3ZWFrU3ViamVjdHMubWFwKChzKSA9PiBzLm5hbWUpLmpvaW4oJywgJyl9KS5gO1xuXG4gICAgY29uc3QgcmVjb21tZW5kYXRpb25zID0gYXdhaXQgZ2VuZXJhdGVDb250ZW50KHByb21wdCk7XG5cbiAgICByZXR1cm4gcmVjb21tZW5kYXRpb25zXG4gICAgICAuc3BsaXQoJ1xcbicpXG4gICAgICAuZmlsdGVyKChyKSA9PiByLnRyaW0oKS5sZW5ndGggPiAwKVxuICAgICAgLnNsaWNlKDAsIDUpO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBjb21waWxlUmVwb3J0Q2FyZERhdGEoXG4gICAgc3R1ZGVudDogU3R1ZGVudFdpdGhSZWxhdGlvbnMgJiB7IHVzZXI6IHsgaWQ6IG51bWJlciB9IH0sXG4gICk6IFByb21pc2U8U3ViamVjdFJlcG9ydENhcmRbXT4ge1xuICAgIGNvbnN0IHN1YmplY3RzID0gYXdhaXQgdGhpcy5wcmlzbWEuc3ViamVjdC5maW5kTWFueSh7XG4gICAgICB3aGVyZTogeyB1c2VySWQ6IHN0dWRlbnQudXNlci5pZCB9LFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHN1YmplY3RzLm1hcCgoc3ViamVjdCkgPT4gKHtcbiAgICAgIGlkOiBzdWJqZWN0LmlkLFxuICAgICAgbmFtZTogc3ViamVjdC5uYW1lLFxuICAgICAgZ3JhZGU6ICdOL0EnLCAvLyBBc3Nlc3NtZW50IGZ1bmN0aW9uYWxpdHkgcmVtb3ZlZFxuICAgICAgb3V0Y29tZXM6IFtdLFxuICAgIH0pKTtcbiAgfVxuXG4gIHByaXZhdGUgc2NvcmVUb0dyYWRlKHNjb3JlOiBudW1iZXIpOiBzdHJpbmcge1xuICAgIGlmIChzY29yZSA+PSA5MCkgcmV0dXJuICdBJztcbiAgICBpZiAoc2NvcmUgPj0gODApIHJldHVybiAnQic7XG4gICAgaWYgKHNjb3JlID49IDcwKSByZXR1cm4gJ0MnO1xuICAgIGlmIChzY29yZSA+PSA2MCkgcmV0dXJuICdEJztcbiAgICByZXR1cm4gJ0YnO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVN1YmplY3RDb21tZW50cyhcbiAgICBzdWJqZWN0OiBTdWJqZWN0UmVwb3J0Q2FyZCxcbiAgICBzdHVkZW50OiBTdHVkZW50V2l0aFJlbGF0aW9ucyxcbiAgICBsYW5ndWFnZTogJ2VuJyB8ICdmcicsXG4gICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgcHJvbXB0ID1cbiAgICAgIGxhbmd1YWdlID09PSAnZnInXG4gICAgICAgID8gYEfDqW7DqXJleiBkZXMgY29tbWVudGFpcmVzIGQnZW5zZWlnbmFudCBwb3VyICR7c3R1ZGVudC5maXJzdE5hbWV9IGVuICR7c3ViamVjdC5uYW1lfSBhdmVjIHVuZSBub3RlIGRlICR7c3ViamVjdC5ncmFkZX0uIFNveWV6IHNww6ljaWZpcXVlIGV0IGVuY291cmFnZWFudC5gXG4gICAgICAgIDogYEdlbmVyYXRlIHRlYWNoZXIgY29tbWVudHMgZm9yICR7c3R1ZGVudC5maXJzdE5hbWV9IGluICR7c3ViamVjdC5uYW1lfSB3aXRoIGEgZ3JhZGUgb2YgJHtzdWJqZWN0LmdyYWRlfS4gQmUgc3BlY2lmaWMgYW5kIGVuY291cmFnaW5nLmA7XG5cbiAgICByZXR1cm4gZ2VuZXJhdGVDb250ZW50KFxuICAgICAgcHJvbXB0LFxuICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBvdXRjb21lczogc3ViamVjdC5vdXRjb21lcy5sZW5ndGgsXG4gICAgICB9KSxcbiAgICApO1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZVJlcG9ydENhcmRDb21tZW50cyhcbiAgICBzdHVkZW50OiBTdHVkZW50V2l0aFJlbGF0aW9ucyxcbiAgICByZXBvcnRDYXJkRGF0YTogU3ViamVjdFJlcG9ydENhcmRbXSxcbiAgICBsYW5ndWFnZTogJ2VuJyB8ICdmcicsXG4gICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3Qgb3ZlcmFsbEdyYWRlID1cbiAgICAgIHJlcG9ydENhcmREYXRhLnJlZHVjZSgoc3VtLCBzKSA9PiB7XG4gICAgICAgIGNvbnN0IGdyYWRlVmFsdWUgPSB7IEE6IDQsIEI6IDMsIEM6IDIsIEQ6IDEsIEY6IDAgfVtzLmdyYWRlXSB8fCAwO1xuICAgICAgICByZXR1cm4gc3VtICsgZ3JhZGVWYWx1ZTtcbiAgICAgIH0sIDApIC8gcmVwb3J0Q2FyZERhdGEubGVuZ3RoO1xuXG4gICAgY29uc3QgcHJvbXB0ID1cbiAgICAgIGxhbmd1YWdlID09PSAnZnInXG4gICAgICAgID8gYEfDqW7DqXJleiBkZXMgY29tbWVudGFpcmVzIGfDqW7DqXJhdXggZGUgYnVsbGV0aW4gcG91ciAke3N0dWRlbnQuZmlyc3ROYW1lfSAke3N0dWRlbnQubGFzdE5hbWV9IGF2ZWMgdW5lIHBlcmZvcm1hbmNlIGdsb2JhbGUgZGUgJHtvdmVyYWxsR3JhZGUudG9GaXhlZCgxKX0vNC4wLmBcbiAgICAgICAgOiBgR2VuZXJhdGUgb3ZlcmFsbCByZXBvcnQgY2FyZCBjb21tZW50cyBmb3IgJHtzdHVkZW50LmZpcnN0TmFtZX0gJHtzdHVkZW50Lmxhc3ROYW1lfSB3aXRoIGFuIG92ZXJhbGwgcGVyZm9ybWFuY2Ugb2YgJHtvdmVyYWxsR3JhZGUudG9GaXhlZCgxKX0vNC4wLmA7XG5cbiAgICByZXR1cm4gZ2VuZXJhdGVDb250ZW50KFxuICAgICAgcHJvbXB0LFxuICAgICAgSlNPTi5zdHJpbmdpZnkocmVwb3J0Q2FyZERhdGEubWFwKChzKSA9PiAoeyBzdWJqZWN0OiBzLm5hbWUsIGdyYWRlOiBzLmdyYWRlIH0pKSksXG4gICAgKTtcbiAgfVxuXG4gIC8vIEN1cnJpY3VsdW0gYW5kIFBsYW5uaW5nIFJlcG9ydCBNZXRob2RzXG4gIGFzeW5jIGdlbmVyYXRlQ3VycmljdWx1bUNvdmVyYWdlUmVwb3J0KHVzZXJJZDogbnVtYmVyKTogUHJvbWlzZTxDdXJyaWN1bHVtQ292ZXJhZ2VSZXBvcnQ+IHtcbiAgICB0cnkge1xuICAgICAgLy8gR2V0IGFsbCBjdXJyaWN1bHVtIGV4cGVjdGF0aW9ucyAtIHdlJ2xsIGZpbHRlciBieSBjb3ZlcmVkL3VuY292ZXJlZCBsYXRlclxuICAgICAgY29uc3QgZXhwZWN0YXRpb25zID0gYXdhaXQgdGhpcy5wcmlzbWEuY3VycmljdWx1bUV4cGVjdGF0aW9uLmZpbmRNYW55KCk7XG5cbiAgICAgIC8vIEdldCBhbGwgcGxhbnMgd2l0aCBleHBlY3RhdGlvbnNcbiAgICAgIGNvbnN0IGxvbmdSYW5nZVBsYW5zID0gYXdhaXQgdGhpcy5wcmlzbWEubG9uZ1JhbmdlUGxhbi5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7IHVzZXJJZCB9LFxuICAgICAgICBpbmNsdWRlOiB7IGV4cGVjdGF0aW9uczogdHJ1ZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHVuaXRQbGFucyA9IGF3YWl0IHRoaXMucHJpc21hLnVuaXRQbGFuLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgdXNlcklkIH0sXG4gICAgICAgIGluY2x1ZGU6IHsgZXhwZWN0YXRpb25zOiB0cnVlIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgbGVzc29uUGxhbnMgPSBhd2FpdCB0aGlzLnByaXNtYS5lVEZPTGVzc29uUGxhbi5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7IHVzZXJJZCB9LFxuICAgICAgICBpbmNsdWRlOiB7IGV4cGVjdGF0aW9uczogdHJ1ZSB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIENvbGxlY3QgYWxsIGNvdmVyZWQgZXhwZWN0YXRpb24gSURzXG4gICAgICBjb25zdCBjb3ZlcmVkRXhwZWN0YXRpb25JZHMgPSBuZXcgU2V0PHN0cmluZz4oKTtcblxuICAgICAgbG9uZ1JhbmdlUGxhbnMuZm9yRWFjaCgocGxhbikgPT4ge1xuICAgICAgICBwbGFuLmV4cGVjdGF0aW9ucy5mb3JFYWNoKChleHApID0+IGNvdmVyZWRFeHBlY3RhdGlvbklkcy5hZGQoZXhwLmV4cGVjdGF0aW9uSWQpKTtcbiAgICAgIH0pO1xuXG4gICAgICB1bml0UGxhbnMuZm9yRWFjaCgocGxhbikgPT4ge1xuICAgICAgICBwbGFuLmV4cGVjdGF0aW9ucy5mb3JFYWNoKChleHApID0+IGNvdmVyZWRFeHBlY3RhdGlvbklkcy5hZGQoZXhwLmV4cGVjdGF0aW9uSWQpKTtcbiAgICAgIH0pO1xuXG4gICAgICBsZXNzb25QbGFucy5mb3JFYWNoKChwbGFuKSA9PiB7XG4gICAgICAgIHBsYW4uZXhwZWN0YXRpb25zLmZvckVhY2goKGV4cCkgPT4gY292ZXJlZEV4cGVjdGF0aW9uSWRzLmFkZChleHAuZXhwZWN0YXRpb25JZCkpO1xuICAgICAgfSk7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBjb3ZlcmFnZVxuICAgICAgY29uc3QgdG90YWxFeHBlY3RhdGlvbnMgPSBleHBlY3RhdGlvbnMubGVuZ3RoO1xuICAgICAgY29uc3QgY292ZXJlZEV4cGVjdGF0aW9ucyA9IGNvdmVyZWRFeHBlY3RhdGlvbklkcy5zaXplO1xuICAgICAgY29uc3QgY292ZXJhZ2VQZXJjZW50YWdlID1cbiAgICAgICAgdG90YWxFeHBlY3RhdGlvbnMgPiAwID8gTWF0aC5yb3VuZCgoY292ZXJlZEV4cGVjdGF0aW9ucyAvIHRvdGFsRXhwZWN0YXRpb25zKSAqIDEwMCkgOiAwO1xuXG4gICAgICAvLyBGaW5kIHVuY292ZXJlZCBleHBlY3RhdGlvbnNcbiAgICAgIGNvbnN0IHVuY292ZXJlZEV4cGVjdGF0aW9ucyA9IGV4cGVjdGF0aW9uc1xuICAgICAgICAuZmlsdGVyKChleHApID0+ICFjb3ZlcmVkRXhwZWN0YXRpb25JZHMuaGFzKGV4cC5pZCkpXG4gICAgICAgIC5tYXAoKGV4cCkgPT4gKHtcbiAgICAgICAgICBpZDogZXhwLmlkLFxuICAgICAgICAgIGNvZGU6IGV4cC5jb2RlLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBleHAuZGVzY3JpcHRpb24sXG4gICAgICAgICAgc3RyYW5kOiBleHAuc3RyYW5kLFxuICAgICAgICB9KSk7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBjb3ZlcmFnZSBieSBzdHJhbmRcbiAgICAgIGNvbnN0IGNvdmVyYWdlQnlTdHJhbmQ6IFJlY29yZDxcbiAgICAgICAgc3RyaW5nLFxuICAgICAgICB7IHRvdGFsOiBudW1iZXI7IGNvdmVyZWQ6IG51bWJlcjsgcGVyY2VudGFnZTogbnVtYmVyIH1cbiAgICAgID4gPSB7fTtcblxuICAgICAgZXhwZWN0YXRpb25zLmZvckVhY2goKGV4cCkgPT4ge1xuICAgICAgICBpZiAoIWNvdmVyYWdlQnlTdHJhbmRbZXhwLnN0cmFuZF0pIHtcbiAgICAgICAgICBjb3ZlcmFnZUJ5U3RyYW5kW2V4cC5zdHJhbmRdID0geyB0b3RhbDogMCwgY292ZXJlZDogMCwgcGVyY2VudGFnZTogMCB9O1xuICAgICAgICB9XG4gICAgICAgIGNvdmVyYWdlQnlTdHJhbmRbZXhwLnN0cmFuZF0udG90YWwrKztcbiAgICAgICAgaWYgKGNvdmVyZWRFeHBlY3RhdGlvbklkcy5oYXMoZXhwLmlkKSkge1xuICAgICAgICAgIGNvdmVyYWdlQnlTdHJhbmRbZXhwLnN0cmFuZF0uY292ZXJlZCsrO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gQ2FsY3VsYXRlIHBlcmNlbnRhZ2VzIGZvciBlYWNoIHN0cmFuZFxuICAgICAgT2JqZWN0LmtleXMoY292ZXJhZ2VCeVN0cmFuZCkuZm9yRWFjaCgoc3RyYW5kKSA9PiB7XG4gICAgICAgIGNvbnN0IHN0cmFuZERhdGEgPSBjb3ZlcmFnZUJ5U3RyYW5kW3N0cmFuZF07XG4gICAgICAgIHN0cmFuZERhdGEucGVyY2VudGFnZSA9XG4gICAgICAgICAgc3RyYW5kRGF0YS50b3RhbCA+IDAgPyBNYXRoLnJvdW5kKChzdHJhbmREYXRhLmNvdmVyZWQgLyBzdHJhbmREYXRhLnRvdGFsKSAqIDEwMCkgOiAwO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvdGFsRXhwZWN0YXRpb25zLFxuICAgICAgICBjb3ZlcmVkRXhwZWN0YXRpb25zLFxuICAgICAgICBjb3ZlcmFnZVBlcmNlbnRhZ2UsXG4gICAgICAgIHVuY292ZXJlZEV4cGVjdGF0aW9ucyxcbiAgICAgICAgY292ZXJhZ2VCeVN0cmFuZCxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdlbmVyYXRlIGN1cnJpY3VsdW0gY292ZXJhZ2UgcmVwb3J0OicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdlbmVyYXRlUGxhbm5pbmdQcm9ncmVzc1JlcG9ydCh1c2VySWQ6IG51bWJlcik6IFByb21pc2U8UGxhbm5pbmdQcm9ncmVzc1JlcG9ydD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBHZXQgYWxsIHBsYW5uaW5nIGRhdGEgZm9yIHRoZSB1c2VyXG4gICAgICBjb25zdCBsb25nUmFuZ2VQbGFucyA9IGF3YWl0IHRoaXMucHJpc21hLmxvbmdSYW5nZVBsYW4uZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogeyB1c2VySWQgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCB1bml0UGxhbnMgPSBhd2FpdCB0aGlzLnByaXNtYS51bml0UGxhbi5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7IHVzZXJJZCB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGxlc3NvblBsYW5zID0gYXdhaXQgdGhpcy5wcmlzbWEuZVRGT0xlc3NvblBsYW4uZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogeyB1c2VySWQgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBkYXlib29rRW50cmllcyA9IGF3YWl0IHRoaXMucHJpc21hLmRheWJvb2tFbnRyeS5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlOiB7IHVzZXJJZCB9LFxuICAgICAgfSk7XG5cbiAgICAgIC8vIENhbGN1bGF0ZSBjb21wbGV0aW9uIHJhdGVzXG4gICAgICBjb25zdCBjYWxjdWxhdGVDb21wbGV0aW9uUmF0ZSA9IDxUPihwbGFuczogVFtdLCBpc0NvbXBsZXRlOiAocGxhbjogVCkgPT4gYm9vbGVhbikgPT4ge1xuICAgICAgICBjb25zdCB0b3RhbCA9IHBsYW5zLmxlbmd0aDtcbiAgICAgICAgY29uc3QgY29tcGxldGVkID0gcGxhbnMuZmlsdGVyKGlzQ29tcGxldGUpLmxlbmd0aDtcbiAgICAgICAgY29uc3QgY29tcGxldGlvblJhdGUgPSB0b3RhbCA+IDAgPyBNYXRoLnJvdW5kKChjb21wbGV0ZWQgLyB0b3RhbCkgKiAxMDApIDogMDtcbiAgICAgICAgcmV0dXJuIHsgdG90YWwsIGNvbXBsZXRlZCwgY29tcGxldGlvblJhdGUgfTtcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGxvbmdSYW5nZVBsYW5zOiBjYWxjdWxhdGVDb21wbGV0aW9uUmF0ZShcbiAgICAgICAgICBsb25nUmFuZ2VQbGFucyxcbiAgICAgICAgICAocGxhbikgPT4gcGxhbi5nb2FscyAhPT0gbnVsbCAmJiBwbGFuLmdvYWxzICE9PSAnJyxcbiAgICAgICAgKSxcbiAgICAgICAgdW5pdFBsYW5zOiBjYWxjdWxhdGVDb21wbGV0aW9uUmF0ZShcbiAgICAgICAgICB1bml0UGxhbnMsXG4gICAgICAgICAgKHBsYW4pID0+IHBsYW4uYmlnSWRlYXMgIT09IG51bGwgJiYgcGxhbi5iaWdJZGVhcyAhPT0gJycsXG4gICAgICAgICksXG4gICAgICAgIGxlc3NvblBsYW5zOiBjYWxjdWxhdGVDb21wbGV0aW9uUmF0ZShcbiAgICAgICAgICBsZXNzb25QbGFucyxcbiAgICAgICAgICAocGxhbikgPT4gcGxhbi5sZWFybmluZ0dvYWxzICE9PSBudWxsICYmIHBsYW4ubGVhcm5pbmdHb2FscyAhPT0gJycsXG4gICAgICAgICksXG4gICAgICAgIGRheWJvb2tFbnRyaWVzOiBjYWxjdWxhdGVDb21wbGV0aW9uUmF0ZShcbiAgICAgICAgICBkYXlib29rRW50cmllcyxcbiAgICAgICAgICAoZW50cnkpID0+IGVudHJ5LndoYXRXb3JrZWQgIT09IG51bGwgJiYgZW50cnkud2hhdFdvcmtlZCAhPT0gJycsXG4gICAgICAgICksXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBwbGFubmluZyBwcm9ncmVzcyByZXBvcnQ6JywgZXJyb3IpO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2VuZXJhdGVMZXNzb25QbGFuUmVwb3J0KGxlc3NvbklkOiBzdHJpbmcpOiBQcm9taXNlPExlc3NvblBsYW5SZXBvcnQ+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgbGVzc29uID0gYXdhaXQgdGhpcy5wcmlzbWEuZVRGT0xlc3NvblBsYW4uZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiBsZXNzb25JZCB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgdW5pdFBsYW46IHtcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgbG9uZ1JhbmdlUGxhbjogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBleHBlY3RhdGlvbnM6IHtcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgZXhwZWN0YXRpb246IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZGF5Ym9va0VudHJ5OiB0cnVlLFxuICAgICAgICAgIHJlc291cmNlczogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIWxlc3Nvbikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xlc3NvbiBwbGFuIG5vdCBmb3VuZCcpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBsZXNzb246IHtcbiAgICAgICAgICBpZDogbGVzc29uLmlkLFxuICAgICAgICAgIHRpdGxlOiBsZXNzb24udGl0bGUsXG4gICAgICAgICAgZGF0ZTogbGVzc29uLmRhdGUsXG4gICAgICAgICAgZHVyYXRpb246IGxlc3Nvbi5kdXJhdGlvbixcbiAgICAgICAgICBtaW5kc09uOiBsZXNzb24ubWluZHNPbiB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgYWN0aW9uOiBsZXNzb24uYWN0aW9uIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICBjb25zb2xpZGF0aW9uOiBsZXNzb24uY29uc29saWRhdGlvbiB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgbGVhcm5pbmdHb2FsczogbGVzc29uLmxlYXJuaW5nR29hbHMgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgIG1hdGVyaWFsczogQXJyYXkuaXNBcnJheShsZXNzb24ubWF0ZXJpYWxzKSA/IChsZXNzb24ubWF0ZXJpYWxzIGFzIHN0cmluZ1tdKSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICBpc1N1YkZyaWVuZGx5OiBsZXNzb24uaXNTdWJGcmllbmRseSxcbiAgICAgICAgfSxcbiAgICAgICAgaGllcmFyY2h5OiB7XG4gICAgICAgICAgbG9uZ1JhbmdlUGxhbjoge1xuICAgICAgICAgICAgaWQ6IGxlc3Nvbi51bml0UGxhbi5sb25nUmFuZ2VQbGFuLmlkLFxuICAgICAgICAgICAgdGl0bGU6IGxlc3Nvbi51bml0UGxhbi5sb25nUmFuZ2VQbGFuLnRpdGxlLFxuICAgICAgICAgICAgc3ViamVjdDogbGVzc29uLnVuaXRQbGFuLmxvbmdSYW5nZVBsYW4uc3ViamVjdCB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICBncmFkZTogbGVzc29uLnVuaXRQbGFuLmxvbmdSYW5nZVBsYW4uZ3JhZGUgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdW5pdFBsYW46IHtcbiAgICAgICAgICAgIGlkOiBsZXNzb24udW5pdFBsYW4uaWQsXG4gICAgICAgICAgICB0aXRsZTogbGVzc29uLnVuaXRQbGFuLnRpdGxlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGN1cnJpY3VsdW1BbGlnbm1lbnQ6IGxlc3Nvbi5leHBlY3RhdGlvbnMubWFwKChleHApID0+ICh7XG4gICAgICAgICAgaWQ6IGV4cC5leHBlY3RhdGlvbi5pZCxcbiAgICAgICAgICBjb2RlOiBleHAuZXhwZWN0YXRpb24uY29kZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogZXhwLmV4cGVjdGF0aW9uLmRlc2NyaXB0aW9uLFxuICAgICAgICAgIHN0cmFuZDogZXhwLmV4cGVjdGF0aW9uLnN0cmFuZCxcbiAgICAgICAgfSkpLFxuICAgICAgICByZWZsZWN0aW9uOiBsZXNzb24uZGF5Ym9va0VudHJ5XG4gICAgICAgICAgPyB7XG4gICAgICAgICAgICAgIHdoYXRXb3JrZWQ6IGxlc3Nvbi5kYXlib29rRW50cnkud2hhdFdvcmtlZCB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgIG92ZXJhbGxSYXRpbmc6IGxlc3Nvbi5kYXlib29rRW50cnkub3ZlcmFsbFJhdGluZyB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICAgIHdvdWxkUmV1c2VMZXNzb246IGxlc3Nvbi5kYXlib29rRW50cnkud291bGRSZXVzZUxlc3NvbiB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICB9XG4gICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgIHJlc291cmNlczogbGVzc29uLnJlc291cmNlcy5tYXAoKHJlc291cmNlKSA9PiAoe1xuICAgICAgICAgIGlkOiByZXNvdXJjZS5pZCxcbiAgICAgICAgICB0aXRsZTogcmVzb3VyY2UudGl0bGUsXG4gICAgICAgICAgdHlwZTogcmVzb3VyY2UudHlwZSxcbiAgICAgICAgICB1cmw6IHJlc291cmNlLnVybCB8fCB1bmRlZmluZWQsXG4gICAgICAgIH0pKSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdlbmVyYXRlIGxlc3NvbiBwbGFuIHJlcG9ydDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZVN1YnN0aXR1dGVQbGFuUmVwb3J0KGxlc3NvbklkOiBzdHJpbmcpOiBQcm9taXNlPFN1YnN0aXR1dGVQbGFuUmVwb3J0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGxlc3NvbiA9IGF3YWl0IHRoaXMucHJpc21hLmVURk9MZXNzb25QbGFuLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBpZDogbGVzc29uSWQgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIHVuaXRQbGFuOiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgIGxvbmdSYW5nZVBsYW46IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcmVzb3VyY2VzOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghbGVzc29uKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTGVzc29uIHBsYW4gbm90IGZvdW5kJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghbGVzc29uLmlzU3ViRnJpZW5kbHkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdMZXNzb24gcGxhbiBpcyBub3QgbWFya2VkIGFzIHN1YnN0aXR1dGUtZnJpZW5kbHknKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdGl0bGU6IGxlc3Nvbi50aXRsZSxcbiAgICAgICAgYmFzaWNJbmZvOiB7XG4gICAgICAgICAgc3ViamVjdDogbGVzc29uLnVuaXRQbGFuLmxvbmdSYW5nZVBsYW4uc3ViamVjdCB8fCAnTm90IHNwZWNpZmllZCcsXG4gICAgICAgICAgZ3JhZGU6IGxlc3Nvbi51bml0UGxhbi5sb25nUmFuZ2VQbGFuLmdyYWRlIHx8IDAsXG4gICAgICAgICAgZHVyYXRpb246IGxlc3Nvbi5kdXJhdGlvbixcbiAgICAgICAgICBkYXRlOiBsZXNzb24uZGF0ZSxcbiAgICAgICAgfSxcbiAgICAgICAgbWF0ZXJpYWxzOiBBcnJheS5pc0FycmF5KGxlc3Nvbi5tYXRlcmlhbHMpID8gKGxlc3Nvbi5tYXRlcmlhbHMgYXMgc3RyaW5nW10pIDogW10sXG4gICAgICAgIGFjdGl2aXRpZXM6IHtcbiAgICAgICAgICBvcGVuaW5nOiBsZXNzb24ubWluZHNPbiB8fCAnJyxcbiAgICAgICAgICBtYWluOiBsZXNzb24uYWN0aW9uIHx8ICcnLFxuICAgICAgICAgIGNsb3Npbmc6IGxlc3Nvbi5jb25zb2xpZGF0aW9uIHx8ICcnLFxuICAgICAgICB9LFxuICAgICAgICBzcGVjaWFsTm90ZXM6IGxlc3Nvbi5zdWJOb3RlcyB8fCB1bmRlZmluZWQsXG4gICAgICAgIHJlc291cmNlczogbGVzc29uLnJlc291cmNlcy5tYXAoKHJlc291cmNlKSA9PiAoe1xuICAgICAgICAgIGlkOiByZXNvdXJjZS5pZCxcbiAgICAgICAgICB0aXRsZTogcmVzb3VyY2UudGl0bGUsXG4gICAgICAgICAgdHlwZTogcmVzb3VyY2UudHlwZSxcbiAgICAgICAgICBjb250ZW50OiByZXNvdXJjZS5jb250ZW50IHx8IHVuZGVmaW5lZCxcbiAgICAgICAgfSkpLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZ2VuZXJhdGUgc3Vic3RpdHV0ZSBwbGFuIHJlcG9ydDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZVVuaXRPdmVydmlld1JlcG9ydCh1bml0SWQ6IHN0cmluZyk6IFByb21pc2U8VW5pdE92ZXJ2aWV3UmVwb3J0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVuaXQgPSBhd2FpdCB0aGlzLnByaXNtYS51bml0UGxhbi5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHVuaXRJZCB9LFxuICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgbG9uZ1JhbmdlUGxhbjogdHJ1ZSxcbiAgICAgICAgICBleHBlY3RhdGlvbnM6IHtcbiAgICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgICAgZXhwZWN0YXRpb246IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAgbGVzc29uUGxhbnM6IHRydWUsXG4gICAgICAgICAgcmVzb3VyY2VzOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghdW5pdCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuaXQgcGxhbiBub3QgZm91bmQnKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgdG90YWxEdXJhdGlvbiA9IHVuaXQubGVzc29uUGxhbnMucmVkdWNlKChzdW0sIGxlc3NvbikgPT4gc3VtICsgbGVzc29uLmR1cmF0aW9uLCAwKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdW5pdDoge1xuICAgICAgICAgIGlkOiB1bml0LmlkLFxuICAgICAgICAgIHRpdGxlOiB1bml0LnRpdGxlLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiB1bml0LmRlc2NyaXB0aW9uIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICBiaWdJZGVhczogdW5pdC5iaWdJZGVhcyB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgc3RhcnREYXRlOiB1bml0LnN0YXJ0RGF0ZSxcbiAgICAgICAgICBlbmREYXRlOiB1bml0LmVuZERhdGUsXG4gICAgICAgICAgZXN0aW1hdGVkSG91cnM6IHVuaXQuZXN0aW1hdGVkSG91cnMsXG4gICAgICAgIH0sXG4gICAgICAgIGhpZXJhcmNoeToge1xuICAgICAgICAgIGxvbmdSYW5nZVBsYW46IHtcbiAgICAgICAgICAgIGlkOiB1bml0LmxvbmdSYW5nZVBsYW4uaWQsXG4gICAgICAgICAgICB0aXRsZTogdW5pdC5sb25nUmFuZ2VQbGFuLnRpdGxlLFxuICAgICAgICAgICAgc3ViamVjdDogdW5pdC5sb25nUmFuZ2VQbGFuLnN1YmplY3QgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgICAgZ3JhZGU6IHVuaXQubG9uZ1JhbmdlUGxhbi5ncmFkZSB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgY3VycmljdWx1bUFsaWdubWVudDogdW5pdC5leHBlY3RhdGlvbnMubWFwKChleHApID0+ICh7XG4gICAgICAgICAgaWQ6IGV4cC5leHBlY3RhdGlvbi5pZCxcbiAgICAgICAgICBjb2RlOiBleHAuZXhwZWN0YXRpb24uY29kZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogZXhwLmV4cGVjdGF0aW9uLmRlc2NyaXB0aW9uLFxuICAgICAgICAgIHN0cmFuZDogZXhwLmV4cGVjdGF0aW9uLnN0cmFuZCxcbiAgICAgICAgfSkpLFxuICAgICAgICBsZXNzb25TdW1tYXJ5OiB7XG4gICAgICAgICAgdG90YWxMZXNzb25zOiB1bml0Lmxlc3NvblBsYW5zLmxlbmd0aCxcbiAgICAgICAgICB0b3RhbER1cmF0aW9uLFxuICAgICAgICAgIGxlc3NvbnM6IHVuaXQubGVzc29uUGxhbnMubWFwKChsZXNzb24pID0+ICh7XG4gICAgICAgICAgICBpZDogbGVzc29uLmlkLFxuICAgICAgICAgICAgdGl0bGU6IGxlc3Nvbi50aXRsZSxcbiAgICAgICAgICAgIGRhdGU6IGxlc3Nvbi5kYXRlLFxuICAgICAgICAgICAgZHVyYXRpb246IGxlc3Nvbi5kdXJhdGlvbixcbiAgICAgICAgICB9KSksXG4gICAgICAgIH0sXG4gICAgICAgIHJlc291cmNlczogdW5pdC5yZXNvdXJjZXMubWFwKChyZXNvdXJjZSkgPT4gKHtcbiAgICAgICAgICBpZDogcmVzb3VyY2UuaWQsXG4gICAgICAgICAgdGl0bGU6IHJlc291cmNlLnRpdGxlLFxuICAgICAgICAgIHR5cGU6IHJlc291cmNlLnR5cGUsXG4gICAgICAgIH0pKSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdlbmVyYXRlIHVuaXQgb3ZlcnZpZXcgcmVwb3J0OicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY29uc3QgcmVwb3J0R2VuZXJhdG9yU2VydmljZSA9IG5ldyBSZXBvcnRHZW5lcmF0b3JTZXJ2aWNlKCk7XG4iXSwidmVyc2lvbiI6M30=