031678c5701c20fb8611a95b07b56f0d
import { describe, it, expect } from '@jest/globals';
import { filterAvailableBlocksByCalendar } from '../../src/services/planningEngine';
describe('PlanningEngine Unit Tests', () => {
    describe('filterAvailableBlocksByCalendar', () => {
        const createTimetableSlot = (id, day, startMin, endMin, subjectId = 1) => ({
            id,
            day,
            startMin,
            endMin,
            subjectId,
        });
        const createCalendarEvent = (start, end, allDay = false) => ({
            id: 1,
            title: 'Test Event',
            description: null,
            start: new Date(start),
            end: new Date(end),
            allDay,
            eventType: 'ASSEMBLY',
            source: 'MANUAL',
            teacherId: 1,
            schoolId: null,
            createdAt: new Date(),
            updatedAt: new Date(),
        });
        const createHoliday = (date) => ({
            id: 1,
            title: 'Test Holiday',
            description: null,
            start: new Date(date),
            end: new Date(date),
            allDay: true,
            eventType: 'HOLIDAY',
            source: 'MANUAL',
            teacherId: 1,
            schoolId: null,
            createdAt: new Date(),
            updatedAt: new Date(),
        });
        it('should filter out slots without subjectId', () => {
            const slots = [
                createTimetableSlot(1, 1, 480, 540, 1), // Monday 8:00-9:00 AM with subject
                createTimetableSlot(2, 2, 540, 600, null), // Tuesday 9:00-10:00 AM without subject
                createTimetableSlot(3, 3, 600, 660, 2), // Wednesday 10:00-11:00 AM with subject
            ];
            const result = filterAvailableBlocksByCalendar(slots, [], [], []);
            expect(result).toHaveLength(2);
            expect(result[0].day).toBe(1);
            expect(result[1].day).toBe(3);
        });
        it('should filter out slots that conflict with holidays', () => {
            const slots = [
                createTimetableSlot(1, 1, 480, 540), // Monday
                createTimetableSlot(2, 2, 540, 600), // Tuesday
                createTimetableSlot(3, 3, 600, 660), // Wednesday
            ];
            // Holiday on Wednesday (day 2 in converted system)
            const holidays = [
                createHoliday('2024-01-03'), // Wednesday, converts to day 2
            ];
            const result = filterAvailableBlocksByCalendar(slots, [], [], holidays);
            // Should filter out Wednesday slot due to holiday
            expect(result.length).toBeLessThan(3);
            expect(result.every((block) => block.day !== 2)).toBe(true);
        });
        it('should filter out slots that conflict with all-day events', () => {
            const slots = [
                createTimetableSlot(1, 1, 480, 540), // Day 1 8:00-9:00 AM
                createTimetableSlot(2, 1, 600, 660), // Day 1 10:00-11:00 AM
            ];
            const events = [
                createCalendarEvent('2024-01-02T00:00:00', '2024-01-02T23:59:59', true), // Tuesday converts to day 1
            ];
            const result = filterAvailableBlocksByCalendar(slots, events, [], []);
            // All day 1 slots should be filtered out due to all-day event
            expect(result).toHaveLength(0);
        });
        it('should filter out slots that conflict with timed events', () => {
            const slots = [
                createTimetableSlot(1, 1, 480, 540), // Day 1 8:00-9:00 AM
                createTimetableSlot(2, 1, 540, 600), // Day 1 9:00-10:00 AM
                createTimetableSlot(3, 1, 600, 660), // Day 1 10:00-11:00 AM
            ];
            const events = [
                createCalendarEvent('2024-01-02T09:00:00.000Z', '2024-01-02T10:00:00.000Z', false), // 9:00-10:00 AM UTC event on day 1
            ];
            const result = filterAvailableBlocksByCalendar(slots, events, [], []);
            // Should keep 8:00-9:00 and 10:00-11:00 slots, filter out 9:00-10:00
            expect(result).toHaveLength(2);
            expect(result.some((block) => block.startMin === 540 && block.endMin === 600)).toBe(false);
        });
        it('should handle partial overlaps correctly', () => {
            const slots = [
                createTimetableSlot(1, 1, 480, 540), // Day 1 8:00-9:00 AM
                createTimetableSlot(2, 1, 520, 580), // Day 1 8:40-9:40 AM (overlaps)
            ];
            const events = [
                createCalendarEvent('2024-01-02T08:30:00.000Z', '2024-01-02T09:15:00.000Z', false), // 8:30-9:15 AM UTC event on day 1
            ];
            const result = filterAvailableBlocksByCalendar(slots, events, [], []);
            // Both slots should be filtered out due to overlap
            expect(result).toHaveLength(0);
        });
        it('should preserve slots that do not conflict', () => {
            const slots = [
                createTimetableSlot(1, 1, 480, 540), // Monday 8:00-9:00 AM
                createTimetableSlot(2, 2, 540, 600), // Tuesday 9:00-10:00 AM
                createTimetableSlot(3, 3, 600, 660), // Wednesday 10:00-11:00 AM
            ];
            const events = [
                createCalendarEvent('2024-01-02T14:00:00', '2024-01-02T15:00:00', false), // Tuesday 2:00-3:00 PM
            ];
            const result = filterAvailableBlocksByCalendar(slots, events, [], []);
            // All slots should be preserved as none conflict with the afternoon event
            expect(result).toHaveLength(3);
        });
        it('should handle multiple constraints simultaneously', () => {
            const slots = [
                createTimetableSlot(1, 1, 480, 540, null), // Monday 8:00-9:00 AM (no subject)
                createTimetableSlot(2, 2, 540, 600, 1), // Tuesday 9:00-10:00 AM (has subject, holiday)
                createTimetableSlot(3, 3, 600, 660, 1), // Wednesday 10:00-11:00 AM (has subject, event conflict)
                createTimetableSlot(4, 4, 480, 540, 1), // Thursday 8:00-9:00 AM (has subject, no conflicts)
            ];
            const events = [
                createCalendarEvent('2024-01-04T10:00:00.000Z', '2024-01-04T11:00:00.000Z', false), // Thursday event conflicts with day 3 slot
            ];
            const holidays = [
                createHoliday('2024-01-03'), // Wednesday holiday conflicts with day 2 slot
            ];
            const result = filterAvailableBlocksByCalendar(slots, events, [], holidays);
            // Only Thursday slot should remain
            expect(result).toHaveLength(1);
            expect(result[0].day).toBe(4);
        });
        it('should return correct DailyBlock format', () => {
            const slots = [createTimetableSlot(1, 1, 480, 540, 5)];
            const result = filterAvailableBlocksByCalendar(slots, [], [], []);
            expect(result).toHaveLength(1);
            expect(result[0]).toEqual({
                day: 1,
                slotId: 1,
                startMin: 480,
                endMin: 540,
                subjectId: 5,
            });
        });
        it('should handle edge case of event exactly matching slot time', () => {
            const slots = [
                createTimetableSlot(1, 1, 540, 600), // Day 1 9:00-10:00 AM
            ];
            const events = [
                createCalendarEvent('2024-01-02T09:00:00.000Z', '2024-01-02T10:00:00.000Z', false), // Exact match on day 1
            ];
            const result = filterAvailableBlocksByCalendar(slots, events, [], []);
            // Should filter out the exactly matching slot
            expect(result).toHaveLength(0);
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL21pY2hhZWxtY2lzYWFjL0dpdEh1Yi90ZWFjaGluZy1lbmdpbmUyLjAvc2VydmVyL3Rlc3RzL3VuaXQvcGxhbm5pbmdFbmdpbmUudW5pdC50ZXN0LnRzIiwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxRQUFRLEVBQUUsRUFBRSxFQUFFLE1BQU0sRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUNyRCxPQUFPLEVBQUUsK0JBQStCLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUdwRixRQUFRLENBQUMsMkJBQTJCLEVBQUUsR0FBRyxFQUFFO0lBQ3pDLFFBQVEsQ0FBQyxpQ0FBaUMsRUFBRSxHQUFHLEVBQUU7UUFDL0MsTUFBTSxtQkFBbUIsR0FBRyxDQUMxQixFQUFVLEVBQ1YsR0FBVyxFQUNYLFFBQWdCLEVBQ2hCLE1BQWMsRUFDZCxZQUEyQixDQUFDLEVBQ2IsRUFBRSxDQUFDLENBQUM7WUFDbkIsRUFBRTtZQUNGLEdBQUc7WUFDSCxRQUFRO1lBQ1IsTUFBTTtZQUNOLFNBQVM7U0FDVixDQUFDLENBQUM7UUFFSCxNQUFNLG1CQUFtQixHQUFHLENBQUMsS0FBYSxFQUFFLEdBQVcsRUFBRSxNQUFNLEdBQUcsS0FBSyxFQUFpQixFQUFFLENBQUMsQ0FBQztZQUMxRixFQUFFLEVBQUUsQ0FBQztZQUNMLEtBQUssRUFBRSxZQUFZO1lBQ25CLFdBQVcsRUFBRSxJQUFJO1lBQ2pCLEtBQUssRUFBRSxJQUFJLElBQUksQ0FBQyxLQUFLLENBQUM7WUFDdEIsR0FBRyxFQUFFLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQztZQUNsQixNQUFNO1lBQ04sU0FBUyxFQUFFLFVBQVU7WUFDckIsTUFBTSxFQUFFLFFBQVE7WUFDaEIsU0FBUyxFQUFFLENBQUM7WUFDWixRQUFRLEVBQUUsSUFBSTtZQUNkLFNBQVMsRUFBRSxJQUFJLElBQUksRUFBRTtZQUNyQixTQUFTLEVBQUUsSUFBSSxJQUFJLEVBQUU7U0FDdEIsQ0FBQyxDQUFDO1FBRUgsTUFBTSxhQUFhLEdBQUcsQ0FBQyxJQUFZLEVBQWlCLEVB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QUFFLEVBQUUsRUFBRSxDQUFDLENBQUM7WUFFdEUsOENBQThDO1lBQzlDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQyxZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDakMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9taWNoYWVsbWNpc2FhYy9HaXRIdWIvdGVhY2hpbmctZW5naW5lMi4wL3NlcnZlci90ZXN0cy91bml0L3BsYW5uaW5nRW5naW5lLnVuaXQudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZXNjcmliZSwgaXQsIGV4cGVjdCB9IGZyb20gJ0BqZXN0L2dsb2JhbHMnO1xuaW1wb3J0IHsgZmlsdGVyQXZhaWxhYmxlQmxvY2tzQnlDYWxlbmRhciB9IGZyb20gJy4uLy4uL3NyYy9zZXJ2aWNlcy9wbGFubmluZ0VuZ2luZSc7XG5pbXBvcnQgdHlwZSB7IFRpbWV0YWJsZVNsb3QsIENhbGVuZGFyRXZlbnQgfSBmcm9tICdAdGVhY2hpbmctZW5naW5lL2RhdGFiYXNlJztcblxuZGVzY3JpYmUoJ1BsYW5uaW5nRW5naW5lIFVuaXQgVGVzdHMnLCAoKSA9PiB7XG4gIGRlc2NyaWJlKCdmaWx0ZXJBdmFpbGFibGVCbG9ja3NCeUNhbGVuZGFyJywgKCkgPT4ge1xuICAgIGNvbnN0IGNyZWF0ZVRpbWV0YWJsZVNsb3QgPSAoXG4gICAgICBpZDogbnVtYmVyLFxuICAgICAgZGF5OiBudW1iZXIsXG4gICAgICBzdGFydE1pbjogbnVtYmVyLFxuICAgICAgZW5kTWluOiBudW1iZXIsXG4gICAgICBzdWJqZWN0SWQ6IG51bWJlciB8IG51bGwgPSAxLFxuICAgICk6IFRpbWV0YWJsZVNsb3QgPT4gKHtcbiAgICAgIGlkLFxuICAgICAgZGF5LFxuICAgICAgc3RhcnRNaW4sXG4gICAgICBlbmRNaW4sXG4gICAgICBzdWJqZWN0SWQsXG4gICAgfSk7XG5cbiAgICBjb25zdCBjcmVhdGVDYWxlbmRhckV2ZW50ID0gKHN0YXJ0OiBzdHJpbmcsIGVuZDogc3RyaW5nLCBhbGxEYXkgPSBmYWxzZSk6IENhbGVuZGFyRXZlbnQgPT4gKHtcbiAgICAgIGlkOiAxLFxuICAgICAgdGl0bGU6ICdUZXN0IEV2ZW50JyxcbiAgICAgIGRlc2NyaXB0aW9uOiBudWxsLFxuICAgICAgc3RhcnQ6IG5ldyBEYXRlKHN0YXJ0KSxcbiAgICAgIGVuZDogbmV3IERhdGUoZW5kKSxcbiAgICAgIGFsbERheSxcbiAgICAgIGV2ZW50VHlwZTogJ0FTU0VNQkxZJyxcbiAgICAgIHNvdXJjZTogJ01BTlVBTCcsXG4gICAgICB0ZWFjaGVySWQ6IDEsXG4gICAgICBzY2hvb2xJZDogbnVsbCxcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICB9KTtcblxuICAgIGNvbnN0IGNyZWF0ZUhvbGlkYXkgPSAoZGF0ZTogc3RyaW5nKTogQ2FsZW5kYXJFdmVudCA9PiAoe1xuICAgICAgaWQ6IDEsXG4gICAgICB0aXRsZTogJ1Rlc3QgSG9saWRheScsXG4gICAgICBkZXNjcmlwdGlvbjogbnVsbCxcbiAgICAgIHN0YXJ0OiBuZXcgRGF0ZShkYXRlKSxcbiAgICAgIGVuZDogbmV3IERhdGUoZGF0ZSksXG4gICAgICBhbGxEYXk6IHRydWUsXG4gICAgICBldmVudFR5cGU6ICdIT0xJREFZJyxcbiAgICAgIHNvdXJjZTogJ01BTlVBTCcsXG4gICAgICB0ZWFjaGVySWQ6IDEsXG4gICAgICBzY2hvb2xJZDogbnVsbCxcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICAgIHVwZGF0ZWRBdDogbmV3IERhdGUoKSxcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgZmlsdGVyIG91dCBzbG90cyB3aXRob3V0IHN1YmplY3RJZCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHNsb3RzOiBUaW1ldGFibGVTbG90W10gPSBbXG4gICAgICAgIGNyZWF0ZVRpbWV0YWJsZVNsb3QoMSwgMSwgNDgwLCA1NDAsIDEpLCAvLyBNb25kYXkgODowMC05OjAwIEFNIHdpdGggc3ViamVjdFxuICAgICAgICBjcmVhdGVUaW1ldGFibGVTbG90KDIsIDIsIDU0MCwgNjAwLCBudWxsKSwgLy8gVHVlc2RheSA5OjAwLTEwOjAwIEFNIHdpdGhvdXQgc3ViamVjdFxuICAgICAgICBjcmVhdGVUaW1ldGFibGVTbG90KDMsIDMsIDYwMCwgNjYwLCAyKSwgLy8gV2VkbmVzZGF5IDEwOjAwLTExOjAwIEFNIHdpdGggc3ViamVjdFxuICAgICAgXTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gZmlsdGVyQXZhaWxhYmxlQmxvY2tzQnlDYWxlbmRhcihzbG90cywgW10sIFtdLCBbXSk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZUxlbmd0aCgyKTtcbiAgICAgIGV4cGVjdChyZXN1bHRbMF0uZGF5KS50b0JlKDEpO1xuICAgICAgZXhwZWN0KHJlc3VsdFsxXS5kYXkpLnRvQmUoMyk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZpbHRlciBvdXQgc2xvdHMgdGhhdCBjb25mbGljdCB3aXRoIGhvbGlkYXlzJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2xvdHM6IFRpbWV0YWJsZVNsb3RbXSA9IFtcbiAgICAgICAgY3JlYXRlVGltZXRhYmxlU2xvdCgxLCAxLCA0ODAsIDU0MCksIC8vIE1vbmRheVxuICAgICAgICBjcmVhdGVUaW1ldGFibGVTbG90KDIsIDIsIDU0MCwgNjAwKSwgLy8gVHVlc2RheVxuICAgICAgICBjcmVhdGVUaW1ldGFibGVTbG90KDMsIDMsIDYwMCwgNjYwKSwgLy8gV2VkbmVzZGF5XG4gICAgICBdO1xuXG4gICAgICAvLyBIb2xpZGF5IG9uIFdlZG5lc2RheSAoZGF5IDIgaW4gY29udmVydGVkIHN5c3RlbSlcbiAgICAgIGNvbnN0IGhvbGlkYXlzOiBDYWxlbmRhckV2ZW50W10gPSBbXG4gICAgICAgIGNyZWF0ZUhvbGlkYXkoJzIwMjQtMDEtMDMnKSwgLy8gV2VkbmVzZGF5LCBjb252ZXJ0cyB0byBkYXkgMlxuICAgICAgXTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gZmlsdGVyQXZhaWxhYmxlQmxvY2tzQnlDYWxlbmRhcihzbG90cywgW10sIFtdLCBob2xpZGF5cyk7XG5cbiAgICAgIC8vIFNob3VsZCBmaWx0ZXIgb3V0IFdlZG5lc2RheSBzbG90IGR1ZSB0byBob2xpZGF5XG4gICAgICBleHBlY3QocmVzdWx0Lmxlbmd0aCkudG9CZUxlc3NUaGFuKDMpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5ldmVyeSgoYmxvY2spID0+IGJsb2NrLmRheSAhPT0gMikpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGZpbHRlciBvdXQgc2xvdHMgdGhhdCBjb25mbGljdCB3aXRoIGFsbC1kYXkgZXZlbnRzJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2xvdHM6IFRpbWV0YWJsZVNsb3RbXSA9IFtcbiAgICAgICAgY3JlYXRlVGltZXRhYmxlU2xvdCgxLCAxLCA0ODAsIDU0MCksIC8vIERheSAxIDg6MDAtOTowMCBBTVxuICAgICAgICBjcmVhdGVUaW1ldGFibGVTbG90KDIsIDEsIDYwMCwgNjYwKSwgLy8gRGF5IDEgMTA6MDAtMTE6MDAgQU1cbiAgICAgIF07XG5cbiAgICAgIGNvbnN0IGV2ZW50czogQ2FsZW5kYXJFdmVudFtdID0gW1xuICAgICAgICBjcmVhdGVDYWxlbmRhckV2ZW50KCcyMDI0LTAxLTAyVDAwOjAwOjAwJywgJzIwMjQtMDEtMDJUMjM6NTk6NTknLCB0cnVlKSwgLy8gVHVlc2RheSBjb252ZXJ0cyB0byBkYXkgMVxuICAgICAgXTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gZmlsdGVyQXZhaWxhYmxlQmxvY2tzQnlDYWxlbmRhcihzbG90cywgZXZlbnRzLCBbXSwgW10pO1xuXG4gICAgICAvLyBBbGwgZGF5IDEgc2xvdHMgc2hvdWxkIGJlIGZpbHRlcmVkIG91dCBkdWUgdG8gYWxsLWRheSBldmVudFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlTGVuZ3RoKDApO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBmaWx0ZXIgb3V0IHNsb3RzIHRoYXQgY29uZmxpY3Qgd2l0aCB0aW1lZCBldmVudHMnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzbG90czogVGltZXRhYmxlU2xvdFtdID0gW1xuICAgICAgICBjcmVhdGVUaW1ldGFibGVTbG90KDEsIDEsIDQ4MCwgNTQwKSwgLy8gRGF5IDEgODowMC05OjAwIEFNXG4gICAgICAgIGNyZWF0ZVRpbWV0YWJsZVNsb3QoMiwgMSwgNTQwLCA2MDApLCAvLyBEYXkgMSA5OjAwLTEwOjAwIEFNXG4gICAgICAgIGNyZWF0ZVRpbWV0YWJsZVNsb3QoMywgMSwgNjAwLCA2NjApLCAvLyBEYXkgMSAxMDowMC0xMTowMCBBTVxuICAgICAgXTtcblxuICAgICAgY29uc3QgZXZlbnRzOiBDYWxlbmRhckV2ZW50W10gPSBbXG4gICAgICAgIGNyZWF0ZUNhbGVuZGFyRXZlbnQoJzIwMjQtMDEtMDJUMDk6MDA6MDAuMDAwWicsICcyMDI0LTAxLTAyVDEwOjAwOjAwLjAwMFonLCBmYWxzZSksIC8vIDk6MDAtMTA6MDAgQU0gVVRDIGV2ZW50IG9uIGRheSAxXG4gICAgICBdO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBmaWx0ZXJBdmFpbGFibGVCbG9ja3NCeUNhbGVuZGFyKHNsb3RzLCBldmVudHMsIFtdLCBbXSk7XG5cbiAgICAgIC8vIFNob3VsZCBrZWVwIDg6MDAtOTowMCBhbmQgMTA6MDAtMTE6MDAgc2xvdHMsIGZpbHRlciBvdXQgOTowMC0xMDowMFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlTGVuZ3RoKDIpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zb21lKChibG9jaykgPT4gYmxvY2suc3RhcnRNaW4gPT09IDU0MCAmJiBibG9jay5lbmRNaW4gPT09IDYwMCkpLnRvQmUoZmFsc2UpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgcGFydGlhbCBvdmVybGFwcyBjb3JyZWN0bHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBzbG90czogVGltZXRhYmxlU2xvdFtdID0gW1xuICAgICAgICBjcmVhdGVUaW1ldGFibGVTbG90KDEsIDEsIDQ4MCwgNTQwKSwgLy8gRGF5IDEgODowMC05OjAwIEFNXG4gICAgICAgIGNyZWF0ZVRpbWV0YWJsZVNsb3QoMiwgMSwgNTIwLCA1ODApLCAvLyBEYXkgMSA4OjQwLTk6NDAgQU0gKG92ZXJsYXBzKVxuICAgICAgXTtcblxuICAgICAgY29uc3QgZXZlbnRzOiBDYWxlbmRhckV2ZW50W10gPSBbXG4gICAgICAgIGNyZWF0ZUNhbGVuZGFyRXZlbnQoJzIwMjQtMDEtMDJUMDg6MzA6MDAuMDAwWicsICcyMDI0LTAxLTAyVDA5OjE1OjAwLjAwMFonLCBmYWxzZSksIC8vIDg6MzAtOToxNSBBTSBVVEMgZXZlbnQgb24gZGF5IDFcbiAgICAgIF07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGZpbHRlckF2YWlsYWJsZUJsb2Nrc0J5Q2FsZW5kYXIoc2xvdHMsIGV2ZW50cywgW10sIFtdKTtcblxuICAgICAgLy8gQm90aCBzbG90cyBzaG91bGQgYmUgZmlsdGVyZWQgb3V0IGR1ZSB0byBvdmVybGFwXG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVMZW5ndGgoMCk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIHByZXNlcnZlIHNsb3RzIHRoYXQgZG8gbm90IGNvbmZsaWN0JywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2xvdHM6IFRpbWV0YWJsZVNsb3RbXSA9IFtcbiAgICAgICAgY3JlYXRlVGltZXRhYmxlU2xvdCgxLCAxLCA0ODAsIDU0MCksIC8vIE1vbmRheSA4OjAwLTk6MDAgQU1cbiAgICAgICAgY3JlYXRlVGltZXRhYmxlU2xvdCgyLCAyLCA1NDAsIDYwMCksIC8vIFR1ZXNkYXkgOTowMC0xMDowMCBBTVxuICAgICAgICBjcmVhdGVUaW1ldGFibGVTbG90KDMsIDMsIDYwMCwgNjYwKSwgLy8gV2VkbmVzZGF5IDEwOjAwLTExOjAwIEFNXG4gICAgICBdO1xuXG4gICAgICBjb25zdCBldmVudHM6IENhbGVuZGFyRXZlbnRbXSA9IFtcbiAgICAgICAgY3JlYXRlQ2FsZW5kYXJFdmVudCgnMjAyNC0wMS0wMlQxNDowMDowMCcsICcyMDI0LTAxLTAyVDE1OjAwOjAwJywgZmFsc2UpLCAvLyBUdWVzZGF5IDI6MDAtMzowMCBQTVxuICAgICAgXTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gZmlsdGVyQXZhaWxhYmxlQmxvY2tzQnlDYWxlbmRhcihzbG90cywgZXZlbnRzLCBbXSwgW10pO1xuXG4gICAgICAvLyBBbGwgc2xvdHMgc2hvdWxkIGJlIHByZXNlcnZlZCBhcyBub25lIGNvbmZsaWN0IHdpdGggdGhlIGFmdGVybm9vbiBldmVudFxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlTGVuZ3RoKDMpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgbXVsdGlwbGUgY29uc3RyYWludHMgc2ltdWx0YW5lb3VzbHknLCAoKSA9PiB7XG4gICAgICBjb25zdCBzbG90czogVGltZXRhYmxlU2xvdFtdID0gW1xuICAgICAgICBjcmVhdGVUaW1ldGFibGVTbG90KDEsIDEsIDQ4MCwgNTQwLCBudWxsKSwgLy8gTW9uZGF5IDg6MDAtOTowMCBBTSAobm8gc3ViamVjdClcbiAgICAgICAgY3JlYXRlVGltZXRhYmxlU2xvdCgyLCAyLCA1NDAsIDYwMCwgMSksIC8vIFR1ZXNkYXkgOTowMC0xMDowMCBBTSAoaGFzIHN1YmplY3QsIGhvbGlkYXkpXG4gICAgICAgIGNyZWF0ZVRpbWV0YWJsZVNsb3QoMywgMywgNjAwLCA2NjAsIDEpLCAvLyBXZWRuZXNkYXkgMTA6MDAtMTE6MDAgQU0gKGhhcyBzdWJqZWN0LCBldmVudCBjb25mbGljdClcbiAgICAgICAgY3JlYXRlVGltZXRhYmxlU2xvdCg0LCA0LCA0ODAsIDU0MCwgMSksIC8vIFRodXJzZGF5IDg6MDAtOTowMCBBTSAoaGFzIHN1YmplY3QsIG5vIGNvbmZsaWN0cylcbiAgICAgIF07XG5cbiAgICAgIGNvbnN0IGV2ZW50czogQ2FsZW5kYXJFdmVudFtdID0gW1xuICAgICAgICBjcmVhdGVDYWxlbmRhckV2ZW50KCcyMDI0LTAxLTA0VDEwOjAwOjAwLjAwMFonLCAnMjAyNC0wMS0wNFQxMTowMDowMC4wMDBaJywgZmFsc2UpLCAvLyBUaHVyc2RheSBldmVudCBjb25mbGljdHMgd2l0aCBkYXkgMyBzbG90XG4gICAgICBdO1xuXG4gICAgICBjb25zdCBob2xpZGF5czogQ2FsZW5kYXJFdmVudFtdID0gW1xuICAgICAgICBjcmVhdGVIb2xpZGF5KCcyMDI0LTAxLTAzJyksIC8vIFdlZG5lc2RheSBob2xpZGF5IGNvbmZsaWN0cyB3aXRoIGRheSAyIHNsb3RcbiAgICAgIF07XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGZpbHRlckF2YWlsYWJsZUJsb2Nrc0J5Q2FsZW5kYXIoc2xvdHMsIGV2ZW50cywgW10sIGhvbGlkYXlzKTtcblxuICAgICAgLy8gT25seSBUaHVyc2RheSBzbG90IHNob3VsZCByZW1haW5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZUxlbmd0aCgxKTtcbiAgICAgIGV4cGVjdChyZXN1bHRbMF0uZGF5KS50b0JlKDQpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gY29ycmVjdCBEYWlseUJsb2NrIGZvcm1hdCcsICgpID0+IHtcbiAgICAgIGNvbnN0IHNsb3RzOiBUaW1ldGFibGVTbG90W10gPSBbY3JlYXRlVGltZXRhYmxlU2xvdCgxLCAxLCA0ODAsIDU0MCwgNSldO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBmaWx0ZXJBdmFpbGFibGVCbG9ja3NCeUNhbGVuZGFyKHNsb3RzLCBbXSwgW10sIFtdKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHJlc3VsdFswXSkudG9FcXVhbCh7XG4gICAgICAgIGRheTogMSxcbiAgICAgICAgc2xvdElkOiAxLFxuICAgICAgICBzdGFydE1pbjogNDgwLFxuICAgICAgICBlbmRNaW46IDU0MCxcbiAgICAgICAgc3ViamVjdElkOiA1LFxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnc2hvdWxkIGhhbmRsZSBlZGdlIGNhc2Ugb2YgZXZlbnQgZXhhY3RseSBtYXRjaGluZyBzbG90IHRpbWUnLCAoKSA9PiB7XG4gICAgICBjb25zdCBzbG90czogVGltZXRhYmxlU2xvdFtdID0gW1xuICAgICAgICBjcmVhdGVUaW1ldGFibGVTbG90KDEsIDEsIDU0MCwgNjAwKSwgLy8gRGF5IDEgOTowMC0xMDowMCBBTVxuICAgICAgXTtcblxuICAgICAgY29uc3QgZXZlbnRzOiBDYWxlbmRhckV2ZW50W10gPSBbXG4gICAgICAgIGNyZWF0ZUNhbGVuZGFyRXZlbnQoJzIwMjQtMDEtMDJUMDk6MDA6MDAuMDAwWicsICcyMDI0LTAxLTAyVDEwOjAwOjAwLjAwMFonLCBmYWxzZSksIC8vIEV4YWN0IG1hdGNoIG9uIGRheSAxXG4gICAgICBdO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBmaWx0ZXJBdmFpbGFibGVCbG9ja3NCeUNhbGVuZGFyKHNsb3RzLCBldmVudHMsIFtdLCBbXSk7XG5cbiAgICAgIC8vIFNob3VsZCBmaWx0ZXIgb3V0IHRoZSBleGFjdGx5IG1hdGNoaW5nIHNsb3RcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZUxlbmd0aCgwKTtcbiAgICB9KTtcbiAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==