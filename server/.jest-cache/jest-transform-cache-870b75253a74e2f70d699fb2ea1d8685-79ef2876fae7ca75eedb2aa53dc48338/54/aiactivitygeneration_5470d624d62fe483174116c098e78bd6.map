{"file":"/Users/michaelmcisaac/GitHub/teaching-engine2.0/server/src/routes/ai-activity-generation.ts","mappings":"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","names":[],"sources":["/Users/michaelmcisaac/GitHub/teaching-engine2.0/server/src/routes/ai-activity-generation.ts"],"sourcesContent":["import { Router, Request, Response } from 'express';\nimport { z } from 'zod';\nimport { authMiddleware } from '../middleware/auth';\nimport { AIActivityGeneratorService } from '../services/aiActivityGeneratorService';\nimport { ActivityDiscoveryService } from '../services/activityDiscoveryService';\n\nconst router = Router();\nconst aiGenerator = new AIActivityGeneratorService();\nconst activityService = new ActivityDiscoveryService();\n\n// Schema for activity generation request\nconst generateActivitySchema = z.object({\n  searchQuery: z.string().optional(),\n  lessonContext: z\n    .object({\n      title: z.string(),\n      grade: z.number().min(1).max(8),\n      subject: z.string(),\n      learningGoals: z.array(z.string()),\n      duration: z.number().min(5).max(180),\n      section: z.enum(['mindsOn', 'action', 'consolidation']).optional(),\n    })\n    .optional(),\n  specificRequirements: z\n    .object({\n      activityType: z.string().optional(),\n      materials: z.array(z.string()).optional(),\n      groupSize: z.string().optional(),\n      language: z.string().optional(),\n      curriculumExpectations: z.array(z.string()).optional(),\n    })\n    .optional(),\n  useSearchResults: z.boolean().default(true),\n});\n\n// Schema for activity enhancement request\nconst enhanceActivitySchema = z.object({\n  activityId: z.string(),\n  enhancements: z.object({\n    addDifferentiation: z.boolean().optional(),\n    addAssessment: z.boolean().optional(),\n    adaptForGrade: z.number().min(1).max(8).optional(),\n    translateTo: z.string().optional(),\n    alignToCurriculum: z.array(z.string()).optional(),\n  }),\n});\n\n// Schema for saving generated activity\nconst saveActivitySchema = z.object({\n  activity: z.object({\n    title: z.string(),\n    description: z.string(),\n    detailedInstructions: z.array(z.string()),\n    duration: z.number(),\n    activityType: z.string(),\n    materials: z.array(z.string()),\n    groupSize: z.string(),\n    learningGoals: z.array(z.string()),\n    assessmentSuggestions: z.array(z.string()),\n    differentiation: z.object({\n      support: z.array(z.string()),\n      extension: z.array(z.string()),\n    }),\n    safetyConsiderations: z.array(z.string()).optional(),\n    technologyRequirements: z.array(z.string()).optional(),\n  }),\n  metadata: z\n    .object({\n      lessonPlanId: z.string().optional(),\n      basedOnActivities: z.array(z.string()).optional(),\n    })\n    .optional(),\n});\n\n/**\n * Generate an AI-powered activity\n */\nrouter.post('/generate', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const params = generateActivitySchema.parse(req.body);\n    let searchResults = undefined;\n\n    // If requested, perform a search first to get inspiration\n    if (params.useSearchResults && (params.searchQuery || params.lessonContext)) {\n      const searchParams = {\n        query: params.searchQuery || params.lessonContext?.title || '',\n        gradeLevel: params.lessonContext?.grade,\n        subject: params.lessonContext?.subject,\n        language: params.specificRequirements?.language || 'fr',\n        limit: 5,\n      };\n\n      const results = await activityService.search(searchParams, Number(req.user!.id));\n      searchResults = results;\n    }\n\n    // Generate the activity\n    const generatedActivity = await aiGenerator.generateActivity({\n      searchResults,\n      lessonContext: params.lessonContext,\n      specificRequirements: params.specificRequirements,\n    });\n\n    res.json({\n      success: true,\n      data: generatedActivity,\n    });\n  } catch (error) {\n    console.error('Error generating activity:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to generate activity',\n    });\n  }\n});\n\n/**\n * Generate multiple activity variations\n */\nrouter.post('/generate-variations', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const params = generateActivitySchema.parse(req.body);\n    const count = Math.min(req.body.count || 3, 5); // Max 5 variations\n\n    let searchResults = undefined;\n\n    // If requested, perform a search first\n    if (params.useSearchResults && (params.searchQuery || params.lessonContext)) {\n      const searchParams = {\n        query: params.searchQuery || params.lessonContext?.title || '',\n        gradeLevel: params.lessonContext?.grade,\n        subject: params.lessonContext?.subject,\n        language: params.specificRequirements?.language || 'fr',\n        limit: 10,\n      };\n\n      const results = await activityService.search(searchParams, Number(req.user!.id));\n      searchResults = results;\n    }\n\n    // Generate variations\n    const variations = await aiGenerator.generateActivityVariations(\n      {\n        searchResults,\n        lessonContext: params.lessonContext,\n        specificRequirements: params.specificRequirements,\n      },\n      count,\n    );\n\n    res.json({\n      success: true,\n      data: {\n        variations,\n        count: variations.length,\n      },\n    });\n  } catch (error) {\n    console.error('Error generating activity variations:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to generate activity variations',\n    });\n  }\n});\n\n/**\n * Enhance an existing activity\n */\nrouter.post('/enhance', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const params = enhanceActivitySchema.parse(req.body);\n\n    // Get the activity details\n    const activityDetails = await activityService.getActivityDetails(params.activityId);\n\n    if (!activityDetails) {\n      return res.status(404).json({\n        success: false,\n        error: 'Activity not found',\n      });\n    }\n\n    // Enhance the activity\n    const enhancements = await aiGenerator.enhanceActivity(activityDetails, params.enhancements);\n\n    res.json({\n      success: true,\n      data: enhancements,\n    });\n  } catch (error) {\n    console.error('Error enhancing activity:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to enhance activity',\n    });\n  }\n});\n\n/**\n * Save a generated activity\n */\nrouter.post('/save', authMiddleware, async (req: Request, res: Response) => {\n  try {\n    const params = saveActivitySchema.parse(req.body);\n\n    // Convert the activity object with proper defaults for required fields\n    const activityWithDefaults = {\n      title: params.activity.title,\n      description: params.activity.description,\n      detailedInstructions: params.activity.detailedInstructions,\n      duration: params.activity.duration,\n      activityType: params.activity.activityType,\n      materials: params.activity.materials,\n      groupSize: params.activity.groupSize,\n      learningGoals: params.activity.learningGoals,\n      assessmentSuggestions: params.activity.assessmentSuggestions,\n      differentiation: {\n        support: params.activity.differentiation.support,\n        extension: params.activity.differentiation.extension,\n      },\n      safetyConsiderations: params.activity.safetyConsiderations,\n      technologyRequirements: params.activity.technologyRequirements,\n    };\n\n    // Save the generated activity\n    const savedActivity = await aiGenerator.saveGeneratedActivity(\n      activityWithDefaults,\n      Number(req.user!.id),\n      params.metadata,\n    );\n\n    res.json({\n      success: true,\n      data: savedActivity,\n    });\n  } catch (error) {\n    console.error('Error saving generated activity:', error);\n    res.status(500).json({\n      success: false,\n      error: 'Failed to save generated activity',\n    });\n  }\n});\n\nexport default router;\n"],"version":3}