b354f3c8549460ff4a96e51a4d1cd10c
import { Router } from 'express';
import { prisma } from '../prisma';
import { validate } from '../validation';
import { z } from 'zod';
const router = Router();
// Validation schemas
const templateCreateSchema = z.object({
    title: z.string().min(1).max(255).regex(/^[^<>]*$/, 'Title cannot contain HTML tags'),
    titleFr: z.string().max(255).regex(/^[^<>]*$/, 'French title cannot contain HTML tags').optional(),
    description: z.string().max(2000).optional(),
    descriptionFr: z.string().max(2000).optional(),
    type: z.enum(['UNIT_PLAN', 'LESSON_PLAN']),
    category: z.enum(['BY_SUBJECT', 'BY_GRADE', 'BY_THEME', 'BY_SEASON', 'BY_SKILL', 'CUSTOM']),
    subject: z.string().max(100).optional(),
    gradeMin: z.number().int().min(1).max(12).optional(),
    gradeMax: z.number().int().min(1).max(12).optional(),
    tags: z.array(z.string().max(50)).max(20).optional(),
    keywords: z.array(z.string().max(50)).max(20).optional(),
    isPublic: z.boolean().optional(),
    estimatedWeeks: z.number().int().positive().max(52).optional(),
    estimatedMinutes: z.number().int().positive().max(480).optional(),
    content: z.object({
        // Unit Plan fields
        overview: z.string().optional(),
        learningGoals: z.array(z.string()).optional(),
        bigIdeas: z.string().optional(),
        essentialQuestions: z.array(z.string()).optional(),
        assessments: z.array(z.record(z.unknown())).optional(),
        activities: z.array(z.record(z.unknown())).optional(),
        successCriteria: z.array(z.string()).optional(),
        keyVocabulary: z.array(z.string()).optional(),
        crossCurricularConnections: z.string().optional(),
        differentiationStrategies: z.object({
            forStruggling: z.array(z.string()).optional(),
            forAdvanced: z.array(z.string()).optional(),
            forELL: z.array(z.string()).optional(),
            forIEP: z.array(z.string()).optional(),
        }).optional(),
        // Lesson Plan fields
        objectives: z.array(z.string()).optional(),
        materials: z.array(z.string()).optional(),
        mindsOn: z.string().optional(),
        action: z.string().optional(),
        consolidation: z.string().optional(),
        grouping: z.string().optional(),
        accommodations: z.array(z.string()).optional(),
        modifications: z.array(z.string()).optional(),
        extensions: z.array(z.string()).optional(),
        assessmentType: z.string().optional(),
        assessmentNotes: z.string().optional(),
    }),
    unitStructure: z.object({
        phases: z.array(z.object({
            name: z.string(),
            description: z.string().optional(),
            estimatedDays: z.number().optional(),
            learningGoals: z.array(z.string()).optional(),
        })).optional(),
        resources: z.array(z.object({
            title: z.string(),
            type: z.string(),
            url: z.string().optional(),
            notes: z.string().optional(),
        })).optional(),
    }).optional(),
    lessonStructure: z.object({
        duration: z.number().optional(),
        sections: z.array(z.object({
            name: z.string(),
            description: z.string(),
            timeAllocation: z.number().optional(),
            activities: z.array(z.string()).optional(),
        })).optional(),
    }).optional(),
});
const templateUpdateSchema = templateCreateSchema.partial();
const templateSearchSchema = z.object({
    type: z.enum(['UNIT_PLAN', 'LESSON_PLAN']).optional(),
    category: z.enum(['BY_SUBJECT', 'BY_GRADE', 'BY_THEME', 'BY_SEASON', 'BY_SKILL', 'CUSTOM']).optional(),
    subject: z.string().optional(),
    gradeMin: z.number().int().min(1).max(12).optional(),
    gradeMax: z.number().int().min(1).max(12).optional(),
    isSystem: z.boolean().optional(),
    isPublic: z.boolean().optional(),
    createdByUserId: z.number().int().optional(),
    search: z.string().optional(),
    tags: z.array(z.string()).optional(),
    sortBy: z.enum(['title', 'usageCount', 'averageRating', 'createdAt', 'lastUsedAt']).optional(),
    sortOrder: z.enum(['asc', 'desc']).optional(),
    limit: z.number().int().min(1).max(100).optional(),
    offset: z.number().int().min(0).optional(),
});
// Get all templates with filtering and search
router.get('/', async (req, res, _next) => {
    try {
        const userId = parseInt(req.user?.userId || '0', 10);
        if (!userId) {
            return res.status(401).json({ error: 'Unauthorized' });
        }
        const queryValidation = templateSearchSchema.safeParse(req.query);
        if (!queryValidation.success) {
            return res.status(400).json({ error: 'Invalid query parameters', details: queryValidation.error });
        }
        const { type, category, subject, gradeMin, gradeMax, isSystem, isPublic, createdByUserId, search, tags, sortBy = 'createdAt', sortOrder = 'desc', limit = 20, offset = 0, } = queryValidation.data;
        const where = {
            OR: [
                { isSystem: true }, // System templates visible to all
                { isPublic: true }, // Public templates visible to all
                { createdByUserId: userId }, // User's own templates
            ],
        };
        // Apply filters
        if (type)
            where.type = type;
        if (category)
            where.category = category;
        if (subject)
            where.subject = subject;
        if (gradeMin !== undefined || gradeMax !== undefined) {
            where.AND = [];
            if (gradeMin !== undefined) {
                where.AND.push({
                    OR: [
                        { gradeMin: { lte: gradeMin } },
                        { gradeMin: null },
                    ],
                });
            }
            if (gradeMax !== undefined) {
                where.AND.push({
                    OR: [
                        { gradeMax: { gte: gradeMax } },
                        { gradeMax: null },
                    ],
                });
            }
        }
        if (isSystem !== undefined)
            where.isSystem = isSystem;
        if (isPublic !== undefined)
            where.isPublic = isPublic;
        if (createdByUserId !== undefined)
            where.createdByUserId = createdByUserId;
        // Text search with database-specific case handling
        if (search) {
            const mode = process.env.DATABASE_URL?.includes('postgresql')
                ? { mode: 'insensitive' }
                : {};
            where.OR = [
                { title: { contains: search, ...mode } },
                { description: { contains: search, ...mode } },
                { titleFr: { contains: search, ...mode } },
                { descriptionFr: { contains: search, ...mode } },
            ];
        }
        // Tag filtering - Using JSON array contains for tags
        if (tags && tags.length > 0) {
            where.tags = {
                path: [],
                array_contains: tags
            }; // Type assertion for JSON array operations
        }
        // Sorting
        const orderBy = {};
        if (sortBy === 'title')
            orderBy.title = sortOrder;
        else if (sortBy === 'usageCount')
            orderBy.usageCount = sortOrder;
        else if (sortBy === 'averageRating')
            orderBy.averageRating = sortOrder;
        else if (sortBy === 'createdAt')
            orderBy.createdAt = sortOrder;
        else if (sortBy === 'lastUsedAt')
            orderBy.lastUsedAt = sortOrder;
        const templates = await prisma.planTemplate.findMany({
            where,
            orderBy,
            take: limit,
            skip: offset,
            include: {
                createdByUser: {
                    select: {
                        id: true,
                        name: true,
                    },
                },
                _count: {
                    select: {
                        ratings: true,
                        variations: true,
                    },
                },
            },
        });
        const total = await prisma.planTemplate.count({ where });
        res.json({
            templates,
            pagination: {
                total,
                limit,
                offset,
                hasMore: offset + limit < total,
            },
        });
    }
    catch (err) {
        _next(err);
    }
});
// Get a single template
router.get('/:id', async (req, res, _next) => {
    try {
        const userId = parseInt(req.user?.userId || '0', 10);
        if (!userId) {
            return res.status(401).json({ error: 'Unauthorized' });
        }
        const template = await prisma.planTemplate.findFirst({
            where: {
                id: req.params.id,
                OR: [
                    { isSystem: true },
                    { isPublic: true },
                    { createdByUserId: userId },
                ],
            },
            include: {
                createdByUser: {
                    select: {
                        id: true,
                        name: true,
                    },
                },
                ratings: {
                    select: {
                        id: true,
                        userId: true,
                        rating: true,
                        comment: true,
                        createdAt: true,
                    },
                    orderBy: { createdAt: 'desc' },
                    take: 5,
                },
                variations: {
                    orderBy: { createdAt: 'desc' },
                },
                _count: {
                    select: {
                        ratings: true,
                    },
                },
            },
        });
        if (!template) {
            return res.status(404).json({ error: 'Template not found' });
        }
        res.json(template);
    }
    catch (err) {
        _next(err);
    }
});
// Create a new template
router.post('/', validate(templateCreateSchema), async (req, res, _next) => {
    try {
        const userId = parseInt(req.user?.userId || '0', 10);
        if (!userId) {
            return res.status(401).json({ error: 'Unauthorized' });
        }
        const { tags = [], keywords = [], isPublic = false, content, unitStructure, lessonStructure, ...templateData } = req.body;
        // Validate grade range
        if (templateData.gradeMin && templateData.gradeMax && templateData.gradeMin > templateData.gradeMax) {
            return res.status(400).json({ error: 'Minimum grade cannot be greater than maximum grade' });
        }
        const template = await prisma.planTemplate.create({
            data: {
                ...templateData,
                createdByUserId: userId,
                tags,
                keywords,
                isPublic,
                content,
                unitStructure: unitStructure || null,
                lessonStructure: lessonStructure || null,
            },
            include: {
                createdByUser: {
                    select: {
                        id: true,
                        name: true,
                    },
                },
                _count: {
                    select: {
                        ratings: true,
                        variations: true,
                    },
                },
            },
        });
        res.status(201).json(template);
    }
    catch (err) {
        _next(err);
    }
});
// Update a template
router.put('/:id', validate(templateUpdateSchema), async (req, res, _next) => {
    try {
        const userId = parseInt(req.user?.userId || '0', 10);
        if (!userId) {
            return res.status(401).json({ error: 'Unauthorized' });
        }
        // Verify ownership (only creator can edit)
        const existing = await prisma.planTemplate.findFirst({
            where: {
                id: req.params.id,
                createdByUserId: userId,
                isSystem: false, // System templates cannot be edited
            },
        });
        if (!existing) {
            return res.status(404).json({ error: 'Template not found or not editable' });
        }
        const { gradeMin, gradeMax, ...updateData } = req.body;
        // Validate grade range if provided
        if (gradeMin && gradeMax && gradeMin > gradeMax) {
            return res.status(400).json({ error: 'Minimum grade cannot be greater than maximum grade' });
        }
        const template = await prisma.planTemplate.update({
            where: { id: req.params.id },
            data: {
                ...updateData,
                gradeMin,
                gradeMax,
            },
            include: {
                createdByUser: {
                    select: {
                        id: true,
                        name: true,
                    },
                },
                variations: true,
                _count: {
                    select: {
                        ratings: true,
                    },
                },
            },
        });
        res.json(template);
    }
    catch (err) {
        _next(err);
    }
});
// Delete a template
router.delete('/:id', async (req, res, _next) => {
    try {
        const userId = parseInt(req.user?.userId || '0', 10);
        if (!userId) {
            return res.status(401).json({ error: 'Unauthorized' });
        }
        // Verify ownership
        const template = await prisma.planTemplate.findFirst({
            where: {
                id: req.params.id,
                createdByUserId: userId,
                isSystem: false, // System templates cannot be deleted
            },
        });
        if (!template) {
            return res.status(404).json({ error: 'Template not found or not deletable' });
        }
        await prisma.planTemplate.delete({
            where: { id: req.params.id },
        });
        res.status(204).end();
    }
    catch (err) {
        _next(err);
    }
});
// Duplicate a template
router.post('/:id/duplicate', async (req, res, _next) => {
    try {
        const userId = parseInt(req.user?.userId || '0', 10);
        if (!userId) {
            return res.status(401).json({ error: 'Unauthorized' });
        }
        const { title, isPublic = false } = req.body;
        const original = await prisma.planTemplate.findFirst({
            where: {
                id: req.params.id,
                OR: [
                    { isSystem: true },
                    { isPublic: true },
                    { createdByUserId: userId },
                ],
            },
        });
        if (!original) {
            return res.status(404).json({ error: 'Template not found' });
        }
        const duplicated = await prisma.planTemplate.create({
            data: {
                title: title || `${original.title} (Copy)`,
                titleFr: original.titleFr ? `${original.titleFr} (Copie)` : null,
                description: original.description,
                descriptionFr: original.descriptionFr,
                type: original.type,
                category: original.category,
                subject: original.subject,
                gradeMin: original.gradeMin,
                gradeMax: original.gradeMax,
                tags: original.tags,
                keywords: original.keywords,
                createdByUserId: userId,
                isSystem: false,
                isPublic,
                content: original.content,
                estimatedWeeks: original.estimatedWeeks,
                unitStructure: original.unitStructure,
                estimatedMinutes: original.estimatedMinutes,
                lessonStructure: original.lessonStructure,
            },
            include: {
                createdByUser: {
                    select: {
                        id: true,
                        name: true,
                    },
                },
                _count: {
                    select: {
                        ratings: true,
                        variations: true,
                    },
                },
            },
        });
        res.status(201).json(duplicated);
    }
    catch (err) {
        _next(err);
    }
});
// Apply template to create a new plan
router.post('/:id/apply', async (req, res, _next) => {
    try {
        const userId = parseInt(req.user?.userId || '0', 10);
        if (!userId) {
            return res.status(401).json({ error: 'Unauthorized' });
        }
        const { customizations = {} } = req.body;
        const template = await prisma.planTemplate.findFirst({
            where: {
                id: req.params.id,
                OR: [
                    { isSystem: true },
                    { isPublic: true },
                    { createdByUserId: userId },
                ],
            },
        });
        if (!template) {
            return res.status(404).json({ error: 'Template not found' });
        }
        // Update usage tracking
        await prisma.planTemplate.update({
            where: { id: template.id },
            data: {
                usageCount: { increment: 1 },
                lastUsedAt: new Date(),
            },
        });
        // Merge template content with user customizations
        const appliedContent = {
            ...template.content,
            ...(customizations || {}),
        };
        res.json({
            template: {
                id: template.id,
                title: template.title,
                type: template.type,
                content: appliedContent,
                unitStructure: template.unitStructure,
                lessonStructure: template.lessonStructure,
                estimatedWeeks: template.estimatedWeeks,
                estimatedMinutes: template.estimatedMinutes,
            },
            appliedContent,
        });
    }
    catch (err) {
        _next(err);
    }
});
// Rate a template
router.post('/:id/rate', async (req, res, _next) => {
    try {
        const userId = parseInt(req.user?.userId || '0', 10);
        if (!userId) {
            return res.status(401).json({ error: 'Unauthorized' });
        }
        const { rating, comment } = req.body;
        if (!rating || rating < 1 || rating > 5) {
            return res.status(400).json({ error: 'Rating must be between 1 and 5' });
        }
        // Check if template exists and is accessible
        const template = await prisma.planTemplate.findFirst({
            where: {
                id: req.params.id,
                OR: [
                    { isSystem: true },
                    { isPublic: true },
                    { createdByUserId: userId },
                ],
            },
        });
        if (!template) {
            return res.status(404).json({ error: 'Template not found' });
        }
        // Upsert rating
        const templateRating = await prisma.templateRating.upsert({
            where: {
                templateId_userId: {
                    templateId: req.params.id,
                    userId,
                },
            },
            update: {
                rating,
                comment,
            },
            create: {
                templateId: req.params.id,
                userId,
                rating,
                comment,
            },
        });
        // Recalculate average rating
        const ratings = await prisma.templateRating.findMany({
            where: { templateId: req.params.id },
            select: { rating: true },
        });
        const averageRating = ratings.length > 0
            ? ratings.reduce((sum, r) => sum + r.rating, 0) / ratings.length
            : 0;
        await prisma.planTemplate.update({
            where: { id: req.params.id },
            data: { averageRating },
        });
        res.json(templateRating);
    }
    catch (err) {
        _next(err);
    }
});
// Get categories and subjects for filtering
router.get('/metadata/options', async (req, res, _next) => {
    try {
        const userId = parseInt(req.user?.userId || '0', 10);
        if (!userId) {
            return res.status(401).json({ error: 'Unauthorized' });
        }
        const [subjects, grades, categories, tags] = await Promise.all([
            prisma.planTemplate.findMany({
                where: {
                    OR: [
                        { isSystem: true },
                        { isPublic: true },
                        { createdByUserId: userId },
                    ],
                    subject: { not: null },
                },
                select: { subject: true },
                distinct: ['subject'],
            }),
            prisma.planTemplate.findMany({
                where: {
                    AND: [
                        {
                            OR: [
                                { isSystem: true },
                                { isPublic: true },
                                { createdByUserId: userId },
                            ],
                        },
                        {
                            OR: [
                                { gradeMin: { not: null } },
                                { gradeMax: { not: null } },
                            ],
                        },
                    ],
                },
                select: { gradeMin: true, gradeMax: true },
            }),
            prisma.planTemplate.findMany({
                select: { category: true },
                distinct: ['category'],
            }),
            prisma.planTemplate.findMany({
                where: {
                    OR: [
                        { isSystem: true },
                        { isPublic: true },
                        { createdByUserId: userId },
                    ],
                },
                select: { tags: true },
            }),
        ]);
        const uniqueSubjects = subjects
            .map(t => t.subject)
            .filter(s => s !== null)
            .sort();
        const gradeRange = grades.reduce((range, template) => {
            if (template.gradeMin)
                range.min = Math.min(range.min, template.gradeMin);
            if (template.gradeMax)
                range.max = Math.max(range.max, template.gradeMax);
            return range;
        }, { min: 12, max: 1 });
        const allTags = tags
            .flatMap(t => Array.isArray(t.tags) ? t.tags : [])
            .filter((tag, index, array) => array.indexOf(tag) === index)
            .sort();
        res.json({
            subjects: uniqueSubjects,
            grades: Array.from({ length: gradeRange.max - gradeRange.min + 1 }, (_, i) => gradeRange.min + i),
            categories: categories.map(c => c.category),
            tags: allTags,
        });
    }
    catch (err) {
        _next(err);
    }
});
export default router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL21pY2hhZWxtY2lzYWFjL0dpdEh1Yi90ZWFjaGluZy1lbmdpbmUyLjAvc2VydmVyL3NyYy9yb3V0ZXMvdGVtcGxhdGVzLnRzIiwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQVcsTUFBTSxTQUFTLENBQUM7QUFFMUMsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLFdBQVcsQ0FBQztBQUNuQyxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3pDLE9BQU8sRUFBRSxDQUFDLEVBQUUsTUFBTSxLQUFLLENBQUM7QUFNeEIsTUFBTSxNQUFNLEdBQUcsTUFBTSxFQUFFLENBQUM7QUFFeEIscUJBQXFCO0FBQ3JCLE1BQU0sb0JBQW9CLEdBQUcsQ0FBQyxDQUFDLE1BQU0sQ0FBQztJQUNwQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUMsS0FBSyxDQUFDLFVBQVUsRUFBRSxnQ0FBZ0MsQ0FBQztJQUNyRixPQUFPLEVBQUUsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQyxLQUFLLENBQUMsVUFBVSxFQUFFLHVDQUF1QyxDQUFDLENBQUMsUUFBUSxFQUFFO0lBQ2xHLFdBQVcsRUFBRSxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsRUFBRTtJQUM1QyxhQUFhLEVBQUUsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLEVBQUU7SUFDOUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxXQUFXLEVBQUUsYUFBYSxDQUFDLENBQUM7SUFDMUMsUUFBUSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxZQUFZLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBRSxXQUFXLEVBQUUsVUFBVSxFQUFF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QUFDLENBQUMsUUFBUSxFQUFFO1lBQ3RDLE1BQU0sRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLFFBQVEsRUFBRTtTQUN2QyxDQUFDLENBQUMsUUFBUSxFQUFFO1FBQ2IscUJBQXFCO1FBQ3JCLFVBQVUsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLFFBQVEsRUFBRTtRQUMxQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxRQUFRLEVBQUU7UUFDekMsT0FBTyxFQUFFLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7UUFDOUIsTUFBTSxFQUFFLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7UUFDN0IsYUFBYSxFQUFFLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7UUFDcEMsUUFBUSxFQUFFLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7UUFDL0IsY0FBYyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsUUFBUSxFQUFFO1FBQzlDLGFBQWEsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLFFBQVEsRUFBRTtRQUM3QyxVQUFVLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxRQUFRLEVBQUU7UUFDMUMsY0FBYyxFQUFFLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7UUFDckMsZUFBZSxFQUFFLENBQUMsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxRQUFRLEVBQUU7S0FDdkMsQ0FBQztJQUNGLGFBQWEsRUFBRSxDQUFDLENBQUMsTUFBTSxDQUFDO1FBQ3RCLE1BQU0sRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFD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ZW5naW5lMi4wL3NlcnZlci9zcmMvcm91dGVzL3RlbXBsYXRlcy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBSb3V0ZXIsIFJlcXVlc3QgfSBmcm9tICdleHByZXNzJztcbmltcG9ydCB7IFByaXNtYSB9IGZyb20gJy4uL3ByaXNtYSc7XG5pbXBvcnQgeyBwcmlzbWEgfSBmcm9tICcuLi9wcmlzbWEnO1xuaW1wb3J0IHsgdmFsaWRhdGUgfSBmcm9tICcuLi92YWxpZGF0aW9uJztcbmltcG9ydCB7IHogfSBmcm9tICd6b2QnO1xuXG5pbnRlcmZhY2UgQXV0aGVudGljYXRlZFJlcXVlc3QgZXh0ZW5kcyBSZXF1ZXN0IHtcbiAgdXNlcj86IHsgdXNlcklkOiBzdHJpbmcgfTtcbn1cblxuY29uc3Qgcm91dGVyID0gUm91dGVyKCk7XG5cbi8vIFZhbGlkYXRpb24gc2NoZW1hc1xuY29uc3QgdGVtcGxhdGVDcmVhdGVTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHRpdGxlOiB6LnN0cmluZygpLm1pbigxKS5tYXgoMjU1KS5yZWdleCgvXltePD5dKiQvLCAnVGl0bGUgY2Fubm90IGNvbnRhaW4gSFRNTCB0YWdzJyksXG4gIHRpdGxlRnI6IHouc3RyaW5nKCkubWF4KDI1NSkucmVnZXgoL15bXjw+XSokLywgJ0ZyZW5jaCB0aXRsZSBjYW5ub3QgY29udGFpbiBIVE1MIHRhZ3MnKS5vcHRpb25hbCgpLFxuICBkZXNjcmlwdGlvbjogei5zdHJpbmcoKS5tYXgoMjAwMCkub3B0aW9uYWwoKSxcbiAgZGVzY3JpcHRpb25Gcjogei5zdHJpbmcoKS5tYXgoMjAwMCkub3B0aW9uYWwoKSxcbiAgdHlwZTogei5lbnVtKFsnVU5JVF9QTEFOJywgJ0xFU1NPTl9QTEFOJ10pLFxuICBjYXRlZ29yeTogei5lbnVtKFsnQllfU1VCSkVDVCcsICdCWV9HUkFERScsICdCWV9USEVNRScsICdCWV9TRUFTT04nLCAnQllfU0tJTEwnLCAnQ1VTVE9NJ10pLFxuICBzdWJqZWN0OiB6LnN0cmluZygpLm1heCgxMDApLm9wdGlvbmFsKCksXG4gIGdyYWRlTWluOiB6Lm51bWJlcigpLmludCgpLm1pbigxKS5tYXgoMTIpLm9wdGlvbmFsKCksXG4gIGdyYWRlTWF4OiB6Lm51bWJlcigpLmludCgpLm1pbigxKS5tYXgoMTIpLm9wdGlvbmFsKCksXG4gIHRhZ3M6IHouYXJyYXkoei5zdHJpbmcoKS5tYXgoNTApKS5tYXgoMjApLm9wdGlvbmFsKCksXG4gIGtleXdvcmRzOiB6LmFycmF5KHouc3RyaW5nKCkubWF4KDUwKSkubWF4KDIwKS5vcHRpb25hbCgpLFxuICBpc1B1YmxpYzogei5ib29sZWFuKCkub3B0aW9uYWwoKSxcbiAgZXN0aW1hdGVkV2Vla3M6IHoubnVtYmVyKCkuaW50KCkucG9zaXRpdmUoKS5tYXgoNTIpLm9wdGlvbmFsKCksXG4gIGVzdGltYXRlZE1pbnV0ZXM6IHoubnVtYmVyKCkuaW50KCkucG9zaXRpdmUoKS5tYXgoNDgwKS5vcHRpb25hbCgpLFxuICBjb250ZW50OiB6Lm9iamVjdCh7XG4gICAgLy8gVW5pdCBQbGFuIGZpZWxkc1xuICAgIG92ZXJ2aWV3OiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgbGVhcm5pbmdHb2Fsczogei5hcnJheSh6LnN0cmluZygpKS5vcHRpb25hbCgpLFxuICAgIGJpZ0lkZWFzOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgZXNzZW50aWFsUXVlc3Rpb25zOiB6LmFycmF5KHouc3RyaW5nKCkpLm9wdGlvbmFsKCksXG4gICAgYXNzZXNzbWVudHM6IHouYXJyYXkoei5yZWNvcmQoei51bmtub3duKCkpKS5vcHRpb25hbCgpLFxuICAgIGFjdGl2aXRpZXM6IHouYXJyYXkoei5yZWNvcmQoei51bmtub3duKCkpKS5vcHRpb25hbCgpLFxuICAgIHN1Y2Nlc3NDcml0ZXJpYTogei5hcnJheSh6LnN0cmluZygpKS5vcHRpb25hbCgpLFxuICAgIGtleVZvY2FidWxhcnk6IHouYXJyYXkoei5zdHJpbmcoKSkub3B0aW9uYWwoKSxcbiAgICBjcm9zc0N1cnJpY3VsYXJDb25uZWN0aW9uczogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIGRpZmZlcmVudGlhdGlvblN0cmF0ZWdpZXM6IHoub2JqZWN0KHtcbiAgICAgIGZvclN0cnVnZ2xpbmc6IHouYXJyYXkoei5zdHJpbmcoKSkub3B0aW9uYWwoKSxcbiAgICAgIGZvckFkdmFuY2VkOiB6LmFycmF5KHouc3RyaW5nKCkpLm9wdGlvbmFsKCksXG4gICAgICBmb3JFTEw6IHouYXJyYXkoei5zdHJpbmcoKSkub3B0aW9uYWwoKSxcbiAgICAgIGZvcklFUDogei5hcnJheSh6LnN0cmluZygpKS5vcHRpb25hbCgpLFxuICAgIH0pLm9wdGlvbmFsKCksXG4gICAgLy8gTGVzc29uIFBsYW4gZmllbGRzXG4gICAgb2JqZWN0aXZlczogei5hcnJheSh6LnN0cmluZygpKS5vcHRpb25hbCgpLFxuICAgIG1hdGVyaWFsczogei5hcnJheSh6LnN0cmluZygpKS5vcHRpb25hbCgpLFxuICAgIG1pbmRzT246IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICBhY3Rpb246IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICBjb25zb2xpZGF0aW9uOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgZ3JvdXBpbmc6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICBhY2NvbW1vZGF0aW9uczogei5hcnJheSh6LnN0cmluZygpKS5vcHRpb25hbCgpLFxuICAgIG1vZGlmaWNhdGlvbnM6IHouYXJyYXkoei5zdHJpbmcoKSkub3B0aW9uYWwoKSxcbiAgICBleHRlbnNpb25zOiB6LmFycmF5KHouc3RyaW5nKCkpLm9wdGlvbmFsKCksXG4gICAgYXNzZXNzbWVudFR5cGU6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICBhc3Nlc3NtZW50Tm90ZXM6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgfSksXG4gIHVuaXRTdHJ1Y3R1cmU6IHoub2JqZWN0KHtcbiAgICBwaGFzZXM6IHouYXJyYXkoei5vYmplY3Qoe1xuICAgICAgbmFtZTogei5zdHJpbmcoKSxcbiAgICAgIGRlc2NyaXB0aW9uOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gICAgICBlc3RpbWF0ZWREYXlzOiB6Lm51bWJlcigpLm9wdGlvbmFsKCksXG4gICAgICBsZWFybmluZ0dvYWxzOiB6LmFycmF5KHouc3RyaW5nKCkpLm9wdGlvbmFsKCksXG4gICAgfSkpLm9wdGlvbmFsKCksXG4gICAgcmVzb3VyY2VzOiB6LmFycmF5KHoub2JqZWN0KHtcbiAgICAgIHRpdGxlOiB6LnN0cmluZygpLFxuICAgICAgdHlwZTogei5zdHJpbmcoKSxcbiAgICAgIHVybDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgICAgbm90ZXM6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICB9KSkub3B0aW9uYWwoKSxcbiAgfSkub3B0aW9uYWwoKSxcbiAgbGVzc29uU3RydWN0dXJlOiB6Lm9iamVjdCh7XG4gICAgZHVyYXRpb246IHoubnVtYmVyKCkub3B0aW9uYWwoKSxcbiAgICBzZWN0aW9uczogei5hcnJheSh6Lm9iamVjdCh7XG4gICAgICBuYW1lOiB6LnN0cmluZygpLFxuICAgICAgZGVzY3JpcHRpb246IHouc3RyaW5nKCksXG4gICAgICB0aW1lQWxsb2NhdGlvbjogei5udW1iZXIoKS5vcHRpb25hbCgpLFxuICAgICAgYWN0aXZpdGllczogei5hcnJheSh6LnN0cmluZygpKS5vcHRpb25hbCgpLFxuICAgIH0pKS5vcHRpb25hbCgpLFxuICB9KS5vcHRpb25hbCgpLFxufSk7XG5cbmNvbnN0IHRlbXBsYXRlVXBkYXRlU2NoZW1hID0gdGVtcGxhdGVDcmVhdGVTY2hlbWEucGFydGlhbCgpO1xuXG5jb25zdCB0ZW1wbGF0ZVNlYXJjaFNjaGVtYSA9IHoub2JqZWN0KHtcbiAgdHlwZTogei5lbnVtKFsnVU5JVF9QTEFOJywgJ0xFU1NPTl9QTEFOJ10pLm9wdGlvbmFsKCksXG4gIGNhdGVnb3J5OiB6LmVudW0oWydCWV9TVUJKRUNUJywgJ0JZX0dSQURFJywgJ0JZX1RIRU1FJywgJ0JZX1NFQVNPTicsICdCWV9TS0lMTCcsICdDVVNUT00nXSkub3B0aW9uYWwoKSxcbiAgc3ViamVjdDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICBncmFkZU1pbjogei5udW1iZXIoKS5pbnQoKS5taW4oMSkubWF4KDEyKS5vcHRpb25hbCgpLFxuICBncmFkZU1heDogei5udW1iZXIoKS5pbnQoKS5taW4oMSkubWF4KDEyKS5vcHRpb25hbCgpLFxuICBpc1N5c3RlbTogei5ib29sZWFuKCkub3B0aW9uYWwoKSxcbiAgaXNQdWJsaWM6IHouYm9vbGVhbigpLm9wdGlvbmFsKCksXG4gIGNyZWF0ZWRCeVVzZXJJZDogei5udW1iZXIoKS5pbnQoKS5vcHRpb25hbCgpLFxuICBzZWFyY2g6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgdGFnczogei5hcnJheSh6LnN0cmluZygpKS5vcHRpb25hbCgpLFxuICBzb3J0Qnk6IHouZW51bShbJ3RpdGxlJywgJ3VzYWdlQ291bnQnLCAnYXZlcmFnZVJhdGluZycsICdjcmVhdGVkQXQnLCAnbGFzdFVzZWRBdCddKS5vcHRpb25hbCgpLFxuICBzb3J0T3JkZXI6IHouZW51bShbJ2FzYycsICdkZXNjJ10pLm9wdGlvbmFsKCksXG4gIGxpbWl0OiB6Lm51bWJlcigpLmludCgpLm1pbigxKS5tYXgoMTAwKS5vcHRpb25hbCgpLFxuICBvZmZzZXQ6IHoubnVtYmVyKCkuaW50KCkubWluKDApLm9wdGlvbmFsKCksXG59KTtcblxuLy8gR2V0IGFsbCB0ZW1wbGF0ZXMgd2l0aCBmaWx0ZXJpbmcgYW5kIHNlYXJjaFxucm91dGVyLmdldCgnLycsIGFzeW5jIChyZXE6IEF1dGhlbnRpY2F0ZWRSZXF1ZXN0LCByZXMsIF9uZXh0KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXNlcklkID0gcGFyc2VJbnQocmVxLnVzZXI/LnVzZXJJZCB8fCAnMCcsIDEwKTtcbiAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHF1ZXJ5VmFsaWRhdGlvbiA9IHRlbXBsYXRlU2VhcmNoU2NoZW1hLnNhZmVQYXJzZShyZXEucXVlcnkpO1xuICAgIGlmICghcXVlcnlWYWxpZGF0aW9uLnN1Y2Nlc3MpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnSW52YWxpZCBxdWVyeSBwYXJhbWV0ZXJzJywgZGV0YWlsczogcXVlcnlWYWxpZGF0aW9uLmVycm9yIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHtcbiAgICAgIHR5cGUsXG4gICAgICBjYXRlZ29yeSxcbiAgICAgIHN1YmplY3QsXG4gICAgICBncmFkZU1pbixcbiAgICAgIGdyYWRlTWF4LFxuICAgICAgaXNTeXN0ZW0sXG4gICAgICBpc1B1YmxpYyxcbiAgICAgIGNyZWF0ZWRCeVVzZXJJZCxcbiAgICAgIHNlYXJjaCxcbiAgICAgIHRhZ3MsXG4gICAgICBzb3J0QnkgPSAnY3JlYXRlZEF0JyxcbiAgICAgIHNvcnRPcmRlciA9ICdkZXNjJyxcbiAgICAgIGxpbWl0ID0gMjAsXG4gICAgICBvZmZzZXQgPSAwLFxuICAgIH0gPSBxdWVyeVZhbGlkYXRpb24uZGF0YTtcblxuICAgIGNvbnN0IHdoZXJlOiBQcmlzbWEuUGxhblRlbXBsYXRlV2hlcmVJbnB1dCA9IHtcbiAgICAgIE9SOiBbXG4gICAgICAgIHsgaXNTeXN0ZW06IHRydWUgfSwgLy8gU3lzdGVtIHRlbXBsYXRlcyB2aXNpYmxlIHRvIGFsbFxuICAgICAgICB7IGlzUHVibGljOiB0cnVlIH0sIC8vIFB1YmxpYyB0ZW1wbGF0ZXMgdmlzaWJsZSB0byBhbGxcbiAgICAgICAgeyBjcmVhdGVkQnlVc2VySWQ6IHVzZXJJZCB9LCAvLyBVc2VyJ3Mgb3duIHRlbXBsYXRlc1xuICAgICAgXSxcbiAgICB9O1xuXG4gICAgLy8gQXBwbHkgZmlsdGVyc1xuICAgIGlmICh0eXBlKSB3aGVyZS50eXBlID0gdHlwZTtcbiAgICBpZiAoY2F0ZWdvcnkpIHdoZXJlLmNhdGVnb3J5ID0gY2F0ZWdvcnk7XG4gICAgaWYgKHN1YmplY3QpIHdoZXJlLnN1YmplY3QgPSBzdWJqZWN0O1xuICAgIGlmIChncmFkZU1pbiAhPT0gdW5kZWZpbmVkIHx8IGdyYWRlTWF4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIHdoZXJlLkFORCA9IFtdO1xuICAgICAgaWYgKGdyYWRlTWluICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgd2hlcmUuQU5ELnB1c2goe1xuICAgICAgICAgIE9SOiBbXG4gICAgICAgICAgICB7IGdyYWRlTWluOiB7IGx0ZTogZ3JhZGVNaW4gfSB9LFxuICAgICAgICAgICAgeyBncmFkZU1pbjogbnVsbCB9LFxuICAgICAgICAgIF0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKGdyYWRlTWF4ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgd2hlcmUuQU5ELnB1c2goe1xuICAgICAgICAgIE9SOiBbXG4gICAgICAgICAgICB7IGdyYWRlTWF4OiB7IGd0ZTogZ3JhZGVNYXggfSB9LFxuICAgICAgICAgICAgeyBncmFkZU1heDogbnVsbCB9LFxuICAgICAgICAgIF0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoaXNTeXN0ZW0gIT09IHVuZGVmaW5lZCkgd2hlcmUuaXNTeXN0ZW0gPSBpc1N5c3RlbTtcbiAgICBpZiAoaXNQdWJsaWMgIT09IHVuZGVmaW5lZCkgd2hlcmUuaXNQdWJsaWMgPSBpc1B1YmxpYztcbiAgICBpZiAoY3JlYXRlZEJ5VXNlcklkICE9PSB1bmRlZmluZWQpIHdoZXJlLmNyZWF0ZWRCeVVzZXJJZCA9IGNyZWF0ZWRCeVVzZXJJZDtcblxuICAgIC8vIFRleHQgc2VhcmNoIHdpdGggZGF0YWJhc2Utc3BlY2lmaWMgY2FzZSBoYW5kbGluZ1xuICAgIGlmIChzZWFyY2gpIHtcbiAgICAgIGNvbnN0IG1vZGUgPSBwcm9jZXNzLmVudi5EQVRBQkFTRV9VUkw/LmluY2x1ZGVzKCdwb3N0Z3Jlc3FsJykgXG4gICAgICAgID8geyBtb2RlOiAnaW5zZW5zaXRpdmUnIGFzIGNvbnN0IH0gXG4gICAgICAgIDoge307XG4gICAgICAgIFxuICAgICAgd2hlcmUuT1IgPSBbXG4gICAgICAgIHsgdGl0bGU6IHsgY29udGFpbnM6IHNlYXJjaCwgLi4ubW9kZSB9IH0sXG4gICAgICAgIHsgZGVzY3JpcHRpb246IHsgY29udGFpbnM6IHNlYXJjaCwgLi4ubW9kZSB9IH0sXG4gICAgICAgIHsgdGl0bGVGcjogeyBjb250YWluczogc2VhcmNoLCAuLi5tb2RlIH0gfSxcbiAgICAgICAgeyBkZXNjcmlwdGlvbkZyOiB7IGNvbnRhaW5zOiBzZWFyY2gsIC4uLm1vZGUgfSB9LFxuICAgICAgXTtcbiAgICB9XG5cbiAgICAvLyBUYWcgZmlsdGVyaW5nIC0gVXNpbmcgSlNPTiBhcnJheSBjb250YWlucyBmb3IgdGFnc1xuICAgIGlmICh0YWdzICYmIHRhZ3MubGVuZ3RoID4gMCkge1xuICAgICAgd2hlcmUudGFncyA9IHtcbiAgICAgICAgcGF0aDogW10sXG4gICAgICAgIGFycmF5X2NvbnRhaW5zOiB0YWdzXG4gICAgICB9IGFzIFByaXNtYS5Kc29uRmlsdGVyOyAvLyBUeXBlIGFzc2VydGlvbiBmb3IgSlNPTiBhcnJheSBvcGVyYXRpb25zXG4gICAgfVxuXG4gICAgLy8gU29ydGluZ1xuICAgIGNvbnN0IG9yZGVyQnk6IFByaXNtYS5QbGFuVGVtcGxhdGVPcmRlckJ5V2l0aFJlbGF0aW9uSW5wdXQgPSB7fTtcbiAgICBpZiAoc29ydEJ5ID09PSAndGl0bGUnKSBvcmRlckJ5LnRpdGxlID0gc29ydE9yZGVyO1xuICAgIGVsc2UgaWYgKHNvcnRCeSA9PT0gJ3VzYWdlQ291bnQnKSBvcmRlckJ5LnVzYWdlQ291bnQgPSBzb3J0T3JkZXI7XG4gICAgZWxzZSBpZiAoc29ydEJ5ID09PSAnYXZlcmFnZVJhdGluZycpIG9yZGVyQnkuYXZlcmFnZVJhdGluZyA9IHNvcnRPcmRlcjtcbiAgICBlbHNlIGlmIChzb3J0QnkgPT09ICdjcmVhdGVkQXQnKSBvcmRlckJ5LmNyZWF0ZWRBdCA9IHNvcnRPcmRlcjtcbiAgICBlbHNlIGlmIChzb3J0QnkgPT09ICdsYXN0VXNlZEF0Jykgb3JkZXJCeS5sYXN0VXNlZEF0ID0gc29ydE9yZGVyO1xuXG4gICAgY29uc3QgdGVtcGxhdGVzID0gYXdhaXQgcHJpc21hLnBsYW5UZW1wbGF0ZS5maW5kTWFueSh7XG4gICAgICB3aGVyZSxcbiAgICAgIG9yZGVyQnksXG4gICAgICB0YWtlOiBsaW1pdCxcbiAgICAgIHNraXA6IG9mZnNldCxcbiAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgY3JlYXRlZEJ5VXNlcjoge1xuICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIF9jb3VudDoge1xuICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgcmF0aW5nczogdHJ1ZSxcbiAgICAgICAgICAgIHZhcmlhdGlvbnM6IHRydWUsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBjb25zdCB0b3RhbCA9IGF3YWl0IHByaXNtYS5wbGFuVGVtcGxhdGUuY291bnQoeyB3aGVyZSB9KTtcblxuICAgIHJlcy5qc29uKHtcbiAgICAgIHRlbXBsYXRlcyxcbiAgICAgIHBhZ2luYXRpb246IHtcbiAgICAgICAgdG90YWwsXG4gICAgICAgIGxpbWl0LFxuICAgICAgICBvZmZzZXQsXG4gICAgICAgIGhhc01vcmU6IG9mZnNldCArIGxpbWl0IDwgdG90YWwsXG4gICAgICB9LFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBfbmV4dChlcnIpO1xuICB9XG59KTtcblxuLy8gR2V0IGEgc2luZ2xlIHRlbXBsYXRlXG5yb3V0ZXIuZ2V0KCcvOmlkJywgYXN5bmMgKHJlcTogQXV0aGVudGljYXRlZFJlcXVlc3QsIHJlcywgX25leHQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VySWQgPSBwYXJzZUludChyZXEudXNlcj8udXNlcklkIHx8ICcwJywgMTApO1xuICAgIGlmICghdXNlcklkKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgdGVtcGxhdGUgPSBhd2FpdCBwcmlzbWEucGxhblRlbXBsYXRlLmZpbmRGaXJzdCh7XG4gICAgICB3aGVyZToge1xuICAgICAgICBpZDogcmVxLnBhcmFtcy5pZCxcbiAgICAgICAgT1I6IFtcbiAgICAgICAgICB7IGlzU3lzdGVtOiB0cnVlIH0sXG4gICAgICAgICAgeyBpc1B1YmxpYzogdHJ1ZSB9LFxuICAgICAgICAgIHsgY3JlYXRlZEJ5VXNlcklkOiB1c2VySWQgfSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgICBpbmNsdWRlOiB7XG4gICAgICAgIGNyZWF0ZWRCeVVzZXI6IHtcbiAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICByYXRpbmdzOiB7XG4gICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgIHVzZXJJZDogdHJ1ZSxcbiAgICAgICAgICAgIHJhdGluZzogdHJ1ZSxcbiAgICAgICAgICAgIGNvbW1lbnQ6IHRydWUsXG4gICAgICAgICAgICBjcmVhdGVkQXQ6IHRydWUsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH0sXG4gICAgICAgICAgdGFrZTogNSxcbiAgICAgICAgfSxcbiAgICAgICAgdmFyaWF0aW9uczoge1xuICAgICAgICAgIG9yZGVyQnk6IHsgY3JlYXRlZEF0OiAnZGVzYycgfSxcbiAgICAgICAgfSxcbiAgICAgICAgX2NvdW50OiB7XG4gICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICByYXRpbmdzOiB0cnVlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgaWYgKCF0ZW1wbGF0ZSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdUZW1wbGF0ZSBub3QgZm91bmQnIH0pO1xuICAgIH1cblxuICAgIHJlcy5qc29uKHRlbXBsYXRlKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgX25leHQoZXJyKTtcbiAgfVxufSk7XG5cbi8vIENyZWF0ZSBhIG5ldyB0ZW1wbGF0ZVxucm91dGVyLnBvc3QoJy8nLCB2YWxpZGF0ZSh0ZW1wbGF0ZUNyZWF0ZVNjaGVtYSksIGFzeW5jIChyZXE6IEF1dGhlbnRpY2F0ZWRSZXF1ZXN0LCByZXMsIF9uZXh0KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXNlcklkID0gcGFyc2VJbnQocmVxLnVzZXI/LnVzZXJJZCB8fCAnMCcsIDEwKTtcbiAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHtcbiAgICAgIHRhZ3MgPSBbXSxcbiAgICAgIGtleXdvcmRzID0gW10sXG4gICAgICBpc1B1YmxpYyA9IGZhbHNlLFxuICAgICAgY29udGVudCxcbiAgICAgIHVuaXRTdHJ1Y3R1cmUsXG4gICAgICBsZXNzb25TdHJ1Y3R1cmUsXG4gICAgICAuLi50ZW1wbGF0ZURhdGFcbiAgICB9ID0gcmVxLmJvZHk7XG5cbiAgICAvLyBWYWxpZGF0ZSBncmFkZSByYW5nZVxuICAgIGlmICh0ZW1wbGF0ZURhdGEuZ3JhZGVNaW4gJiYgdGVtcGxhdGVEYXRhLmdyYWRlTWF4ICYmIHRlbXBsYXRlRGF0YS5ncmFkZU1pbiA+IHRlbXBsYXRlRGF0YS5ncmFkZU1heCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdNaW5pbXVtIGdyYWRlIGNhbm5vdCBiZSBncmVhdGVyIHRoYW4gbWF4aW11bSBncmFkZScgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgdGVtcGxhdGUgPSBhd2FpdCBwcmlzbWEucGxhblRlbXBsYXRlLmNyZWF0ZSh7XG4gICAgICBkYXRhOiB7XG4gICAgICAgIC4uLnRlbXBsYXRlRGF0YSxcbiAgICAgICAgY3JlYXRlZEJ5VXNlcklkOiB1c2VySWQsXG4gICAgICAgIHRhZ3MsXG4gICAgICAgIGtleXdvcmRzLFxuICAgICAgICBpc1B1YmxpYyxcbiAgICAgICAgY29udGVudCxcbiAgICAgICAgdW5pdFN0cnVjdHVyZTogdW5pdFN0cnVjdHVyZSB8fCBudWxsLFxuICAgICAgICBsZXNzb25TdHJ1Y3R1cmU6IGxlc3NvblN0cnVjdHVyZSB8fCBudWxsLFxuICAgICAgfSxcbiAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgY3JlYXRlZEJ5VXNlcjoge1xuICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIF9jb3VudDoge1xuICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgcmF0aW5nczogdHJ1ZSxcbiAgICAgICAgICAgIHZhcmlhdGlvbnM6IHRydWUsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICByZXMuc3RhdHVzKDIwMSkuanNvbih0ZW1wbGF0ZSk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIF9uZXh0KGVycik7XG4gIH1cbn0pO1xuXG4vLyBVcGRhdGUgYSB0ZW1wbGF0ZVxucm91dGVyLnB1dCgnLzppZCcsIHZhbGlkYXRlKHRlbXBsYXRlVXBkYXRlU2NoZW1hKSwgYXN5bmMgKHJlcTogQXV0aGVudGljYXRlZFJlcXVlc3QsIHJlcywgX25leHQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VySWQgPSBwYXJzZUludChyZXEudXNlcj8udXNlcklkIHx8ICcwJywgMTApO1xuICAgIGlmICghdXNlcklkKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSk7XG4gICAgfVxuXG4gICAgLy8gVmVyaWZ5IG93bmVyc2hpcCAob25seSBjcmVhdG9yIGNhbiBlZGl0KVxuICAgIGNvbnN0IGV4aXN0aW5nID0gYXdhaXQgcHJpc21hLnBsYW5UZW1wbGF0ZS5maW5kRmlyc3Qoe1xuICAgICAgd2hlcmU6IHtcbiAgICAgICAgaWQ6IHJlcS5wYXJhbXMuaWQsXG4gICAgICAgIGNyZWF0ZWRCeVVzZXJJZDogdXNlcklkLFxuICAgICAgICBpc1N5c3RlbTogZmFsc2UsIC8vIFN5c3RlbSB0ZW1wbGF0ZXMgY2Fubm90IGJlIGVkaXRlZFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGlmICghZXhpc3RpbmcpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnVGVtcGxhdGUgbm90IGZvdW5kIG9yIG5vdCBlZGl0YWJsZScgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgeyBncmFkZU1pbiwgZ3JhZGVNYXgsIC4uLnVwZGF0ZURhdGEgfSA9IHJlcS5ib2R5O1xuXG4gICAgLy8gVmFsaWRhdGUgZ3JhZGUgcmFuZ2UgaWYgcHJvdmlkZWRcbiAgICBpZiAoZ3JhZGVNaW4gJiYgZ3JhZGVNYXggJiYgZ3JhZGVNaW4gPiBncmFkZU1heCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdNaW5pbXVtIGdyYWRlIGNhbm5vdCBiZSBncmVhdGVyIHRoYW4gbWF4aW11bSBncmFkZScgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgdGVtcGxhdGUgPSBhd2FpdCBwcmlzbWEucGxhblRlbXBsYXRlLnVwZGF0ZSh7XG4gICAgICB3aGVyZTogeyBpZDogcmVxLnBhcmFtcy5pZCB9LFxuICAgICAgZGF0YToge1xuICAgICAgICAuLi51cGRhdGVEYXRhLFxuICAgICAgICBncmFkZU1pbixcbiAgICAgICAgZ3JhZGVNYXgsXG4gICAgICB9LFxuICAgICAgaW5jbHVkZToge1xuICAgICAgICBjcmVhdGVkQnlVc2VyOiB7XG4gICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgdmFyaWF0aW9uczogdHJ1ZSxcbiAgICAgICAgX2NvdW50OiB7XG4gICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICByYXRpbmdzOiB0cnVlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgcmVzLmpzb24odGVtcGxhdGUpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICBfbmV4dChlcnIpO1xuICB9XG59KTtcblxuLy8gRGVsZXRlIGEgdGVtcGxhdGVcbnJvdXRlci5kZWxldGUoJy86aWQnLCBhc3luYyAocmVxOiBBdXRoZW50aWNhdGVkUmVxdWVzdCwgcmVzLCBfbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHVzZXJJZCA9IHBhcnNlSW50KHJlcS51c2VyPy51c2VySWQgfHwgJzAnLCAxMCk7XG4gICAgaWYgKCF1c2VySWQpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9KTtcbiAgICB9XG5cbiAgICAvLyBWZXJpZnkgb3duZXJzaGlwXG4gICAgY29uc3QgdGVtcGxhdGUgPSBhd2FpdCBwcmlzbWEucGxhblRlbXBsYXRlLmZpbmRGaXJzdCh7XG4gICAgICB3aGVyZToge1xuICAgICAgICBpZDogcmVxLnBhcmFtcy5pZCxcbiAgICAgICAgY3JlYXRlZEJ5VXNlcklkOiB1c2VySWQsXG4gICAgICAgIGlzU3lzdGVtOiBmYWxzZSwgLy8gU3lzdGVtIHRlbXBsYXRlcyBjYW5ub3QgYmUgZGVsZXRlZFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGlmICghdGVtcGxhdGUpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnVGVtcGxhdGUgbm90IGZvdW5kIG9yIG5vdCBkZWxldGFibGUnIH0pO1xuICAgIH1cblxuICAgIGF3YWl0IHByaXNtYS5wbGFuVGVtcGxhdGUuZGVsZXRlKHtcbiAgICAgIHdoZXJlOiB7IGlkOiByZXEucGFyYW1zLmlkIH0sXG4gICAgfSk7XG5cbiAgICByZXMuc3RhdHVzKDIwNCkuZW5kKCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIF9uZXh0KGVycik7XG4gIH1cbn0pO1xuXG4vLyBEdXBsaWNhdGUgYSB0ZW1wbGF0ZVxucm91dGVyLnBvc3QoJy86aWQvZHVwbGljYXRlJywgYXN5bmMgKHJlcTogQXV0aGVudGljYXRlZFJlcXVlc3QsIHJlcywgX25leHQpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1c2VySWQgPSBwYXJzZUludChyZXEudXNlcj8udXNlcklkIHx8ICcwJywgMTApO1xuICAgIGlmICghdXNlcklkKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSk7XG4gICAgfVxuXG4gICAgY29uc3QgeyB0aXRsZSwgaXNQdWJsaWMgPSBmYWxzZSB9ID0gcmVxLmJvZHk7XG5cbiAgICBjb25zdCBvcmlnaW5hbCA9IGF3YWl0IHByaXNtYS5wbGFuVGVtcGxhdGUuZmluZEZpcnN0KHtcbiAgICAgIHdoZXJlOiB7XG4gICAgICAgIGlkOiByZXEucGFyYW1zLmlkLFxuICAgICAgICBPUjogW1xuICAgICAgICAgIHsgaXNTeXN0ZW06IHRydWUgfSxcbiAgICAgICAgICB7IGlzUHVibGljOiB0cnVlIH0sXG4gICAgICAgICAgeyBjcmVhdGVkQnlVc2VySWQ6IHVzZXJJZCB9LFxuICAgICAgICBdLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGlmICghb3JpZ2luYWwpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnVGVtcGxhdGUgbm90IGZvdW5kJyB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBkdXBsaWNhdGVkID0gYXdhaXQgcHJpc21hLnBsYW5UZW1wbGF0ZS5jcmVhdGUoe1xuICAgICAgZGF0YToge1xuICAgICAgICB0aXRsZTogdGl0bGUgfHwgYCR7b3JpZ2luYWwudGl0bGV9IChDb3B5KWAsXG4gICAgICAgIHRpdGxlRnI6IG9yaWdpbmFsLnRpdGxlRnIgPyBgJHtvcmlnaW5hbC50aXRsZUZyfSAoQ29waWUpYCA6IG51bGwsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBvcmlnaW5hbC5kZXNjcmlwdGlvbixcbiAgICAgICAgZGVzY3JpcHRpb25Gcjogb3JpZ2luYWwuZGVzY3JpcHRpb25GcixcbiAgICAgICAgdHlwZTogb3JpZ2luYWwudHlwZSxcbiAgICAgICAgY2F0ZWdvcnk6IG9yaWdpbmFsLmNhdGVnb3J5LFxuICAgICAgICBzdWJqZWN0OiBvcmlnaW5hbC5zdWJqZWN0LFxuICAgICAgICBncmFkZU1pbjogb3JpZ2luYWwuZ3JhZGVNaW4sXG4gICAgICAgIGdyYWRlTWF4OiBvcmlnaW5hbC5ncmFkZU1heCxcbiAgICAgICAgdGFnczogb3JpZ2luYWwudGFncyxcbiAgICAgICAga2V5d29yZHM6IG9yaWdpbmFsLmtleXdvcmRzLFxuICAgICAgICBjcmVhdGVkQnlVc2VySWQ6IHVzZXJJZCxcbiAgICAgICAgaXNTeXN0ZW06IGZhbHNlLFxuICAgICAgICBpc1B1YmxpYyxcbiAgICAgICAgY29udGVudDogb3JpZ2luYWwuY29udGVudCxcbiAgICAgICAgZXN0aW1hdGVkV2Vla3M6IG9yaWdpbmFsLmVzdGltYXRlZFdlZWtzLFxuICAgICAgICB1bml0U3RydWN0dXJlOiBvcmlnaW5hbC51bml0U3RydWN0dXJlLFxuICAgICAgICBlc3RpbWF0ZWRNaW51dGVzOiBvcmlnaW5hbC5lc3RpbWF0ZWRNaW51dGVzLFxuICAgICAgICBsZXNzb25TdHJ1Y3R1cmU6IG9yaWdpbmFsLmxlc3NvblN0cnVjdHVyZSxcbiAgICAgIH0sXG4gICAgICBpbmNsdWRlOiB7XG4gICAgICAgIGNyZWF0ZWRCeVVzZXI6IHtcbiAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBfY291bnQ6IHtcbiAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgIHJhdGluZ3M6IHRydWUsXG4gICAgICAgICAgICB2YXJpYXRpb25zOiB0cnVlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgcmVzLnN0YXR1cygyMDEpLmpzb24oZHVwbGljYXRlZCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIF9uZXh0KGVycik7XG4gIH1cbn0pO1xuXG4vLyBBcHBseSB0ZW1wbGF0ZSB0byBjcmVhdGUgYSBuZXcgcGxhblxucm91dGVyLnBvc3QoJy86aWQvYXBwbHknLCBhc3luYyAocmVxOiBBdXRoZW50aWNhdGVkUmVxdWVzdCwgcmVzLCBfbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHVzZXJJZCA9IHBhcnNlSW50KHJlcS51c2VyPy51c2VySWQgfHwgJzAnLCAxMCk7XG4gICAgaWYgKCF1c2VySWQpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9KTtcbiAgICB9XG5cbiAgICBjb25zdCB7IGN1c3RvbWl6YXRpb25zID0ge30gfSA9IHJlcS5ib2R5O1xuXG4gICAgY29uc3QgdGVtcGxhdGUgPSBhd2FpdCBwcmlzbWEucGxhblRlbXBsYXRlLmZpbmRGaXJzdCh7XG4gICAgICB3aGVyZToge1xuICAgICAgICBpZDogcmVxLnBhcmFtcy5pZCxcbiAgICAgICAgT1I6IFtcbiAgICAgICAgICB7IGlzU3lzdGVtOiB0cnVlIH0sXG4gICAgICAgICAgeyBpc1B1YmxpYzogdHJ1ZSB9LFxuICAgICAgICAgIHsgY3JlYXRlZEJ5VXNlcklkOiB1c2VySWQgfSxcbiAgICAgICAgXSxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBpZiAoIXRlbXBsYXRlKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ1RlbXBsYXRlIG5vdCBmb3VuZCcgfSk7XG4gICAgfVxuXG4gICAgLy8gVXBkYXRlIHVzYWdlIHRyYWNraW5nXG4gICAgYXdhaXQgcHJpc21hLnBsYW5UZW1wbGF0ZS51cGRhdGUoe1xuICAgICAgd2hlcmU6IHsgaWQ6IHRlbXBsYXRlLmlkIH0sXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHVzYWdlQ291bnQ6IHsgaW5jcmVtZW50OiAxIH0sXG4gICAgICAgIGxhc3RVc2VkQXQ6IG5ldyBEYXRlKCksXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgLy8gTWVyZ2UgdGVtcGxhdGUgY29udGVudCB3aXRoIHVzZXIgY3VzdG9taXphdGlvbnNcbiAgICBjb25zdCBhcHBsaWVkQ29udGVudCA9IHtcbiAgICAgIC4uLih0ZW1wbGF0ZS5jb250ZW50IGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KSxcbiAgICAgIC4uLihjdXN0b21pemF0aW9ucyB8fCB7fSksXG4gICAgfTtcblxuICAgIHJlcy5qc29uKHtcbiAgICAgIHRlbXBsYXRlOiB7XG4gICAgICAgIGlkOiB0ZW1wbGF0ZS5pZCxcbiAgICAgICAgdGl0bGU6IHRlbXBsYXRlLnRpdGxlLFxuICAgICAgICB0eXBlOiB0ZW1wbGF0ZS50eXBlLFxuICAgICAgICBjb250ZW50OiBhcHBsaWVkQ29udGVudCxcbiAgICAgICAgdW5pdFN0cnVjdHVyZTogdGVtcGxhdGUudW5pdFN0cnVjdHVyZSxcbiAgICAgICAgbGVzc29uU3RydWN0dXJlOiB0ZW1wbGF0ZS5sZXNzb25TdHJ1Y3R1cmUsXG4gICAgICAgIGVzdGltYXRlZFdlZWtzOiB0ZW1wbGF0ZS5lc3RpbWF0ZWRXZWVrcyxcbiAgICAgICAgZXN0aW1hdGVkTWludXRlczogdGVtcGxhdGUuZXN0aW1hdGVkTWludXRlcyxcbiAgICAgIH0sXG4gICAgICBhcHBsaWVkQ29udGVudCxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgX25leHQoZXJyKTtcbiAgfVxufSk7XG5cbi8vIFJhdGUgYSB0ZW1wbGF0ZVxucm91dGVyLnBvc3QoJy86aWQvcmF0ZScsIGFzeW5jIChyZXE6IEF1dGhlbnRpY2F0ZWRSZXF1ZXN0LCByZXMsIF9uZXh0KSA9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgdXNlcklkID0gcGFyc2VJbnQocmVxLnVzZXI/LnVzZXJJZCB8fCAnMCcsIDEwKTtcbiAgICBpZiAoIXVzZXJJZCkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdVbmF1dGhvcml6ZWQnIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHsgcmF0aW5nLCBjb21tZW50IH0gPSByZXEuYm9keTtcblxuICAgIGlmICghcmF0aW5nIHx8IHJhdGluZyA8IDEgfHwgcmF0aW5nID4gNSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdSYXRpbmcgbXVzdCBiZSBiZXR3ZWVuIDEgYW5kIDUnIH0pO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHRlbXBsYXRlIGV4aXN0cyBhbmQgaXMgYWNjZXNzaWJsZVxuICAgIGNvbnN0IHRlbXBsYXRlID0gYXdhaXQgcHJpc21hLnBsYW5UZW1wbGF0ZS5maW5kRmlyc3Qoe1xuICAgICAgd2hlcmU6IHtcbiAgICAgICAgaWQ6IHJlcS5wYXJhbXMuaWQsXG4gICAgICAgIE9SOiBbXG4gICAgICAgICAgeyBpc1N5c3RlbTogdHJ1ZSB9LFxuICAgICAgICAgIHsgaXNQdWJsaWM6IHRydWUgfSxcbiAgICAgICAgICB7IGNyZWF0ZWRCeVVzZXJJZDogdXNlcklkIH0sXG4gICAgICAgIF0sXG4gICAgICB9LFxuICAgIH0pO1xuXG4gICAgaWYgKCF0ZW1wbGF0ZSkge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdUZW1wbGF0ZSBub3QgZm91bmQnIH0pO1xuICAgIH1cblxuICAgIC8vIFVwc2VydCByYXRpbmdcbiAgICBjb25zdCB0ZW1wbGF0ZVJhdGluZyA9IGF3YWl0IHByaXNtYS50ZW1wbGF0ZVJhdGluZy51cHNlcnQoe1xuICAgICAgd2hlcmU6IHtcbiAgICAgICAgdGVtcGxhdGVJZF91c2VySWQ6IHtcbiAgICAgICAgICB0ZW1wbGF0ZUlkOiByZXEucGFyYW1zLmlkLFxuICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICB1cGRhdGU6IHtcbiAgICAgICAgcmF0aW5nLFxuICAgICAgICBjb21tZW50LFxuICAgICAgfSxcbiAgICAgIGNyZWF0ZToge1xuICAgICAgICB0ZW1wbGF0ZUlkOiByZXEucGFyYW1zLmlkLFxuICAgICAgICB1c2VySWQsXG4gICAgICAgIHJhdGluZyxcbiAgICAgICAgY29tbWVudCxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICAvLyBSZWNhbGN1bGF0ZSBhdmVyYWdlIHJhdGluZ1xuICAgIGNvbnN0IHJhdGluZ3MgPSBhd2FpdCBwcmlzbWEudGVtcGxhdGVSYXRpbmcuZmluZE1hbnkoe1xuICAgICAgd2hlcmU6IHsgdGVtcGxhdGVJZDogcmVxLnBhcmFtcy5pZCB9LFxuICAgICAgc2VsZWN0OiB7IHJhdGluZzogdHJ1ZSB9LFxuICAgIH0pO1xuXG4gICAgY29uc3QgYXZlcmFnZVJhdGluZyA9IHJhdGluZ3MubGVuZ3RoID4gMCBcbiAgICAgID8gcmF0aW5ncy5yZWR1Y2UoKHN1bSwgcikgPT4gc3VtICsgci5yYXRpbmcsIDApIC8gcmF0aW5ncy5sZW5ndGggXG4gICAgICA6IDA7XG5cbiAgICBhd2FpdCBwcmlzbWEucGxhblRlbXBsYXRlLnVwZGF0ZSh7XG4gICAgICB3aGVyZTogeyBpZDogcmVxLnBhcmFtcy5pZCB9LFxuICAgICAgZGF0YTogeyBhdmVyYWdlUmF0aW5nIH0sXG4gICAgfSk7XG5cbiAgICByZXMuanNvbih0ZW1wbGF0ZVJhdGluZyk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIF9uZXh0KGVycik7XG4gIH1cbn0pO1xuXG4vLyBHZXQgY2F0ZWdvcmllcyBhbmQgc3ViamVjdHMgZm9yIGZpbHRlcmluZ1xucm91dGVyLmdldCgnL21ldGFkYXRhL29wdGlvbnMnLCBhc3luYyAocmVxOiBBdXRoZW50aWNhdGVkUmVxdWVzdCwgcmVzLCBfbmV4dCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHVzZXJJZCA9IHBhcnNlSW50KHJlcS51c2VyPy51c2VySWQgfHwgJzAnLCAxMCk7XG4gICAgaWYgKCF1c2VySWQpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9KTtcbiAgICB9XG5cbiAgICBjb25zdCBbc3ViamVjdHMsIGdyYWRlcywgY2F0ZWdvcmllcywgdGFnc10gPSBhd2FpdCBQcm9taXNlLmFsbChbXG4gICAgICBwcmlzbWEucGxhblRlbXBsYXRlLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBPUjogW1xuICAgICAgICAgICAgeyBpc1N5c3RlbTogdHJ1ZSB9LFxuICAgICAgICAgICAgeyBpc1B1YmxpYzogdHJ1ZSB9LFxuICAgICAgICAgICAgeyBjcmVhdGVkQnlVc2VySWQ6IHVzZXJJZCB9LFxuICAgICAgICAgIF0sXG4gICAgICAgICAgc3ViamVjdDogeyBub3Q6IG51bGwgfSxcbiAgICAgICAgfSxcbiAgICAgICAgc2VsZWN0OiB7IHN1YmplY3Q6IHRydWUgfSxcbiAgICAgICAgZGlzdGluY3Q6IFsnc3ViamVjdCddLFxuICAgICAgfSksXG4gICAgICBwcmlzbWEucGxhblRlbXBsYXRlLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBBTkQ6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgT1I6IFtcbiAgICAgICAgICAgICAgICB7IGlzU3lzdGVtOiB0cnVlIH0sXG4gICAgICAgICAgICAgICAgeyBpc1B1YmxpYzogdHJ1ZSB9LFxuICAgICAgICAgICAgICAgIHsgY3JlYXRlZEJ5VXNlcklkOiB1c2VySWQgfSxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIE9SOiBbXG4gICAgICAgICAgICAgICAgeyBncmFkZU1pbjogeyBub3Q6IG51bGwgfSB9LFxuICAgICAgICAgICAgICAgIHsgZ3JhZGVNYXg6IHsgbm90OiBudWxsIH0gfSxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAgc2VsZWN0OiB7IGdyYWRlTWluOiB0cnVlLCBncmFkZU1heDogdHJ1ZSB9LFxuICAgICAgfSksXG4gICAgICBwcmlzbWEucGxhblRlbXBsYXRlLmZpbmRNYW55KHtcbiAgICAgICAgc2VsZWN0OiB7IGNhdGVnb3J5OiB0cnVlIH0sXG4gICAgICAgIGRpc3RpbmN0OiBbJ2NhdGVnb3J5J10sXG4gICAgICB9KSxcbiAgICAgIHByaXNtYS5wbGFuVGVtcGxhdGUuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIE9SOiBbXG4gICAgICAgICAgICB7IGlzU3lzdGVtOiB0cnVlIH0sXG4gICAgICAgICAgICB7IGlzUHVibGljOiB0cnVlIH0sXG4gICAgICAgICAgICB7IGNyZWF0ZWRCeVVzZXJJZDogdXNlcklkIH0sXG4gICAgICAgICAgXSxcbiAgICAgICAgfSxcbiAgICAgICAgc2VsZWN0OiB7IHRhZ3M6IHRydWUgfSxcbiAgICAgIH0pLFxuICAgIF0pO1xuXG4gICAgY29uc3QgdW5pcXVlU3ViamVjdHMgPSBzdWJqZWN0c1xuICAgICAgLm1hcCh0ID0+IHQuc3ViamVjdClcbiAgICAgIC5maWx0ZXIocyA9PiBzICE9PSBudWxsKVxuICAgICAgLnNvcnQoKTtcblxuICAgIGNvbnN0IGdyYWRlUmFuZ2UgPSBncmFkZXMucmVkdWNlKFxuICAgICAgKHJhbmdlLCB0ZW1wbGF0ZSkgPT4ge1xuICAgICAgICBpZiAodGVtcGxhdGUuZ3JhZGVNaW4pIHJhbmdlLm1pbiA9IE1hdGgubWluKHJhbmdlLm1pbiwgdGVtcGxhdGUuZ3JhZGVNaW4pO1xuICAgICAgICBpZiAodGVtcGxhdGUuZ3JhZGVNYXgpIHJhbmdlLm1heCA9IE1hdGgubWF4KHJhbmdlLm1heCwgdGVtcGxhdGUuZ3JhZGVNYXgpO1xuICAgICAgICByZXR1cm4gcmFuZ2U7XG4gICAgICB9LFxuICAgICAgeyBtaW46IDEyLCBtYXg6IDEgfVxuICAgICk7XG5cbiAgICBjb25zdCBhbGxUYWdzID0gdGFnc1xuICAgICAgLmZsYXRNYXAodCA9PiBBcnJheS5pc0FycmF5KHQudGFncykgPyB0LnRhZ3MgOiBbXSlcbiAgICAgIC5maWx0ZXIoKHRhZywgaW5kZXgsIGFycmF5KSA9PiBhcnJheS5pbmRleE9mKHRhZykgPT09IGluZGV4KVxuICAgICAgLnNvcnQoKTtcblxuICAgIHJlcy5qc29uKHtcbiAgICAgIHN1YmplY3RzOiB1bmlxdWVTdWJqZWN0cyxcbiAgICAgIGdyYWRlczogQXJyYXkuZnJvbSh7IGxlbmd0aDogZ3JhZGVSYW5nZS5tYXggLSBncmFkZVJhbmdlLm1pbiArIDEgfSwgKF8sIGkpID0+IGdyYWRlUmFuZ2UubWluICsgaSksXG4gICAgICBjYXRlZ29yaWVzOiBjYXRlZ29yaWVzLm1hcChjID0+IGMuY2F0ZWdvcnkpLFxuICAgICAgdGFnczogYWxsVGFncyxcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgX25leHQoZXJyKTtcbiAgfVxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IHJvdXRlcjsiXSwidmVyc2lvbiI6M30=