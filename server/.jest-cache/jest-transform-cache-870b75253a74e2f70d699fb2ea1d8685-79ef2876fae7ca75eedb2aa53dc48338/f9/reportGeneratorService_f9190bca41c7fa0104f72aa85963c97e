625f5b3cc28a410eb7b83f8af9e9e561
import { prisma } from '../prisma';
import { generateContent } from './llmService';
import logger from '../logger';
export class ReportGeneratorService {
    async generateReport(request) {
        try {
            // Fetch student data
            const student = await prisma.student.findUnique({
                where: { id: request.studentId },
                include: {
                    user: true,
                    artifacts: {
                        where: {
                            createdAt: {
                                gte: request.startDate,
                                lte: request.endDate,
                            },
                        },
                    },
                    reflections: {
                        where: {
                            createdAt: {
                                gte: request.startDate,
                                lte: request.endDate,
                            },
                        },
                    },
                    goals: {
                        where: {
                            OR: [
                                { status: 'active' },
                                { status: 'completed' },
                            ],
                        },
                    },
                },
            });
            if (!student) {
                throw new Error('Student not found');
            }
            // Generate report based on type
            let report;
            switch (request.reportType) {
                case 'progress':
                    report = await this.generateProgressReport(student, request);
                    break;
                case 'narrative':
                    report = await this.generateNarrativeReport(student, request);
                    break;
                case 'term_summary':
                    report = await this.generateTermSummary(student, request);
                    break;
                case 'report_card':
                    report = await this.generateReportCard(student, request);
                    break;
                default:
                    throw new Error('Invalid report type');
            }
            return report;
        }
        catch (error) {
            logger.error('Failed to generate report:', error);
            throw error;
        }
    }
    async generateProgressReport(student, request) {
        const sections = [];
        // Assessment functionality removed - focus on artifacts and reflections
        if (student.artifacts.length > 0 || student.reflections.length > 0) {
            sections.push({
                title: request.language === 'fr' ? 'Progrès académique' : 'Academic Progress',
                content: await this.generateProgressFromArtifacts(student.artifacts, student.reflections, request.language),
                data: { artifacts: student.artifacts, reflections: student.reflections },
            });
        }
        // Goals Section
        if (request.includeGoals && student.goals.length > 0) {
            sections.push({
                title: request.language === 'fr' ? 'Objectifs' : 'Goals',
                content: await this.generateGoalsNarrative(student.goals, request.language),
                data: { goals: student.goals },
            });
        }
        // Overall Comments
        const overallComments = await this.generateOverallComments(student, sections, request.language);
        // Next Steps
        const nextSteps = await this.generateNextSteps(student, sections, request.language);
        return {
            studentName: `${student.firstName} ${student.lastName}`,
            period: `${request.startDate.toLocaleDateString()} - ${request.endDate.toLocaleDateString()}`,
            sections,
            overallComments,
            nextSteps,
        };
    }
    async generateNarrativeReport(student, request) {
        // Gather comprehensive data
        const learningJourney = this.compileLearningJourney(student);
        // Generate narrative using LLM
        const prompt = request.language === 'fr'
            ? `Générez un rapport narratif détaillé pour ${student.firstName} ${student.lastName}, couvrant la période du ${request.startDate.toLocaleDateString()} au ${request.endDate.toLocaleDateString()}. Incluez les réalisations, les défis et les domaines de croissance.`
            : `Generate a detailed narrative report for ${student.firstName} ${student.lastName}, covering the period from ${request.startDate.toLocaleDateString()} to ${request.endDate.toLocaleDateString()}. Include achievements, challenges, and areas of growth.`;
        const narrative = await generateContent(prompt, JSON.stringify(learningJourney));
        return {
            studentName: `${student.firstName} ${student.lastName}`,
            period: `${request.startDate.toLocaleDateString()} - ${request.endDate.toLocaleDateString()}`,
            sections: [{
                    title: request.language === 'fr' ? 'Rapport narratif' : 'Narrative Report',
                    content: narrative,
                }],
            overallComments: '',
            nextSteps: [],
        };
    }
    async generateTermSummary(student, request) {
        const sections = [];
        // Get subject-specific progress
        const subjectProgress = await this.getSubjectProgress(student);
        for (const subject of subjectProgress) {
            sections.push({
                title: subject.name,
                content: await this.generateSubjectSummary(subject, request.language),
                data: subject,
            });
        }
        // Overall term performance
        const overallComments = await this.generateTermOverview(student, subjectProgress, request.language);
        // Recommendations for next term
        const nextSteps = await this.generateTermRecommendations(student, subjectProgress, request.language);
        return {
            studentName: `${student.firstName} ${student.lastName}`,
            period: request.language === 'fr' ? 'Résumé du trimestre' : 'Term Summary',
            sections,
            overallComments,
            nextSteps,
        };
    }
    async generateReportCard(student, request) {
        const sections = [];
        // Get formal grades/assessments by subject
        const reportCardData = await this.compileReportCardData(student);
        for (const subject of reportCardData) {
            // Generate teacher comments for each subject
            const comments = await this.generateSubjectComments(subject, student, request.language);
            sections.push({
                title: subject.name,
                content: comments,
                data: {
                    grade: subject.grade,
                    outcomes: subject.outcomes,
                },
            });
        }
        // General comments
        const overallComments = await this.generateReportCardComments(student, reportCardData, request.language);
        return {
            studentName: `${student.firstName} ${student.lastName}`,
            period: request.language === 'fr' ? 'Bulletin scolaire' : 'Report Card',
            sections,
            overallComments,
            nextSteps: [],
        };
    }
    // Helper methods
    async generateProgressFromArtifacts(artifacts, reflections, language) {
        const context = {
            artifactCount: artifacts.length,
            reflectionCount: reflections.length,
            recentArtifacts: artifacts.slice(0, 3).map(a => ({ title: a.title, description: a.description })),
            recentReflections: reflections.slice(0, 3).map(r => ({ content: r.content }))
        };
        const prompt = language === 'fr'
            ? `Décrivez le progrès académique basé sur ${artifacts.length} artefacts et ${reflections.length} réflexions.`
            : `Describe academic progress based on ${artifacts.length} artifacts and ${reflections.length} reflections.`;
        return generateContent(prompt, JSON.stringify(context));
    }
    async generateGoalsNarrative(goals, language) {
        const activeGoals = goals.filter(g => g.status === 'active');
        const completedGoals = goals.filter(g => g.status === 'completed');
        const context = {
            active: activeGoals.map(g => ({ text: g.text })),
            completed: completedGoals.map(g => ({ text: g.text })),
        };
        const prompt = language === 'fr'
            ? `Décrivez le progrès vers les objectifs de l'élève: ${JSON.stringify(context)}`
            : `Describe the student's progress toward their goals: ${JSON.stringify(context)}`;
        return generateContent(prompt);
    }
    async generateOverallComments(student, sections, language) {
        const context = {
            studentName: `${student.firstName} ${student.lastName}`,
            sectionsCount: sections.length,
            sectionTitles: sections.map(s => s.title),
        };
        const prompt = language === 'fr'
            ? `Générez des commentaires généraux positifs et encourageants pour ${context.studentName} basés sur leur rapport de progrès.`
            : `Generate positive and encouraging overall comments for ${context.studentName} based on their progress report.`;
        return generateContent(prompt, JSON.stringify(context));
    }
    async generateNextSteps(student, sections, language) {
        const prompt = language === 'fr'
            ? `Suggérez 3-5 prochaines étapes spécifiques pour ${student.firstName} pour continuer leur progrès.`
            : `Suggest 3-5 specific next steps for ${student.firstName} to continue their progress.`;
        const suggestions = await generateContent(prompt, JSON.stringify(sections.map(s => ({ title: s.title, summary: s.content.substring(0, 100) }))));
        // Parse the suggestions into an array
        return suggestions.split('\n').filter(s => s.trim().length > 0).slice(0, 5);
    }
    compileLearningJourney(student) {
        return {
            artifacts: student.artifacts.map((a) => ({
                title: a.title,
                description: a.description,
                createdAt: a.createdAt,
            })),
            reflections: student.reflections.map((r) => ({
                content: r.content,
                createdAt: r.createdAt,
            })),
            goals: student.goals,
        };
    }
    async getSubjectProgress(student) {
        // Simplified subject progress without deep relations
        const subjects = await prisma.subject.findMany({
            where: { userId: student.user.id },
        });
        return subjects.map(subject => ({
            id: subject.id,
            name: subject.name,
            outcomes: [],
            averageScore: 0, // Assessment functionality removed
        }));
    }
    async generateSubjectSummary(subject, language) {
        const prompt = language === 'fr'
            ? `Résumez la performance de l'élève en ${subject.name} avec une note moyenne de ${subject.averageScore.toFixed(1)}% et couvrant ${subject.outcomes.length} résultats d'apprentissage.`
            : `Summarize the student's performance in ${subject.name} with an average score of ${subject.averageScore.toFixed(1)}% and covering ${subject.outcomes.length} learning outcomes.`;
        return generateContent(prompt);
    }
    async generateTermOverview(student, subjectProgress, language) {
        const overallAverage = subjectProgress.reduce((sum, s) => sum + s.averageScore, 0) / subjectProgress.length;
        const prompt = language === 'fr'
            ? `Générez un aperçu du trimestre pour ${student.firstName} avec une moyenne générale de ${overallAverage.toFixed(1)}% à travers ${subjectProgress.length} matières.`
            : `Generate a term overview for ${student.firstName} with an overall average of ${overallAverage.toFixed(1)}% across ${subjectProgress.length} subjects.`;
        return generateContent(prompt, JSON.stringify(subjectProgress.map(s => ({ name: s.name, average: s.averageScore }))));
    }
    async generateTermRecommendations(student, subjectProgress, language) {
        const weakSubjects = subjectProgress.filter(s => s.averageScore < 70);
        const strongSubjects = subjectProgress.filter(s => s.averageScore >= 85);
        const prompt = language === 'fr'
            ? `Suggérez 3-5 recommandations pour le prochain trimestre basées sur les forces (${strongSubjects.map(s => s.name).join(', ')}) et les domaines à améliorer (${weakSubjects.map(s => s.name).join(', ')}).`
            : `Suggest 3-5 recommendations for the next term based on strengths (${strongSubjects.map(s => s.name).join(', ')}) and areas for improvement (${weakSubjects.map(s => s.name).join(', ')}).`;
        const recommendations = await generateContent(prompt);
        return recommendations.split('\n').filter(r => r.trim().length > 0).slice(0, 5);
    }
    async compileReportCardData(student) {
        const subjects = await prisma.subject.findMany({
            where: { userId: student.user.id },
        });
        return subjects.map(subject => ({
            id: subject.id,
            name: subject.name,
            grade: 'N/A', // Assessment functionality removed
            outcomes: [],
        }));
    }
    scoreToGrade(score) {
        if (score >= 90)
            return 'A';
        if (score >= 80)
            return 'B';
        if (score >= 70)
            return 'C';
        if (score >= 60)
            return 'D';
        return 'F';
    }
    async generateSubjectComments(subject, student, language) {
        const prompt = language === 'fr'
            ? `Générez des commentaires d'enseignant pour ${student.firstName} en ${subject.name} avec une note de ${subject.grade}. Soyez spécifique et encourageant.`
            : `Generate teacher comments for ${student.firstName} in ${subject.name} with a grade of ${subject.grade}. Be specific and encouraging.`;
        return generateContent(prompt, JSON.stringify({
            outcomes: subject.outcomes.length,
        }));
    }
    async generateReportCardComments(student, reportCardData, language) {
        const overallGrade = reportCardData.reduce((sum, s) => {
            const gradeValue = { A: 4, B: 3, C: 2, D: 1, F: 0 }[s.grade] || 0;
            return sum + gradeValue;
        }, 0) / reportCardData.length;
        const prompt = language === 'fr'
            ? `Générez des commentaires généraux de bulletin pour ${student.firstName} ${student.lastName} avec une performance globale de ${overallGrade.toFixed(1)}/4.0.`
            : `Generate overall report card comments for ${student.firstName} ${student.lastName} with an overall performance of ${overallGrade.toFixed(1)}/4.0.`;
        return generateContent(prompt, JSON.stringify(reportCardData.map(s => ({ subject: s.name, grade: s.grade }))));
    }
    // Curriculum and Planning Report Methods
    async generateCurriculumCoverageReport(userId) {
        try {
            // Get all curriculum expectations - we'll filter by covered/uncovered later
            const expectations = await prisma.curriculumExpectation.findMany();
            // Get all plans with expectations
            const longRangePlans = await prisma.longRangePlan.findMany({
                where: { userId },
                include: { expectations: true },
            });
            const unitPlans = await prisma.unitPlan.findMany({
                where: { userId },
                include: { expectations: true },
            });
            const lessonPlans = await prisma.eTFOLessonPlan.findMany({
                where: { userId },
                include: { expectations: true },
            });
            // Collect all covered expectation IDs
            const coveredExpectationIds = new Set();
            longRangePlans.forEach(plan => {
                plan.expectations.forEach(exp => coveredExpectationIds.add(exp.expectationId));
            });
            unitPlans.forEach(plan => {
                plan.expectations.forEach(exp => coveredExpectationIds.add(exp.expectationId));
            });
            lessonPlans.forEach(plan => {
                plan.expectations.forEach(exp => coveredExpectationIds.add(exp.expectationId));
            });
            // Calculate coverage
            const totalExpectations = expectations.length;
            const coveredExpectations = coveredExpectationIds.size;
            const coveragePercentage = totalExpectations > 0
                ? Math.round((coveredExpectations / totalExpectations) * 100)
                : 0;
            // Find uncovered expectations
            const uncoveredExpectations = expectations
                .filter(exp => !coveredExpectationIds.has(exp.id))
                .map(exp => ({
                id: exp.id,
                code: exp.code,
                description: exp.description,
                strand: exp.strand,
            }));
            // Calculate coverage by strand
            const coverageByStrand = {};
            expectations.forEach(exp => {
                if (!coverageByStrand[exp.strand]) {
                    coverageByStrand[exp.strand] = { total: 0, covered: 0, percentage: 0 };
                }
                coverageByStrand[exp.strand].total++;
                if (coveredExpectationIds.has(exp.id)) {
                    coverageByStrand[exp.strand].covered++;
                }
            });
            // Calculate percentages for each strand
            Object.keys(coverageByStrand).forEach(strand => {
                const strandData = coverageByStrand[strand];
                strandData.percentage = strandData.total > 0
                    ? Math.round((strandData.covered / strandData.total) * 100)
                    : 0;
            });
            return {
                totalExpectations,
                coveredExpectations,
                coveragePercentage,
                uncoveredExpectations,
                coverageByStrand,
            };
        }
        catch (error) {
            logger.error('Failed to generate curriculum coverage report:', error);
            throw error;
        }
    }
    async generatePlanningProgressReport(userId) {
        try {
            // Get all planning data for the user
            const longRangePlans = await prisma.longRangePlan.findMany({
                where: { userId },
            });
            const unitPlans = await prisma.unitPlan.findMany({
                where: { userId },
            });
            const lessonPlans = await prisma.eTFOLessonPlan.findMany({
                where: { userId },
            });
            const daybookEntries = await prisma.daybookEntry.findMany({
                where: { userId },
            });
            // Calculate completion rates
            const calculateCompletionRate = (plans, isComplete) => {
                const total = plans.length;
                const completed = plans.filter(isComplete).length;
                const completionRate = total > 0 ? Math.round((completed / total) * 100) : 0;
                return { total, completed, completionRate };
            };
            return {
                longRangePlans: calculateCompletionRate(longRangePlans, plan => plan.goals !== null && plan.goals !== ''),
                unitPlans: calculateCompletionRate(unitPlans, plan => plan.bigIdeas !== null && plan.bigIdeas !== ''),
                lessonPlans: calculateCompletionRate(lessonPlans, plan => plan.learningGoals !== null && plan.learningGoals !== ''),
                daybookEntries: calculateCompletionRate(daybookEntries, entry => entry.whatWorked !== null && entry.whatWorked !== ''),
            };
        }
        catch (error) {
            logger.error('Failed to generate planning progress report:', error);
            throw error;
        }
    }
    async generateLessonPlanReport(lessonId) {
        try {
            const lesson = await prisma.eTFOLessonPlan.findUnique({
                where: { id: lessonId },
                include: {
                    unitPlan: {
                        include: {
                            longRangePlan: true,
                        },
                    },
                    expectations: {
                        include: {
                            expectation: true,
                        },
                    },
                    daybookEntry: true,
                    resources: true,
                },
            });
            if (!lesson) {
                throw new Error('Lesson plan not found');
            }
            return {
                lesson: {
                    id: lesson.id,
                    title: lesson.title,
                    date: lesson.date,
                    duration: lesson.duration,
                    mindsOn: lesson.mindsOn || undefined,
                    action: lesson.action || undefined,
                    consolidation: lesson.consolidation || undefined,
                    learningGoals: lesson.learningGoals || undefined,
                    materials: Array.isArray(lesson.materials) ? lesson.materials : undefined,
                    isSubFriendly: lesson.isSubFriendly,
                },
                hierarchy: {
                    longRangePlan: {
                        id: lesson.unitPlan.longRangePlan.id,
                        title: lesson.unitPlan.longRangePlan.title,
                        subject: lesson.unitPlan.longRangePlan.subject || undefined,
                        grade: lesson.unitPlan.longRangePlan.grade || undefined,
                    },
                    unitPlan: {
                        id: lesson.unitPlan.id,
                        title: lesson.unitPlan.title,
                    },
                },
                curriculumAlignment: lesson.expectations.map(exp => ({
                    id: exp.expectation.id,
                    code: exp.expectation.code,
                    description: exp.expectation.description,
                    strand: exp.expectation.strand,
                })),
                reflection: lesson.daybookEntry ? {
                    whatWorked: lesson.daybookEntry.whatWorked || undefined,
                    overallRating: lesson.daybookEntry.overallRating || undefined,
                    wouldReuseLesson: lesson.daybookEntry.wouldReuseLesson || undefined,
                } : undefined,
                resources: lesson.resources.map(resource => ({
                    id: resource.id,
                    title: resource.title,
                    type: resource.type,
                    url: resource.url || undefined,
                })),
            };
        }
        catch (error) {
            logger.error('Failed to generate lesson plan report:', error);
            throw error;
        }
    }
    async generateSubstitutePlanReport(lessonId) {
        try {
            const lesson = await prisma.eTFOLessonPlan.findUnique({
                where: { id: lessonId },
                include: {
                    unitPlan: {
                        include: {
                            longRangePlan: true,
                        },
                    },
                    resources: true,
                },
            });
            if (!lesson) {
                throw new Error('Lesson plan not found');
            }
            if (!lesson.isSubFriendly) {
                throw new Error('Lesson plan is not marked as substitute-friendly');
            }
            return {
                title: lesson.title,
                basicInfo: {
                    subject: lesson.unitPlan.longRangePlan.subject || 'Not specified',
                    grade: lesson.unitPlan.longRangePlan.grade || 0,
                    duration: lesson.duration,
                    date: lesson.date,
                },
                materials: Array.isArray(lesson.materials) ? lesson.materials : [],
                activities: {
                    opening: lesson.mindsOn || '',
                    main: lesson.action || '',
                    closing: lesson.consolidation || '',
                },
                specialNotes: lesson.subNotes || undefined,
                resources: lesson.resources.map(resource => ({
                    id: resource.id,
                    title: resource.title,
                    type: resource.type,
                    content: resource.content || undefined,
                })),
            };
        }
        catch (error) {
            logger.error('Failed to generate substitute plan report:', error);
            throw error;
        }
    }
    async generateUnitOverviewReport(unitId) {
        try {
            const unit = await prisma.unitPlan.findUnique({
                where: { id: unitId },
                include: {
                    longRangePlan: true,
                    expectations: {
                        include: {
                            expectation: true,
                        },
                    },
                    lessonPlans: true,
                    resources: true,
                },
            });
            if (!unit) {
                throw new Error('Unit plan not found');
            }
            const totalDuration = unit.lessonPlans.reduce((sum, lesson) => sum + lesson.duration, 0);
            return {
                unit: {
                    id: unit.id,
                    title: unit.title,
                    description: unit.description || undefined,
                    bigIdeas: unit.bigIdeas || undefined,
                    startDate: unit.startDate,
                    endDate: unit.endDate,
                    estimatedHours: unit.estimatedHours,
                },
                hierarchy: {
                    longRangePlan: {
                        id: unit.longRangePlan.id,
                        title: unit.longRangePlan.title,
                        subject: unit.longRangePlan.subject || undefined,
                        grade: unit.longRangePlan.grade || undefined,
                    },
                },
                curriculumAlignment: unit.expectations.map(exp => ({
                    id: exp.expectation.id,
                    code: exp.expectation.code,
                    description: exp.expectation.description,
                    strand: exp.expectation.strand,
                })),
                lessonSummary: {
                    totalLessons: unit.lessonPlans.length,
                    totalDuration,
                    lessons: unit.lessonPlans.map(lesson => ({
                        id: lesson.id,
                        title: lesson.title,
                        date: lesson.date,
                        duration: lesson.duration,
                    })),
                },
                resources: unit.resources.map(resource => ({
                    id: resource.id,
                    title: resource.title,
                    type: resource.type,
                })),
            };
        }
        catch (error) {
            logger.error('Failed to generate unit overview report:', error);
            throw error;
        }
    }
}
export const reportGeneratorService = new ReportGeneratorService();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL21pY2hhZWxtY2lzYWFjL0dpdEh1Yi90ZWFjaGluZy1lbmdpbmUyLjAvc2VydmVyL3NyYy9zZXJ2aWNlcy9yZXBvcnRHZW5lcmF0b3JTZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDbkMsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUMvQyxPQUFPLE1BQU0sTUFBTSxXQUFXLENBQUM7QUFnTy9CLE1BQU0sT0FBTyxzQkFBc0I7SUFDakMsS0FBSyxDQUFDLGNBQWMsQ0FBQyxPQUFnQztRQUNuRCxJQUFJLENBQUM7WUFDSCxxQkFBcUI7WUFDckIsTUFBTSxPQUFPLEdBQUcsTUFBTSxNQUFNLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQztnQkFDOUMsS0FBSyxFQUFFLEVBQUUsRUFBRSxFQUFFLE9BQU8sQ0FBQyxTQUFTLEVBQUU7Z0JBQ2hDLE9BQU8sRUFBRTtvQkFDUCxJQUFJLEVBQUUsSUFBSTtvQkFDVixTQUFTLEVBQUU7d0JBQ1QsS0FBSyxFQUFFOzRCQUNMLFNBQVMsRUFBRTtnQ0FDVCxHQUFHLEVBQUUsT0FBTyxDQUFDLFNBQVM7Z0NBQ3RCLEdBQUcsRUFBRSxPQUFPLENBQUMsT0FBTzs2QkFDckI7eUJBQ0Y7cUJBQ0Y7b0JBQ0QsV0FBVyxFQUFFO3dCQUNYLEtBQUssRUFBRTs0QkFDTCxTQUFTLEVBQUU7Z0NBQ1QsR0FBRyxFQUFFLE9BQU8sQ0FBQyxTQUFTO2dDQUN0QixHQUFHLEVBQUUsT0FBTyxDQUFDLE9BQU87NkJBQ3JCO3lCQUNGO3FCQUNGO29CQUNELEtBQUssRUFBRTt3QkFDTCxLQUFLLEVBQUU7NEJBQ0wsRUFBRSxFQUFFO2dDQUNGLEVBQUUsTUFBTSxFQUFFLFFBQVEsRUFBRTtnQ0FDcEIsRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFOzZCQUN4Qjt5QkFDRjtxQkFDRjtpQkFDRjthQUNGLENBQUMsQ0FBQztZQUVILElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQztn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LENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLENBQUM7d0JBQ3ZDLEVBQUUsRUFBRSxNQUFNLENBQUMsRUFBRTt3QkFDYixLQUFLLEVBQUUsTUFBTSxDQUFDLEtBQUs7d0JBQ25CLElBQUksRUFBRSxNQUFNLENBQUMsSUFBSTt3QkFDakIsUUFBUSxFQUFFLE1BQU0sQ0FBQyxRQUFRO3FCQUMxQixDQUFDLENBQUM7aUJBQ0o7Z0JBQ0QsU0FBUyxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsR0FBRyxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUMsQ0FBQztvQkFDekMsRUFBRSxFQUFFLFFBQVEsQ0FBQyxFQUFFO29CQUNmLEtBQUssRUFBRSxRQUFRLENBQUMsS0FBSztvQkFDckIsSUFBSSxFQUFFLFFBQVEsQ0FBQyxJQUFJO2lCQUNwQixDQUFDLENBQUM7YUFDSixDQUFDO1FBQ0osQ0FBQztRQUFDLE9BQU8sS0FBSyxFQUFFLENBQUM7WUFDZixNQUFNLENBQUMsS0FBSyxDQUFDLDBDQUEwQyxFQUFFLEtBQUssQ0FBQyxDQUFDO1lBQ2hFLE1BQU0sS0FBSyxDQUFDO1FBQ2QsQ0FBQztJQUNILENBQUM7Q0FDRjtBQUVELE1BQU0sQ0FBQyxNQUFNLHNCQUFzQixHQUFHLElBQUksc0JBQXNCLEVBQUUsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyIvVXNlcnMvbWljaGFlbG1jaXNhYWMvR2l0SHViL3RlYWNoaW5nLWVuZ2luZTIuMC9zZXJ2ZXIvc3JjL3NlcnZpY2VzL3JlcG9ydEdlbmVyYXRvclNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnLi4vcHJpc21hJztcbmltcG9ydCB7IGdlbmVyYXRlQ29udGVudCB9IGZyb20gJy4vbGxtU2VydmljZSc7XG5pbXBvcnQgbG9nZ2VyIGZyb20gJy4uL2xvZ2dlcic7XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVwb3J0R2VuZXJhdGlvblJlcXVlc3Qge1xuICBzdHVkZW50SWQ6IG51bWJlcjtcbiAgcmVwb3J0VHlwZTogJ3Byb2dyZXNzJyB8ICduYXJyYXRpdmUnIHwgJ3Rlcm1fc3VtbWFyeScgfCAncmVwb3J0X2NhcmQnO1xuICB0ZXJtSWQ/OiBudW1iZXI7XG4gIHN1YmplY3RJZD86IG51bWJlcjtcbiAgc3RhcnREYXRlOiBEYXRlO1xuICBlbmREYXRlOiBEYXRlO1xuICBsYW5ndWFnZTogJ2VuJyB8ICdmcic7XG4gIGluY2x1ZGVBc3Nlc3NtZW50cz86IGJvb2xlYW47XG4gIGluY2x1ZGVBdHRlbmRhbmNlPzogYm9vbGVhbjtcbiAgaW5jbHVkZUdvYWxzPzogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBHZW5lcmF0ZWRSZXBvcnQge1xuICBzdHVkZW50TmFtZTogc3RyaW5nO1xuICBwZXJpb2Q6IHN0cmluZztcbiAgc2VjdGlvbnM6IFJlcG9ydFNlY3Rpb25bXTtcbiAgb3ZlcmFsbENvbW1lbnRzOiBzdHJpbmc7XG4gIG5leHRTdGVwczogc3RyaW5nW107XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVwb3J0U2VjdGlvbiB7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgZGF0YT86IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xufVxuXG4vLyBUeXBlIGRlZmluaXRpb25zIGZvciBzdHVkZW50IGRhdGEgd2l0aCByZWxhdGlvbnNcbmludGVyZmFjZSBTdHVkZW50V2l0aFJlbGF0aW9ucyB7XG4gIGlkOiBudW1iZXI7XG4gIGZpcnN0TmFtZTogc3RyaW5nO1xuICBsYXN0TmFtZTogc3RyaW5nO1xuICB1c2VyOiB7IGlkOiBudW1iZXIgfTtcbiAgYXJ0aWZhY3RzOiBBcnRpZmFjdFtdO1xuICByZWZsZWN0aW9uczogUmVmbGVjdGlvbltdO1xuICBnb2FsczogR29hbFtdO1xufVxuXG5cbmludGVyZmFjZSBBcnRpZmFjdCB7XG4gIGlkOiBudW1iZXI7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uOiBzdHJpbmcgfCBudWxsO1xuICBjcmVhdGVkQXQ6IERhdGU7XG59XG5cbmludGVyZmFjZSBSZWZsZWN0aW9uIHtcbiAgaWQ6IG51bWJlcjtcbiAgY29udGVudDogc3RyaW5nO1xuICBjcmVhdGVkQXQ6IERhdGU7XG59XG5cbmludGVyZmFjZSBHb2FsIHtcbiAgaWQ6IG51bWJlcjtcbiAgdGV4dDogc3RyaW5nO1xuICBzdGF0dXM6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFN1YmplY3RQcm9ncmVzcyB7XG4gIGlkOiBudW1iZXI7XG4gIG5hbWU6IHN0cmluZztcbiAgb3V0Y29tZXM6IHN0cmluZ1tdO1xuICBhdmVyYWdlU2NvcmU6IG51bWJlcjtcbiAgW2tleTogc3RyaW5nXTogdW5rbm93bjtcbn1cblxuaW50ZXJmYWNlIFN1YmplY3RSZXBvcnRDYXJkIHtcbiAgaWQ6IG51bWJlcjtcbiAgbmFtZTogc3RyaW5nO1xuICBncmFkZTogc3RyaW5nO1xuICBvdXRjb21lczogc3RyaW5nW107XG59XG5cbi8vIFR5cGUgZGVmaW5pdGlvbnMgZm9yIGN1cnJpY3VsdW0gYW5kIHBsYW5uaW5nIHJlcG9ydHNcbmV4cG9ydCBpbnRlcmZhY2UgQ3VycmljdWx1bUNvdmVyYWdlUmVwb3J0IHtcbiAgdG90YWxFeHBlY3RhdGlvbnM6IG51bWJlcjtcbiAgY292ZXJlZEV4cGVjdGF0aW9uczogbnVtYmVyO1xuICBjb3ZlcmFnZVBlcmNlbnRhZ2U6IG51bWJlcjtcbiAgdW5jb3ZlcmVkRXhwZWN0YXRpb25zOiBBcnJheTx7XG4gICAgaWQ6IHN0cmluZztcbiAgICBjb2RlOiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgICBzdHJhbmQ6IHN0cmluZztcbiAgfT47XG4gIGNvdmVyYWdlQnlTdHJhbmQ6IFJlY29yZDxzdHJpbmcsIHtcbiAgICB0b3RhbDogbnVtYmVyO1xuICAgIGNvdmVyZWQ6IG51bWJlcjtcbiAgICBwZXJjZW50YWdlOiBudW1iZXI7XG4gIH0+O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBsYW5uaW5nUHJvZ3Jlc3NSZXBvcnQge1xuICBsb25nUmFuZ2VQbGFuczoge1xuICAgIHRvdGFsOiBudW1iZXI7XG4gICAgY29tcGxldGVkOiBudW1iZXI7XG4gICAgY29tcGxldGlvblJhdGU6IG51bWJlcjtcbiAgfTtcbiAgdW5pdFBsYW5zOiB7XG4gICAgdG90YWw6IG51bWJlcjtcbiAgICBjb21wbGV0ZWQ6IG51bWJlcjtcbiAgICBjb21wbGV0aW9uUmF0ZTogbnVtYmVyO1xuICB9O1xuICBsZXNzb25QbGFuczoge1xuICAgIHRvdGFsOiBudW1iZXI7XG4gICAgY29tcGxldGVkOiBudW1iZXI7XG4gICAgY29tcGxldGlvblJhdGU6IG51bWJlcjtcbiAgfTtcbiAgZGF5Ym9va0VudHJpZXM6IHtcbiAgICB0b3RhbDogbnVtYmVyO1xuICAgIGNvbXBsZXRlZDogbnVtYmVyO1xuICAgIGNvbXBsZXRpb25SYXRlOiBudW1iZXI7XG4gIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgTGVzc29uUGxhblJlcG9ydCB7XG4gIGxlc3Nvbjoge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICBkYXRlOiBEYXRlO1xuICAgIGR1cmF0aW9uOiBudW1iZXI7XG4gICAgbWluZHNPbj86IHN0cmluZztcbiAgICBhY3Rpb24/OiBzdHJpbmc7XG4gICAgY29uc29saWRhdGlvbj86IHN0cmluZztcbiAgICBsZWFybmluZ0dvYWxzPzogc3RyaW5nO1xuICAgIG1hdGVyaWFscz86IHN0cmluZ1tdO1xuICAgIGlzU3ViRnJpZW5kbHk6IGJvb2xlYW47XG4gIH07XG4gIGhpZXJhcmNoeToge1xuICAgIGxvbmdSYW5nZVBsYW46IHtcbiAgICAgIGlkOiBzdHJpbmc7XG4gICAgICB0aXRsZTogc3RyaW5nO1xuICAgICAgc3ViamVjdD86IHN0cmluZztcbiAgICAgIGdyYWRlPzogbnVtYmVyO1xuICAgIH07XG4gICAgdW5pdFBsYW46IHtcbiAgICAgIGlkOiBzdHJpbmc7XG4gICAgICB0aXRsZTogc3RyaW5nO1xuICAgIH07XG4gIH07XG4gIGN1cnJpY3VsdW1BbGlnbm1lbnQ6IEFycmF5PHtcbiAgICBpZDogc3RyaW5nO1xuICAgIGNvZGU6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIHN0cmFuZDogc3RyaW5nO1xuICB9PjtcbiAgcmVmbGVjdGlvbj86IHtcbiAgICB3aGF0V29ya2VkPzogc3RyaW5nO1xuICAgIG92ZXJhbGxSYXRpbmc/OiBudW1iZXI7XG4gICAgd291bGRSZXVzZUxlc3Nvbj86IGJvb2xlYW47XG4gIH07XG4gIHJlc291cmNlczogQXJyYXk8e1xuICAgIGlkOiBzdHJpbmc7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICB0eXBlOiBzdHJpbmc7XG4gICAgdXJsPzogc3RyaW5nO1xuICB9Pjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTdWJzdGl0dXRlUGxhblJlcG9ydCB7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIGJhc2ljSW5mbzoge1xuICAgIHN1YmplY3Q6IHN0cmluZztcbiAgICBncmFkZTogbnVtYmVyO1xuICAgIGR1cmF0aW9uOiBudW1iZXI7XG4gICAgZGF0ZTogRGF0ZTtcbiAgfTtcbiAgbWF0ZXJpYWxzOiBzdHJpbmdbXTtcbiAgYWN0aXZpdGllczoge1xuICAgIG9wZW5pbmc6IHN0cmluZztcbiAgICBtYWluOiBzdHJpbmc7XG4gICAgY2xvc2luZzogc3RyaW5nO1xuICB9O1xuICBzcGVjaWFsTm90ZXM/OiBzdHJpbmc7XG4gIHJlc291cmNlczogQXJyYXk8e1xuICAgIGlkOiBzdHJpbmc7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICB0eXBlOiBzdHJpbmc7XG4gICAgY29udGVudD86IHN0cmluZztcbiAgfT47XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVW5pdE92ZXJ2aWV3UmVwb3J0IHtcbiAgdW5pdDoge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgdGl0bGU6IHN0cmluZztcbiAgICBkZXNjcmlwdGlvbj86IHN0cmluZztcbiAgICBiaWdJZGVhcz86IHN0cmluZztcbiAgICBzdGFydERhdGU6IERhdGU7XG4gICAgZW5kRGF0ZTogRGF0ZTtcbiAgICBlc3RpbWF0ZWRIb3VyczogbnVtYmVyO1xuICB9O1xuICBoaWVyYXJjaHk6IHtcbiAgICBsb25nUmFuZ2VQbGFuOiB7XG4gICAgICBpZDogc3RyaW5nO1xuICAgICAgdGl0bGU6IHN0cmluZztcbiAgICAgIHN1YmplY3Q/OiBzdHJpbmc7XG4gICAgICBncmFkZT86IG51bWJlcjtcbiAgICB9O1xuICB9O1xuICBjdXJyaWN1bHVtQWxpZ25tZW50OiBBcnJheTx7XG4gICAgaWQ6IHN0cmluZztcbiAgICBjb2RlOiBzdHJpbmc7XG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgICBzdHJhbmQ6IHN0cmluZztcbiAgfT47XG4gIGxlc3NvblN1bW1hcnk6IHtcbiAgICB0b3RhbExlc3NvbnM6IG51bWJlcjtcbiAgICB0b3RhbER1cmF0aW9uOiBudW1iZXI7XG4gICAgbGVzc29uczogQXJyYXk8e1xuICAgICAgaWQ6IHN0cmluZztcbiAgICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgICBkYXRlOiBEYXRlO1xuICAgICAgZHVyYXRpb246IG51bWJlcjtcbiAgICB9PjtcbiAgfTtcbiAgcmVzb3VyY2VzOiBBcnJheTx7XG4gICAgaWQ6IHN0cmluZztcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIHR5cGU6IHN0cmluZztcbiAgfT47XG59XG5cbmV4cG9ydCBjbGFzcyBSZXBvcnRHZW5lcmF0b3JTZXJ2aWNlIHtcbiAgYXN5bmMgZ2VuZXJhdGVSZXBvcnQocmVxdWVzdDogUmVwb3J0R2VuZXJhdGlvblJlcXVlc3QpOiBQcm9taXNlPEdlbmVyYXRlZFJlcG9ydD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBGZXRjaCBzdHVkZW50IGRhdGFcbiAgICAgIGNvbnN0IHN0dWRlbnQgPSBhd2FpdCBwcmlzbWEuc3R1ZGVudC5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHJlcXVlc3Quc3R1ZGVudElkIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICB1c2VyOiB0cnVlLFxuICAgICAgICAgIGFydGlmYWN0czoge1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgZ3RlOiByZXF1ZXN0LnN0YXJ0RGF0ZSxcbiAgICAgICAgICAgICAgICBsdGU6IHJlcXVlc3QuZW5kRGF0ZSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICByZWZsZWN0aW9uczoge1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgZ3RlOiByZXF1ZXN0LnN0YXJ0RGF0ZSxcbiAgICAgICAgICAgICAgICBsdGU6IHJlcXVlc3QuZW5kRGF0ZSxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBnb2Fsczoge1xuICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgT1I6IFtcbiAgICAgICAgICAgICAgICB7IHN0YXR1czogJ2FjdGl2ZScgfSxcbiAgICAgICAgICAgICAgICB7IHN0YXR1czogJ2NvbXBsZXRlZCcgfSxcbiAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXN0dWRlbnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTdHVkZW50IG5vdCBmb3VuZCcpO1xuICAgICAgfVxuXG4gICAgICAvLyBHZW5lcmF0ZSByZXBvcnQgYmFzZWQgb24gdHlwZVxuICAgICAgbGV0IHJlcG9ydDogR2VuZXJhdGVkUmVwb3J0O1xuICAgICAgXG4gICAgICBzd2l0Y2ggKHJlcXVlc3QucmVwb3J0VHlwZSkge1xuICAgICAgICBjYXNlICdwcm9ncmVzcyc6XG4gICAgICAgICAgcmVwb3J0ID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVByb2dyZXNzUmVwb3J0KHN0dWRlbnQsIHJlcXVlc3QpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICduYXJyYXRpdmUnOlxuICAgICAgICAgIHJlcG9ydCA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVOYXJyYXRpdmVSZXBvcnQoc3R1ZGVudCwgcmVxdWVzdCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3Rlcm1fc3VtbWFyeSc6XG4gICAgICAgICAgcmVwb3J0ID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVRlcm1TdW1tYXJ5KHN0dWRlbnQsIHJlcXVlc3QpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdyZXBvcnRfY2FyZCc6XG4gICAgICAgICAgcmVwb3J0ID0gYXdhaXQgdGhpcy5nZW5lcmF0ZVJlcG9ydENhcmQoc3R1ZGVudCwgcmVxdWVzdCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHJlcG9ydCB0eXBlJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXBvcnQ7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdlbmVyYXRlIHJlcG9ydDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlUHJvZ3Jlc3NSZXBvcnQoXG4gICAgc3R1ZGVudDogU3R1ZGVudFdpdGhSZWxhdGlvbnMsXG4gICAgcmVxdWVzdDogUmVwb3J0R2VuZXJhdGlvblJlcXVlc3RcbiAgKTogUHJvbWlzZTxHZW5lcmF0ZWRSZXBvcnQ+IHtcbiAgICBjb25zdCBzZWN0aW9uczogUmVwb3J0U2VjdGlvbltdID0gW107XG5cbiAgICAvLyBBc3Nlc3NtZW50IGZ1bmN0aW9uYWxpdHkgcmVtb3ZlZCAtIGZvY3VzIG9uIGFydGlmYWN0cyBhbmQgcmVmbGVjdGlvbnNcbiAgICBpZiAoc3R1ZGVudC5hcnRpZmFjdHMubGVuZ3RoID4gMCB8fCBzdHVkZW50LnJlZmxlY3Rpb25zLmxlbmd0aCA+IDApIHtcbiAgICAgIHNlY3Rpb25zLnB1c2goe1xuICAgICAgICB0aXRsZTogcmVxdWVzdC5sYW5ndWFnZSA9PT0gJ2ZyJyA/ICdQcm9ncsOocyBhY2Fkw6ltaXF1ZScgOiAnQWNhZGVtaWMgUHJvZ3Jlc3MnLFxuICAgICAgICBjb250ZW50OiBhd2FpdCB0aGlzLmdlbmVyYXRlUHJvZ3Jlc3NGcm9tQXJ0aWZhY3RzKHN0dWRlbnQuYXJ0aWZhY3RzLCBzdHVkZW50LnJlZmxlY3Rpb25zLCByZXF1ZXN0Lmxhbmd1YWdlKSxcbiAgICAgICAgZGF0YTogeyBhcnRpZmFjdHM6IHN0dWRlbnQuYXJ0aWZhY3RzLCByZWZsZWN0aW9uczogc3R1ZGVudC5yZWZsZWN0aW9ucyB9LFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gR29hbHMgU2VjdGlvblxuICAgIGlmIChyZXF1ZXN0LmluY2x1ZGVHb2FscyAmJiBzdHVkZW50LmdvYWxzLmxlbmd0aCA+IDApIHtcbiAgICAgIHNlY3Rpb25zLnB1c2goe1xuICAgICAgICB0aXRsZTogcmVxdWVzdC5sYW5ndWFnZSA9PT0gJ2ZyJyA/ICdPYmplY3RpZnMnIDogJ0dvYWxzJyxcbiAgICAgICAgY29udGVudDogYXdhaXQgdGhpcy5nZW5lcmF0ZUdvYWxzTmFycmF0aXZlKHN0dWRlbnQuZ29hbHMsIHJlcXVlc3QubGFuZ3VhZ2UpLFxuICAgICAgICBkYXRhOiB7IGdvYWxzOiBzdHVkZW50LmdvYWxzIH0sXG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBPdmVyYWxsIENvbW1lbnRzXG4gICAgY29uc3Qgb3ZlcmFsbENvbW1lbnRzID0gYXdhaXQgdGhpcy5nZW5lcmF0ZU92ZXJhbGxDb21tZW50cyhcbiAgICAgIHN0dWRlbnQsXG4gICAgICBzZWN0aW9ucyxcbiAgICAgIHJlcXVlc3QubGFuZ3VhZ2VcbiAgICApO1xuXG4gICAgLy8gTmV4dCBTdGVwc1xuICAgIGNvbnN0IG5leHRTdGVwcyA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVOZXh0U3RlcHMoc3R1ZGVudCwgc2VjdGlvbnMsIHJlcXVlc3QubGFuZ3VhZ2UpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN0dWRlbnROYW1lOiBgJHtzdHVkZW50LmZpcnN0TmFtZX0gJHtzdHVkZW50Lmxhc3ROYW1lfWAsXG4gICAgICBwZXJpb2Q6IGAke3JlcXVlc3Quc3RhcnREYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygpfSAtICR7cmVxdWVzdC5lbmREYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygpfWAsXG4gICAgICBzZWN0aW9ucyxcbiAgICAgIG92ZXJhbGxDb21tZW50cyxcbiAgICAgIG5leHRTdGVwcyxcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZW5lcmF0ZU5hcnJhdGl2ZVJlcG9ydChcbiAgICBzdHVkZW50OiBTdHVkZW50V2l0aFJlbGF0aW9ucyxcbiAgICByZXF1ZXN0OiBSZXBvcnRHZW5lcmF0aW9uUmVxdWVzdFxuICApOiBQcm9taXNlPEdlbmVyYXRlZFJlcG9ydD4ge1xuICAgIC8vIEdhdGhlciBjb21wcmVoZW5zaXZlIGRhdGFcbiAgICBjb25zdCBsZWFybmluZ0pvdXJuZXkgPSB0aGlzLmNvbXBpbGVMZWFybmluZ0pvdXJuZXkoc3R1ZGVudCk7XG4gICAgXG4gICAgLy8gR2VuZXJhdGUgbmFycmF0aXZlIHVzaW5nIExMTVxuICAgIGNvbnN0IHByb21wdCA9IHJlcXVlc3QubGFuZ3VhZ2UgPT09ICdmcicgXG4gICAgICA/IGBHw6luw6lyZXogdW4gcmFwcG9ydCBuYXJyYXRpZiBkw6l0YWlsbMOpIHBvdXIgJHtzdHVkZW50LmZpcnN0TmFtZX0gJHtzdHVkZW50Lmxhc3ROYW1lfSwgY291dnJhbnQgbGEgcMOpcmlvZGUgZHUgJHtyZXF1ZXN0LnN0YXJ0RGF0ZS50b0xvY2FsZURhdGVTdHJpbmcoKX0gYXUgJHtyZXF1ZXN0LmVuZERhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCl9LiBJbmNsdWV6IGxlcyByw6lhbGlzYXRpb25zLCBsZXMgZMOpZmlzIGV0IGxlcyBkb21haW5lcyBkZSBjcm9pc3NhbmNlLmBcbiAgICAgIDogYEdlbmVyYXRlIGEgZGV0YWlsZWQgbmFycmF0aXZlIHJlcG9ydCBmb3IgJHtzdHVkZW50LmZpcnN0TmFtZX0gJHtzdHVkZW50Lmxhc3ROYW1lfSwgY292ZXJpbmcgdGhlIHBlcmlvZCBmcm9tICR7cmVxdWVzdC5zdGFydERhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCl9IHRvICR7cmVxdWVzdC5lbmREYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygpfS4gSW5jbHVkZSBhY2hpZXZlbWVudHMsIGNoYWxsZW5nZXMsIGFuZCBhcmVhcyBvZiBncm93dGguYDtcblxuICAgIGNvbnN0IG5hcnJhdGl2ZSA9IGF3YWl0IGdlbmVyYXRlQ29udGVudChwcm9tcHQsIEpTT04uc3RyaW5naWZ5KGxlYXJuaW5nSm91cm5leSkpO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN0dWRlbnROYW1lOiBgJHtzdHVkZW50LmZpcnN0TmFtZX0gJHtzdHVkZW50Lmxhc3ROYW1lfWAsXG4gICAgICBwZXJpb2Q6IGAke3JlcXVlc3Quc3RhcnREYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygpfSAtICR7cmVxdWVzdC5lbmREYXRlLnRvTG9jYWxlRGF0ZVN0cmluZygpfWAsXG4gICAgICBzZWN0aW9uczogW3tcbiAgICAgICAgdGl0bGU6IHJlcXVlc3QubGFuZ3VhZ2UgPT09ICdmcicgPyAnUmFwcG9ydCBuYXJyYXRpZicgOiAnTmFycmF0aXZlIFJlcG9ydCcsXG4gICAgICAgIGNvbnRlbnQ6IG5hcnJhdGl2ZSxcbiAgICAgIH1dLFxuICAgICAgb3ZlcmFsbENvbW1lbnRzOiAnJyxcbiAgICAgIG5leHRTdGVwczogW10sXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVUZXJtU3VtbWFyeShcbiAgICBzdHVkZW50OiBTdHVkZW50V2l0aFJlbGF0aW9ucyxcbiAgICByZXF1ZXN0OiBSZXBvcnRHZW5lcmF0aW9uUmVxdWVzdFxuICApOiBQcm9taXNlPEdlbmVyYXRlZFJlcG9ydD4ge1xuICAgIGNvbnN0IHNlY3Rpb25zOiBSZXBvcnRTZWN0aW9uW10gPSBbXTtcblxuICAgIC8vIEdldCBzdWJqZWN0LXNwZWNpZmljIHByb2dyZXNzXG4gICAgY29uc3Qgc3ViamVjdFByb2dyZXNzID0gYXdhaXQgdGhpcy5nZXRTdWJqZWN0UHJvZ3Jlc3Moc3R1ZGVudCk7XG4gICAgXG4gICAgZm9yIChjb25zdCBzdWJqZWN0IG9mIHN1YmplY3RQcm9ncmVzcykge1xuICAgICAgc2VjdGlvbnMucHVzaCh7XG4gICAgICAgIHRpdGxlOiBzdWJqZWN0Lm5hbWUsXG4gICAgICAgIGNvbnRlbnQ6IGF3YWl0IHRoaXMuZ2VuZXJhdGVTdWJqZWN0U3VtbWFyeShzdWJqZWN0LCByZXF1ZXN0Lmxhbmd1YWdlKSxcbiAgICAgICAgZGF0YTogc3ViamVjdCxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIE92ZXJhbGwgdGVybSBwZXJmb3JtYW5jZVxuICAgIGNvbnN0IG92ZXJhbGxDb21tZW50cyA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVUZXJtT3ZlcnZpZXcoXG4gICAgICBzdHVkZW50LFxuICAgICAgc3ViamVjdFByb2dyZXNzLFxuICAgICAgcmVxdWVzdC5sYW5ndWFnZVxuICAgICk7XG5cbiAgICAvLyBSZWNvbW1lbmRhdGlvbnMgZm9yIG5leHQgdGVybVxuICAgIGNvbnN0IG5leHRTdGVwcyA9IGF3YWl0IHRoaXMuZ2VuZXJhdGVUZXJtUmVjb21tZW5kYXRpb25zKFxuICAgICAgc3R1ZGVudCxcbiAgICAgIHN1YmplY3RQcm9ncmVzcyxcbiAgICAgIHJlcXVlc3QubGFuZ3VhZ2VcbiAgICApO1xuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN0dWRlbnROYW1lOiBgJHtzdHVkZW50LmZpcnN0TmFtZX0gJHtzdHVkZW50Lmxhc3ROYW1lfWAsXG4gICAgICBwZXJpb2Q6IHJlcXVlc3QubGFuZ3VhZ2UgPT09ICdmcicgPyAnUsOpc3Vtw6kgZHUgdHJpbWVzdHJlJyA6ICdUZXJtIFN1bW1hcnknLFxuICAgICAgc2VjdGlvbnMsXG4gICAgICBvdmVyYWxsQ29tbWVudHMsXG4gICAgICBuZXh0U3RlcHMsXG4gICAgfTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVSZXBvcnRDYXJkKFxuICAgIHN0dWRlbnQ6IFN0dWRlbnRXaXRoUmVsYXRpb25zLFxuICAgIHJlcXVlc3Q6IFJlcG9ydEdlbmVyYXRpb25SZXF1ZXN0XG4gICk6IFByb21pc2U8R2VuZXJhdGVkUmVwb3J0PiB7XG4gICAgY29uc3Qgc2VjdGlvbnM6IFJlcG9ydFNlY3Rpb25bXSA9IFtdO1xuXG4gICAgLy8gR2V0IGZvcm1hbCBncmFkZXMvYXNzZXNzbWVudHMgYnkgc3ViamVjdFxuICAgIGNvbnN0IHJlcG9ydENhcmREYXRhID0gYXdhaXQgdGhpcy5jb21waWxlUmVwb3J0Q2FyZERhdGEoc3R1ZGVudCk7XG5cbiAgICBmb3IgKGNvbnN0IHN1YmplY3Qgb2YgcmVwb3J0Q2FyZERhdGEpIHtcbiAgICAgIC8vIEdlbmVyYXRlIHRlYWNoZXIgY29tbWVudHMgZm9yIGVhY2ggc3ViamVjdFxuICAgICAgY29uc3QgY29tbWVudHMgPSBhd2FpdCB0aGlzLmdlbmVyYXRlU3ViamVjdENvbW1lbnRzKFxuICAgICAgICBzdWJqZWN0LFxuICAgICAgICBzdHVkZW50LFxuICAgICAgICByZXF1ZXN0Lmxhbmd1YWdlXG4gICAgICApO1xuXG4gICAgICBzZWN0aW9ucy5wdXNoKHtcbiAgICAgICAgdGl0bGU6IHN1YmplY3QubmFtZSxcbiAgICAgICAgY29udGVudDogY29tbWVudHMsXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBncmFkZTogc3ViamVjdC5ncmFkZSxcbiAgICAgICAgICBvdXRjb21lczogc3ViamVjdC5vdXRjb21lcyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEdlbmVyYWwgY29tbWVudHNcbiAgICBjb25zdCBvdmVyYWxsQ29tbWVudHMgPSBhd2FpdCB0aGlzLmdlbmVyYXRlUmVwb3J0Q2FyZENvbW1lbnRzKFxuICAgICAgc3R1ZGVudCxcbiAgICAgIHJlcG9ydENhcmREYXRhLFxuICAgICAgcmVxdWVzdC5sYW5ndWFnZVxuICAgICk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3R1ZGVudE5hbWU6IGAke3N0dWRlbnQuZmlyc3ROYW1lfSAke3N0dWRlbnQubGFzdE5hbWV9YCxcbiAgICAgIHBlcmlvZDogcmVxdWVzdC5sYW5ndWFnZSA9PT0gJ2ZyJyA/ICdCdWxsZXRpbiBzY29sYWlyZScgOiAnUmVwb3J0IENhcmQnLFxuICAgICAgc2VjdGlvbnMsXG4gICAgICBvdmVyYWxsQ29tbWVudHMsXG4gICAgICBuZXh0U3RlcHM6IFtdLFxuICAgIH07XG4gIH1cblxuICAvLyBIZWxwZXIgbWV0aG9kc1xuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlUHJvZ3Jlc3NGcm9tQXJ0aWZhY3RzKFxuICAgIGFydGlmYWN0czogQXJ0aWZhY3RbXSxcbiAgICByZWZsZWN0aW9uczogUmVmbGVjdGlvbltdLFxuICAgIGxhbmd1YWdlOiAnZW4nIHwgJ2ZyJ1xuICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGNvbnRleHQgPSB7XG4gICAgICBhcnRpZmFjdENvdW50OiBhcnRpZmFjdHMubGVuZ3RoLFxuICAgICAgcmVmbGVjdGlvbkNvdW50OiByZWZsZWN0aW9ucy5sZW5ndGgsXG4gICAgICByZWNlbnRBcnRpZmFjdHM6IGFydGlmYWN0cy5zbGljZSgwLCAzKS5tYXAoYSA9PiAoeyB0aXRsZTogYS50aXRsZSwgZGVzY3JpcHRpb246IGEuZGVzY3JpcHRpb24gfSkpLFxuICAgICAgcmVjZW50UmVmbGVjdGlvbnM6IHJlZmxlY3Rpb25zLnNsaWNlKDAsIDMpLm1hcChyID0+ICh7IGNvbnRlbnQ6IHIuY29udGVudCB9KSlcbiAgICB9O1xuXG4gICAgY29uc3QgcHJvbXB0ID0gbGFuZ3VhZ2UgPT09ICdmcidcbiAgICAgID8gYETDqWNyaXZleiBsZSBwcm9ncsOocyBhY2Fkw6ltaXF1ZSBiYXPDqSBzdXIgJHthcnRpZmFjdHMubGVuZ3RofSBhcnRlZmFjdHMgZXQgJHtyZWZsZWN0aW9ucy5sZW5ndGh9IHLDqWZsZXhpb25zLmBcbiAgICAgIDogYERlc2NyaWJlIGFjYWRlbWljIHByb2dyZXNzIGJhc2VkIG9uICR7YXJ0aWZhY3RzLmxlbmd0aH0gYXJ0aWZhY3RzIGFuZCAke3JlZmxlY3Rpb25zLmxlbmd0aH0gcmVmbGVjdGlvbnMuYDtcblxuICAgIHJldHVybiBnZW5lcmF0ZUNvbnRlbnQocHJvbXB0LCBKU09OLnN0cmluZ2lmeShjb250ZXh0KSk7XG4gIH1cblxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVHb2Fsc05hcnJhdGl2ZShcbiAgICBnb2FsczogR29hbFtdLFxuICAgIGxhbmd1YWdlOiAnZW4nIHwgJ2ZyJ1xuICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IGFjdGl2ZUdvYWxzID0gZ29hbHMuZmlsdGVyKGcgPT4gZy5zdGF0dXMgPT09ICdhY3RpdmUnKTtcbiAgICBjb25zdCBjb21wbGV0ZWRHb2FscyA9IGdvYWxzLmZpbHRlcihnID0+IGcuc3RhdHVzID09PSAnY29tcGxldGVkJyk7XG5cbiAgICBjb25zdCBjb250ZXh0ID0ge1xuICAgICAgYWN0aXZlOiBhY3RpdmVHb2Fscy5tYXAoZyA9PiAoeyB0ZXh0OiBnLnRleHQgfSkpLFxuICAgICAgY29tcGxldGVkOiBjb21wbGV0ZWRHb2Fscy5tYXAoZyA9PiAoeyB0ZXh0OiBnLnRleHQgfSkpLFxuICAgIH07XG5cbiAgICBjb25zdCBwcm9tcHQgPSBsYW5ndWFnZSA9PT0gJ2ZyJ1xuICAgICAgPyBgRMOpY3JpdmV6IGxlIHByb2dyw6hzIHZlcnMgbGVzIG9iamVjdGlmcyBkZSBsJ8OpbMOodmU6ICR7SlNPTi5zdHJpbmdpZnkoY29udGV4dCl9YFxuICAgICAgOiBgRGVzY3JpYmUgdGhlIHN0dWRlbnQncyBwcm9ncmVzcyB0b3dhcmQgdGhlaXIgZ29hbHM6ICR7SlNPTi5zdHJpbmdpZnkoY29udGV4dCl9YDtcblxuICAgIHJldHVybiBnZW5lcmF0ZUNvbnRlbnQocHJvbXB0KTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVPdmVyYWxsQ29tbWVudHMoXG4gICAgc3R1ZGVudDogU3R1ZGVudFdpdGhSZWxhdGlvbnMsXG4gICAgc2VjdGlvbnM6IFJlcG9ydFNlY3Rpb25bXSxcbiAgICBsYW5ndWFnZTogJ2VuJyB8ICdmcidcbiAgKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICBjb25zdCBjb250ZXh0ID0ge1xuICAgICAgc3R1ZGVudE5hbWU6IGAke3N0dWRlbnQuZmlyc3ROYW1lfSAke3N0dWRlbnQubGFzdE5hbWV9YCxcbiAgICAgIHNlY3Rpb25zQ291bnQ6IHNlY3Rpb25zLmxlbmd0aCxcbiAgICAgIHNlY3Rpb25UaXRsZXM6IHNlY3Rpb25zLm1hcChzID0+IHMudGl0bGUpLFxuICAgIH07XG5cbiAgICBjb25zdCBwcm9tcHQgPSBsYW5ndWFnZSA9PT0gJ2ZyJ1xuICAgICAgPyBgR8OpbsOpcmV6IGRlcyBjb21tZW50YWlyZXMgZ8OpbsOpcmF1eCBwb3NpdGlmcyBldCBlbmNvdXJhZ2VhbnRzIHBvdXIgJHtjb250ZXh0LnN0dWRlbnROYW1lfSBiYXPDqXMgc3VyIGxldXIgcmFwcG9ydCBkZSBwcm9ncsOocy5gXG4gICAgICA6IGBHZW5lcmF0ZSBwb3NpdGl2ZSBhbmQgZW5jb3VyYWdpbmcgb3ZlcmFsbCBjb21tZW50cyBmb3IgJHtjb250ZXh0LnN0dWRlbnROYW1lfSBiYXNlZCBvbiB0aGVpciBwcm9ncmVzcyByZXBvcnQuYDtcblxuICAgIHJldHVybiBnZW5lcmF0ZUNvbnRlbnQocHJvbXB0LCBKU09OLnN0cmluZ2lmeShjb250ZXh0KSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlTmV4dFN0ZXBzKFxuICAgIHN0dWRlbnQ6IFN0dWRlbnRXaXRoUmVsYXRpb25zLFxuICAgIHNlY3Rpb25zOiBSZXBvcnRTZWN0aW9uW10sXG4gICAgbGFuZ3VhZ2U6ICdlbicgfCAnZnInXG4gICk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBjb25zdCBwcm9tcHQgPSBsYW5ndWFnZSA9PT0gJ2ZyJ1xuICAgICAgPyBgU3VnZ8OpcmV6IDMtNSBwcm9jaGFpbmVzIMOpdGFwZXMgc3DDqWNpZmlxdWVzIHBvdXIgJHtzdHVkZW50LmZpcnN0TmFtZX0gcG91ciBjb250aW51ZXIgbGV1ciBwcm9ncsOocy5gXG4gICAgICA6IGBTdWdnZXN0IDMtNSBzcGVjaWZpYyBuZXh0IHN0ZXBzIGZvciAke3N0dWRlbnQuZmlyc3ROYW1lfSB0byBjb250aW51ZSB0aGVpciBwcm9ncmVzcy5gO1xuXG4gICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSBhd2FpdCBnZW5lcmF0ZUNvbnRlbnQoXG4gICAgICBwcm9tcHQsIFxuICAgICAgSlNPTi5zdHJpbmdpZnkoc2VjdGlvbnMubWFwKHMgPT4gKHsgdGl0bGU6IHMudGl0bGUsIHN1bW1hcnk6IHMuY29udGVudC5zdWJzdHJpbmcoMCwgMTAwKSB9KSkpXG4gICAgKTtcblxuICAgIC8vIFBhcnNlIHRoZSBzdWdnZXN0aW9ucyBpbnRvIGFuIGFycmF5XG4gICAgcmV0dXJuIHN1Z2dlc3Rpb25zLnNwbGl0KCdcXG4nKS5maWx0ZXIocyA9PiBzLnRyaW0oKS5sZW5ndGggPiAwKS5zbGljZSgwLCA1KTtcbiAgfVxuXG4gIHByaXZhdGUgY29tcGlsZUxlYXJuaW5nSm91cm5leShzdHVkZW50OiBTdHVkZW50V2l0aFJlbGF0aW9ucykge1xuICAgIHJldHVybiB7XG4gICAgICBhcnRpZmFjdHM6IHN0dWRlbnQuYXJ0aWZhY3RzLm1hcCgoYSkgPT4gKHtcbiAgICAgICAgdGl0bGU6IGEudGl0bGUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBhLmRlc2NyaXB0aW9uLFxuICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LFxuICAgICAgfSkpLFxuICAgICAgcmVmbGVjdGlvbnM6IHN0dWRlbnQucmVmbGVjdGlvbnMubWFwKChyKSA9PiAoe1xuICAgICAgICBjb250ZW50OiByLmNvbnRlbnQsXG4gICAgICAgIGNyZWF0ZWRBdDogci5jcmVhdGVkQXQsXG4gICAgICB9KSksXG4gICAgICBnb2Fsczogc3R1ZGVudC5nb2FscyxcbiAgICB9O1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBnZXRTdWJqZWN0UHJvZ3Jlc3Moc3R1ZGVudDogU3R1ZGVudFdpdGhSZWxhdGlvbnMgJiB7IHVzZXI6IHsgaWQ6IG51bWJlciB9IH0pOiBQcm9taXNlPFN1YmplY3RQcm9ncmVzc1tdPiB7XG4gICAgLy8gU2ltcGxpZmllZCBzdWJqZWN0IHByb2dyZXNzIHdpdGhvdXQgZGVlcCByZWxhdGlvbnNcbiAgICBjb25zdCBzdWJqZWN0cyA9IGF3YWl0IHByaXNtYS5zdWJqZWN0LmZpbmRNYW55KHtcbiAgICAgIHdoZXJlOiB7IHVzZXJJZDogc3R1ZGVudC51c2VyLmlkIH0sXG4gICAgfSk7XG5cbiAgICByZXR1cm4gc3ViamVjdHMubWFwKHN1YmplY3QgPT4gKHtcbiAgICAgIGlkOiBzdWJqZWN0LmlkLFxuICAgICAgbmFtZTogc3ViamVjdC5uYW1lLFxuICAgICAgb3V0Y29tZXM6IFtdLFxuICAgICAgYXZlcmFnZVNjb3JlOiAwLCAvLyBBc3Nlc3NtZW50IGZ1bmN0aW9uYWxpdHkgcmVtb3ZlZFxuICAgIH0pKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVTdWJqZWN0U3VtbWFyeShzdWJqZWN0OiBTdWJqZWN0UHJvZ3Jlc3MsIGxhbmd1YWdlOiAnZW4nIHwgJ2ZyJyk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgcHJvbXB0ID0gbGFuZ3VhZ2UgPT09ICdmcidcbiAgICAgID8gYFLDqXN1bWV6IGxhIHBlcmZvcm1hbmNlIGRlIGwnw6lsw6h2ZSBlbiAke3N1YmplY3QubmFtZX0gYXZlYyB1bmUgbm90ZSBtb3llbm5lIGRlICR7c3ViamVjdC5hdmVyYWdlU2NvcmUudG9GaXhlZCgxKX0lIGV0IGNvdXZyYW50ICR7c3ViamVjdC5vdXRjb21lcy5sZW5ndGh9IHLDqXN1bHRhdHMgZCdhcHByZW50aXNzYWdlLmBcbiAgICAgIDogYFN1bW1hcml6ZSB0aGUgc3R1ZGVudCdzIHBlcmZvcm1hbmNlIGluICR7c3ViamVjdC5uYW1lfSB3aXRoIGFuIGF2ZXJhZ2Ugc2NvcmUgb2YgJHtzdWJqZWN0LmF2ZXJhZ2VTY29yZS50b0ZpeGVkKDEpfSUgYW5kIGNvdmVyaW5nICR7c3ViamVjdC5vdXRjb21lcy5sZW5ndGh9IGxlYXJuaW5nIG91dGNvbWVzLmA7XG5cbiAgICByZXR1cm4gZ2VuZXJhdGVDb250ZW50KHByb21wdCk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlVGVybU92ZXJ2aWV3KFxuICAgIHN0dWRlbnQ6IFN0dWRlbnRXaXRoUmVsYXRpb25zLFxuICAgIHN1YmplY3RQcm9ncmVzczogU3ViamVjdFByb2dyZXNzW10sXG4gICAgbGFuZ3VhZ2U6ICdlbicgfCAnZnInXG4gICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3Qgb3ZlcmFsbEF2ZXJhZ2UgPSBzdWJqZWN0UHJvZ3Jlc3MucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHMuYXZlcmFnZVNjb3JlLCAwKSAvIHN1YmplY3RQcm9ncmVzcy5sZW5ndGg7XG4gICAgXG4gICAgY29uc3QgcHJvbXB0ID0gbGFuZ3VhZ2UgPT09ICdmcidcbiAgICAgID8gYEfDqW7DqXJleiB1biBhcGVyw6d1IGR1IHRyaW1lc3RyZSBwb3VyICR7c3R1ZGVudC5maXJzdE5hbWV9IGF2ZWMgdW5lIG1veWVubmUgZ8OpbsOpcmFsZSBkZSAke292ZXJhbGxBdmVyYWdlLnRvRml4ZWQoMSl9JSDDoCB0cmF2ZXJzICR7c3ViamVjdFByb2dyZXNzLmxlbmd0aH0gbWF0acOocmVzLmBcbiAgICAgIDogYEdlbmVyYXRlIGEgdGVybSBvdmVydmlldyBmb3IgJHtzdHVkZW50LmZpcnN0TmFtZX0gd2l0aCBhbiBvdmVyYWxsIGF2ZXJhZ2Ugb2YgJHtvdmVyYWxsQXZlcmFnZS50b0ZpeGVkKDEpfSUgYWNyb3NzICR7c3ViamVjdFByb2dyZXNzLmxlbmd0aH0gc3ViamVjdHMuYDtcblxuICAgIHJldHVybiBnZW5lcmF0ZUNvbnRlbnQoXG4gICAgICBwcm9tcHQsXG4gICAgICBKU09OLnN0cmluZ2lmeShzdWJqZWN0UHJvZ3Jlc3MubWFwKHMgPT4gKHsgbmFtZTogcy5uYW1lLCBhdmVyYWdlOiBzLmF2ZXJhZ2VTY29yZSB9KSkpXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVUZXJtUmVjb21tZW5kYXRpb25zKFxuICAgIHN0dWRlbnQ6IFN0dWRlbnRXaXRoUmVsYXRpb25zLFxuICAgIHN1YmplY3RQcm9ncmVzczogU3ViamVjdFByb2dyZXNzW10sXG4gICAgbGFuZ3VhZ2U6ICdlbicgfCAnZnInXG4gICk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBjb25zdCB3ZWFrU3ViamVjdHMgPSBzdWJqZWN0UHJvZ3Jlc3MuZmlsdGVyKHMgPT4gcy5hdmVyYWdlU2NvcmUgPCA3MCk7XG4gICAgY29uc3Qgc3Ryb25nU3ViamVjdHMgPSBzdWJqZWN0UHJvZ3Jlc3MuZmlsdGVyKHMgPT4gcy5hdmVyYWdlU2NvcmUgPj0gODUpO1xuXG4gICAgY29uc3QgcHJvbXB0ID0gbGFuZ3VhZ2UgPT09ICdmcidcbiAgICAgID8gYFN1Z2fDqXJleiAzLTUgcmVjb21tYW5kYXRpb25zIHBvdXIgbGUgcHJvY2hhaW4gdHJpbWVzdHJlIGJhc8OpZXMgc3VyIGxlcyBmb3JjZXMgKCR7c3Ryb25nU3ViamVjdHMubWFwKHMgPT4gcy5uYW1lKS5qb2luKCcsICcpfSkgZXQgbGVzIGRvbWFpbmVzIMOgIGFtw6lsaW9yZXIgKCR7d2Vha1N1YmplY3RzLm1hcChzID0+IHMubmFtZSkuam9pbignLCAnKX0pLmBcbiAgICAgIDogYFN1Z2dlc3QgMy01IHJlY29tbWVuZGF0aW9ucyBmb3IgdGhlIG5leHQgdGVybSBiYXNlZCBvbiBzdHJlbmd0aHMgKCR7c3Ryb25nU3ViamVjdHMubWFwKHMgPT4gcy5uYW1lKS5qb2luKCcsICcpfSkgYW5kIGFyZWFzIGZvciBpbXByb3ZlbWVudCAoJHt3ZWFrU3ViamVjdHMubWFwKHMgPT4gcy5uYW1lKS5qb2luKCcsICcpfSkuYDtcblxuICAgIGNvbnN0IHJlY29tbWVuZGF0aW9ucyA9IGF3YWl0IGdlbmVyYXRlQ29udGVudChwcm9tcHQpO1xuXG4gICAgcmV0dXJuIHJlY29tbWVuZGF0aW9ucy5zcGxpdCgnXFxuJykuZmlsdGVyKHIgPT4gci50cmltKCkubGVuZ3RoID4gMCkuc2xpY2UoMCwgNSk7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGNvbXBpbGVSZXBvcnRDYXJkRGF0YShzdHVkZW50OiBTdHVkZW50V2l0aFJlbGF0aW9ucyAmIHsgdXNlcjogeyBpZDogbnVtYmVyIH0gfSk6IFByb21pc2U8U3ViamVjdFJlcG9ydENhcmRbXT4ge1xuICAgIGNvbnN0IHN1YmplY3RzID0gYXdhaXQgcHJpc21hLnN1YmplY3QuZmluZE1hbnkoe1xuICAgICAgd2hlcmU6IHsgdXNlcklkOiBzdHVkZW50LnVzZXIuaWQgfSxcbiAgICB9KTtcblxuICAgIHJldHVybiBzdWJqZWN0cy5tYXAoc3ViamVjdCA9PiAoe1xuICAgICAgaWQ6IHN1YmplY3QuaWQsXG4gICAgICBuYW1lOiBzdWJqZWN0Lm5hbWUsXG4gICAgICBncmFkZTogJ04vQScsIC8vIEFzc2Vzc21lbnQgZnVuY3Rpb25hbGl0eSByZW1vdmVkXG4gICAgICBvdXRjb21lczogW10sXG4gICAgfSkpO1xuICB9XG5cbiAgcHJpdmF0ZSBzY29yZVRvR3JhZGUoc2NvcmU6IG51bWJlcik6IHN0cmluZyB7XG4gICAgaWYgKHNjb3JlID49IDkwKSByZXR1cm4gJ0EnO1xuICAgIGlmIChzY29yZSA+PSA4MCkgcmV0dXJuICdCJztcbiAgICBpZiAoc2NvcmUgPj0gNzApIHJldHVybiAnQyc7XG4gICAgaWYgKHNjb3JlID49IDYwKSByZXR1cm4gJ0QnO1xuICAgIHJldHVybiAnRic7XG4gIH1cblxuICBwcml2YXRlIGFzeW5jIGdlbmVyYXRlU3ViamVjdENvbW1lbnRzKFxuICAgIHN1YmplY3Q6IFN1YmplY3RSZXBvcnRDYXJkLFxuICAgIHN0dWRlbnQ6IFN0dWRlbnRXaXRoUmVsYXRpb25zLFxuICAgIGxhbmd1YWdlOiAnZW4nIHwgJ2ZyJ1xuICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgIGNvbnN0IHByb21wdCA9IGxhbmd1YWdlID09PSAnZnInXG4gICAgICA/IGBHw6luw6lyZXogZGVzIGNvbW1lbnRhaXJlcyBkJ2Vuc2VpZ25hbnQgcG91ciAke3N0dWRlbnQuZmlyc3ROYW1lfSBlbiAke3N1YmplY3QubmFtZX0gYXZlYyB1bmUgbm90ZSBkZSAke3N1YmplY3QuZ3JhZGV9LiBTb3lleiBzcMOpY2lmaXF1ZSBldCBlbmNvdXJhZ2VhbnQuYFxuICAgICAgOiBgR2VuZXJhdGUgdGVhY2hlciBjb21tZW50cyBmb3IgJHtzdHVkZW50LmZpcnN0TmFtZX0gaW4gJHtzdWJqZWN0Lm5hbWV9IHdpdGggYSBncmFkZSBvZiAke3N1YmplY3QuZ3JhZGV9LiBCZSBzcGVjaWZpYyBhbmQgZW5jb3VyYWdpbmcuYDtcblxuICAgIHJldHVybiBnZW5lcmF0ZUNvbnRlbnQoXG4gICAgICBwcm9tcHQsXG4gICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG91dGNvbWVzOiBzdWJqZWN0Lm91dGNvbWVzLmxlbmd0aCxcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgYXN5bmMgZ2VuZXJhdGVSZXBvcnRDYXJkQ29tbWVudHMoXG4gICAgc3R1ZGVudDogU3R1ZGVudFdpdGhSZWxhdGlvbnMsXG4gICAgcmVwb3J0Q2FyZERhdGE6IFN1YmplY3RSZXBvcnRDYXJkW10sXG4gICAgbGFuZ3VhZ2U6ICdlbicgfCAnZnInXG4gICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3Qgb3ZlcmFsbEdyYWRlID0gcmVwb3J0Q2FyZERhdGEucmVkdWNlKChzdW0sIHMpID0+IHtcbiAgICAgIGNvbnN0IGdyYWRlVmFsdWUgPSB7IEE6IDQsIEI6IDMsIEM6IDIsIEQ6IDEsIEY6IDAgfVtzLmdyYWRlXSB8fCAwO1xuICAgICAgcmV0dXJuIHN1bSArIGdyYWRlVmFsdWU7XG4gICAgfSwgMCkgLyByZXBvcnRDYXJkRGF0YS5sZW5ndGg7XG5cbiAgICBjb25zdCBwcm9tcHQgPSBsYW5ndWFnZSA9PT0gJ2ZyJ1xuICAgICAgPyBgR8OpbsOpcmV6IGRlcyBjb21tZW50YWlyZXMgZ8OpbsOpcmF1eCBkZSBidWxsZXRpbiBwb3VyICR7c3R1ZGVudC5maXJzdE5hbWV9ICR7c3R1ZGVudC5sYXN0TmFtZX0gYXZlYyB1bmUgcGVyZm9ybWFuY2UgZ2xvYmFsZSBkZSAke292ZXJhbGxHcmFkZS50b0ZpeGVkKDEpfS80LjAuYFxuICAgICAgOiBgR2VuZXJhdGUgb3ZlcmFsbCByZXBvcnQgY2FyZCBjb21tZW50cyBmb3IgJHtzdHVkZW50LmZpcnN0TmFtZX0gJHtzdHVkZW50Lmxhc3ROYW1lfSB3aXRoIGFuIG92ZXJhbGwgcGVyZm9ybWFuY2Ugb2YgJHtvdmVyYWxsR3JhZGUudG9GaXhlZCgxKX0vNC4wLmA7XG5cbiAgICByZXR1cm4gZ2VuZXJhdGVDb250ZW50KFxuICAgICAgcHJvbXB0LFxuICAgICAgSlNPTi5zdHJpbmdpZnkocmVwb3J0Q2FyZERhdGEubWFwKHMgPT4gKHsgc3ViamVjdDogcy5uYW1lLCBncmFkZTogcy5ncmFkZSB9KSkpXG4gICAgKTtcbiAgfVxuXG4gIC8vIEN1cnJpY3VsdW0gYW5kIFBsYW5uaW5nIFJlcG9ydCBNZXRob2RzXG4gIGFzeW5jIGdlbmVyYXRlQ3VycmljdWx1bUNvdmVyYWdlUmVwb3J0KHVzZXJJZDogbnVtYmVyKTogUHJvbWlzZTxDdXJyaWN1bHVtQ292ZXJhZ2VSZXBvcnQ+IHtcbiAgICB0cnkge1xuICAgICAgLy8gR2V0IGFsbCBjdXJyaWN1bHVtIGV4cGVjdGF0aW9ucyAtIHdlJ2xsIGZpbHRlciBieSBjb3ZlcmVkL3VuY292ZXJlZCBsYXRlclxuICAgICAgY29uc3QgZXhwZWN0YXRpb25zID0gYXdhaXQgcHJpc21hLmN1cnJpY3VsdW1FeHBlY3RhdGlvbi5maW5kTWFueSgpO1xuXG4gICAgICAvLyBHZXQgYWxsIHBsYW5zIHdpdGggZXhwZWN0YXRpb25zXG4gICAgICBjb25zdCBsb25nUmFuZ2VQbGFucyA9IGF3YWl0IHByaXNtYS5sb25nUmFuZ2VQbGFuLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgdXNlcklkIH0sXG4gICAgICAgIGluY2x1ZGU6IHsgZXhwZWN0YXRpb25zOiB0cnVlIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgdW5pdFBsYW5zID0gYXdhaXQgcHJpc21hLnVuaXRQbGFuLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgdXNlcklkIH0sXG4gICAgICAgIGluY2x1ZGU6IHsgZXhwZWN0YXRpb25zOiB0cnVlIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgbGVzc29uUGxhbnMgPSBhd2FpdCBwcmlzbWEuZVRGT0xlc3NvblBsYW4uZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogeyB1c2VySWQgfSxcbiAgICAgICAgaW5jbHVkZTogeyBleHBlY3RhdGlvbnM6IHRydWUgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDb2xsZWN0IGFsbCBjb3ZlcmVkIGV4cGVjdGF0aW9uIElEc1xuICAgICAgY29uc3QgY292ZXJlZEV4cGVjdGF0aW9uSWRzID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgICBcbiAgICAgIGxvbmdSYW5nZVBsYW5zLmZvckVhY2gocGxhbiA9PiB7XG4gICAgICAgIHBsYW4uZXhwZWN0YXRpb25zLmZvckVhY2goZXhwID0+IGNvdmVyZWRFeHBlY3RhdGlvbklkcy5hZGQoZXhwLmV4cGVjdGF0aW9uSWQpKTtcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICB1bml0UGxhbnMuZm9yRWFjaChwbGFuID0+IHtcbiAgICAgICAgcGxhbi5leHBlY3RhdGlvbnMuZm9yRWFjaChleHAgPT4gY292ZXJlZEV4cGVjdGF0aW9uSWRzLmFkZChleHAuZXhwZWN0YXRpb25JZCkpO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGxlc3NvblBsYW5zLmZvckVhY2gocGxhbiA9PiB7XG4gICAgICAgIHBsYW4uZXhwZWN0YXRpb25zLmZvckVhY2goZXhwID0+IGNvdmVyZWRFeHBlY3RhdGlvbklkcy5hZGQoZXhwLmV4cGVjdGF0aW9uSWQpKTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgY292ZXJhZ2VcbiAgICAgIGNvbnN0IHRvdGFsRXhwZWN0YXRpb25zID0gZXhwZWN0YXRpb25zLmxlbmd0aDtcbiAgICAgIGNvbnN0IGNvdmVyZWRFeHBlY3RhdGlvbnMgPSBjb3ZlcmVkRXhwZWN0YXRpb25JZHMuc2l6ZTtcbiAgICAgIGNvbnN0IGNvdmVyYWdlUGVyY2VudGFnZSA9IHRvdGFsRXhwZWN0YXRpb25zID4gMCBcbiAgICAgICAgPyBNYXRoLnJvdW5kKChjb3ZlcmVkRXhwZWN0YXRpb25zIC8gdG90YWxFeHBlY3RhdGlvbnMpICogMTAwKSBcbiAgICAgICAgOiAwO1xuXG4gICAgICAvLyBGaW5kIHVuY292ZXJlZCBleHBlY3RhdGlvbnNcbiAgICAgIGNvbnN0IHVuY292ZXJlZEV4cGVjdGF0aW9ucyA9IGV4cGVjdGF0aW9uc1xuICAgICAgICAuZmlsdGVyKGV4cCA9PiAhY292ZXJlZEV4cGVjdGF0aW9uSWRzLmhhcyhleHAuaWQpKVxuICAgICAgICAubWFwKGV4cCA9PiAoe1xuICAgICAgICAgIGlkOiBleHAuaWQsXG4gICAgICAgICAgY29kZTogZXhwLmNvZGUsXG4gICAgICAgICAgZGVzY3JpcHRpb246IGV4cC5kZXNjcmlwdGlvbixcbiAgICAgICAgICBzdHJhbmQ6IGV4cC5zdHJhbmQsXG4gICAgICAgIH0pKTtcblxuICAgICAgLy8gQ2FsY3VsYXRlIGNvdmVyYWdlIGJ5IHN0cmFuZFxuICAgICAgY29uc3QgY292ZXJhZ2VCeVN0cmFuZDogUmVjb3JkPHN0cmluZywgeyB0b3RhbDogbnVtYmVyOyBjb3ZlcmVkOiBudW1iZXI7IHBlcmNlbnRhZ2U6IG51bWJlciB9PiA9IHt9O1xuICAgICAgXG4gICAgICBleHBlY3RhdGlvbnMuZm9yRWFjaChleHAgPT4ge1xuICAgICAgICBpZiAoIWNvdmVyYWdlQnlTdHJhbmRbZXhwLnN0cmFuZF0pIHtcbiAgICAgICAgICBjb3ZlcmFnZUJ5U3RyYW5kW2V4cC5zdHJhbmRdID0geyB0b3RhbDogMCwgY292ZXJlZDogMCwgcGVyY2VudGFnZTogMCB9O1xuICAgICAgICB9XG4gICAgICAgIGNvdmVyYWdlQnlTdHJhbmRbZXhwLnN0cmFuZF0udG90YWwrKztcbiAgICAgICAgaWYgKGNvdmVyZWRFeHBlY3RhdGlvbklkcy5oYXMoZXhwLmlkKSkge1xuICAgICAgICAgIGNvdmVyYWdlQnlTdHJhbmRbZXhwLnN0cmFuZF0uY292ZXJlZCsrO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gQ2FsY3VsYXRlIHBlcmNlbnRhZ2VzIGZvciBlYWNoIHN0cmFuZFxuICAgICAgT2JqZWN0LmtleXMoY292ZXJhZ2VCeVN0cmFuZCkuZm9yRWFjaChzdHJhbmQgPT4ge1xuICAgICAgICBjb25zdCBzdHJhbmREYXRhID0gY292ZXJhZ2VCeVN0cmFuZFtzdHJhbmRdO1xuICAgICAgICBzdHJhbmREYXRhLnBlcmNlbnRhZ2UgPSBzdHJhbmREYXRhLnRvdGFsID4gMFxuICAgICAgICAgID8gTWF0aC5yb3VuZCgoc3RyYW5kRGF0YS5jb3ZlcmVkIC8gc3RyYW5kRGF0YS50b3RhbCkgKiAxMDApXG4gICAgICAgICAgOiAwO1xuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvdGFsRXhwZWN0YXRpb25zLFxuICAgICAgICBjb3ZlcmVkRXhwZWN0YXRpb25zLFxuICAgICAgICBjb3ZlcmFnZVBlcmNlbnRhZ2UsXG4gICAgICAgIHVuY292ZXJlZEV4cGVjdGF0aW9ucyxcbiAgICAgICAgY292ZXJhZ2VCeVN0cmFuZCxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdlbmVyYXRlIGN1cnJpY3VsdW0gY292ZXJhZ2UgcmVwb3J0OicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdlbmVyYXRlUGxhbm5pbmdQcm9ncmVzc1JlcG9ydCh1c2VySWQ6IG51bWJlcik6IFByb21pc2U8UGxhbm5pbmdQcm9ncmVzc1JlcG9ydD4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBHZXQgYWxsIHBsYW5uaW5nIGRhdGEgZm9yIHRoZSB1c2VyXG4gICAgICBjb25zdCBsb25nUmFuZ2VQbGFucyA9IGF3YWl0IHByaXNtYS5sb25nUmFuZ2VQbGFuLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgdXNlcklkIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgdW5pdFBsYW5zID0gYXdhaXQgcHJpc21hLnVuaXRQbGFuLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHsgdXNlcklkIH0sXG4gICAgICB9KTtcblxuICAgICAgY29uc3QgbGVzc29uUGxhbnMgPSBhd2FpdCBwcmlzbWEuZVRGT0xlc3NvblBsYW4uZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogeyB1c2VySWQgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBkYXlib29rRW50cmllcyA9IGF3YWl0IHByaXNtYS5kYXlib29rRW50cnkuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZTogeyB1c2VySWQgfSxcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgY29tcGxldGlvbiByYXRlc1xuICAgICAgY29uc3QgY2FsY3VsYXRlQ29tcGxldGlvblJhdGUgPSA8VD4ocGxhbnM6IFRbXSwgaXNDb21wbGV0ZTogKHBsYW46IFQpID0+IGJvb2xlYW4pID0+IHtcbiAgICAgICAgY29uc3QgdG90YWwgPSBwbGFucy5sZW5ndGg7XG4gICAgICAgIGNvbnN0IGNvbXBsZXRlZCA9IHBsYW5zLmZpbHRlcihpc0NvbXBsZXRlKS5sZW5ndGg7XG4gICAgICAgIGNvbnN0IGNvbXBsZXRpb25SYXRlID0gdG90YWwgPiAwID8gTWF0aC5yb3VuZCgoY29tcGxldGVkIC8gdG90YWwpICogMTAwKSA6IDA7XG4gICAgICAgIHJldHVybiB7IHRvdGFsLCBjb21wbGV0ZWQsIGNvbXBsZXRpb25SYXRlIH07XG4gICAgICB9O1xuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBsb25nUmFuZ2VQbGFuczogY2FsY3VsYXRlQ29tcGxldGlvblJhdGUoXG4gICAgICAgICAgbG9uZ1JhbmdlUGxhbnMsXG4gICAgICAgICAgcGxhbiA9PiBwbGFuLmdvYWxzICE9PSBudWxsICYmIHBsYW4uZ29hbHMgIT09ICcnXG4gICAgICAgICksXG4gICAgICAgIHVuaXRQbGFuczogY2FsY3VsYXRlQ29tcGxldGlvblJhdGUoXG4gICAgICAgICAgdW5pdFBsYW5zLFxuICAgICAgICAgIHBsYW4gPT4gcGxhbi5iaWdJZGVhcyAhPT0gbnVsbCAmJiBwbGFuLmJpZ0lkZWFzICE9PSAnJ1xuICAgICAgICApLFxuICAgICAgICBsZXNzb25QbGFuczogY2FsY3VsYXRlQ29tcGxldGlvblJhdGUoXG4gICAgICAgICAgbGVzc29uUGxhbnMsXG4gICAgICAgICAgcGxhbiA9PiBwbGFuLmxlYXJuaW5nR29hbHMgIT09IG51bGwgJiYgcGxhbi5sZWFybmluZ0dvYWxzICE9PSAnJ1xuICAgICAgICApLFxuICAgICAgICBkYXlib29rRW50cmllczogY2FsY3VsYXRlQ29tcGxldGlvblJhdGUoXG4gICAgICAgICAgZGF5Ym9va0VudHJpZXMsXG4gICAgICAgICAgZW50cnkgPT4gZW50cnkud2hhdFdvcmtlZCAhPT0gbnVsbCAmJiBlbnRyeS53aGF0V29ya2VkICE9PSAnJ1xuICAgICAgICApLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZ2VuZXJhdGUgcGxhbm5pbmcgcHJvZ3Jlc3MgcmVwb3J0OicsIGVycm9yKTtcbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGdlbmVyYXRlTGVzc29uUGxhblJlcG9ydChsZXNzb25JZDogc3RyaW5nKTogUHJvbWlzZTxMZXNzb25QbGFuUmVwb3J0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGxlc3NvbiA9IGF3YWl0IHByaXNtYS5lVEZPTGVzc29uUGxhbi5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGxlc3NvbklkIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICB1bml0UGxhbjoge1xuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICBsb25nUmFuZ2VQbGFuOiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGV4cGVjdGF0aW9uczoge1xuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICBleHBlY3RhdGlvbjogdHJ1ZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBkYXlib29rRW50cnk6IHRydWUsXG4gICAgICAgICAgcmVzb3VyY2VzOiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGlmICghbGVzc29uKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTGVzc29uIHBsYW4gbm90IGZvdW5kJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGxlc3Nvbjoge1xuICAgICAgICAgIGlkOiBsZXNzb24uaWQsXG4gICAgICAgICAgdGl0bGU6IGxlc3Nvbi50aXRsZSxcbiAgICAgICAgICBkYXRlOiBsZXNzb24uZGF0ZSxcbiAgICAgICAgICBkdXJhdGlvbjogbGVzc29uLmR1cmF0aW9uLFxuICAgICAgICAgIG1pbmRzT246IGxlc3Nvbi5taW5kc09uIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICBhY3Rpb246IGxlc3Nvbi5hY3Rpb24gfHwgdW5kZWZpbmVkLFxuICAgICAgICAgIGNvbnNvbGlkYXRpb246IGxlc3Nvbi5jb25zb2xpZGF0aW9uIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICBsZWFybmluZ0dvYWxzOiBsZXNzb24ubGVhcm5pbmdHb2FscyB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgbWF0ZXJpYWxzOiBBcnJheS5pc0FycmF5KGxlc3Nvbi5tYXRlcmlhbHMpID8gbGVzc29uLm1hdGVyaWFscyBhcyBzdHJpbmdbXSA6IHVuZGVmaW5lZCxcbiAgICAgICAgICBpc1N1YkZyaWVuZGx5OiBsZXNzb24uaXNTdWJGcmllbmRseSxcbiAgICAgICAgfSxcbiAgICAgICAgaGllcmFyY2h5OiB7XG4gICAgICAgICAgbG9uZ1JhbmdlUGxhbjoge1xuICAgICAgICAgICAgaWQ6IGxlc3Nvbi51bml0UGxhbi5sb25nUmFuZ2VQbGFuLmlkLFxuICAgICAgICAgICAgdGl0bGU6IGxlc3Nvbi51bml0UGxhbi5sb25nUmFuZ2VQbGFuLnRpdGxlLFxuICAgICAgICAgICAgc3ViamVjdDogbGVzc29uLnVuaXRQbGFuLmxvbmdSYW5nZVBsYW4uc3ViamVjdCB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgICBncmFkZTogbGVzc29uLnVuaXRQbGFuLmxvbmdSYW5nZVBsYW4uZ3JhZGUgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgdW5pdFBsYW46IHtcbiAgICAgICAgICAgIGlkOiBsZXNzb24udW5pdFBsYW4uaWQsXG4gICAgICAgICAgICB0aXRsZTogbGVzc29uLnVuaXRQbGFuLnRpdGxlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGN1cnJpY3VsdW1BbGlnbm1lbnQ6IGxlc3Nvbi5leHBlY3RhdGlvbnMubWFwKGV4cCA9PiAoe1xuICAgICAgICAgIGlkOiBleHAuZXhwZWN0YXRpb24uaWQsXG4gICAgICAgICAgY29kZTogZXhwLmV4cGVjdGF0aW9uLmNvZGUsXG4gICAgICAgICAgZGVzY3JpcHRpb246IGV4cC5leHBlY3RhdGlvbi5kZXNjcmlwdGlvbixcbiAgICAgICAgICBzdHJhbmQ6IGV4cC5leHBlY3RhdGlvbi5zdHJhbmQsXG4gICAgICAgIH0pKSxcbiAgICAgICAgcmVmbGVjdGlvbjogbGVzc29uLmRheWJvb2tFbnRyeSA/IHtcbiAgICAgICAgICB3aGF0V29ya2VkOiBsZXNzb24uZGF5Ym9va0VudHJ5LndoYXRXb3JrZWQgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgIG92ZXJhbGxSYXRpbmc6IGxlc3Nvbi5kYXlib29rRW50cnkub3ZlcmFsbFJhdGluZyB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgd291bGRSZXVzZUxlc3NvbjogbGVzc29uLmRheWJvb2tFbnRyeS53b3VsZFJldXNlTGVzc29uIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgfSA6IHVuZGVmaW5lZCxcbiAgICAgICAgcmVzb3VyY2VzOiBsZXNzb24ucmVzb3VyY2VzLm1hcChyZXNvdXJjZSA9PiAoe1xuICAgICAgICAgIGlkOiByZXNvdXJjZS5pZCxcbiAgICAgICAgICB0aXRsZTogcmVzb3VyY2UudGl0bGUsXG4gICAgICAgICAgdHlwZTogcmVzb3VyY2UudHlwZSxcbiAgICAgICAgICB1cmw6IHJlc291cmNlLnVybCB8fCB1bmRlZmluZWQsXG4gICAgICAgIH0pKSxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdlbmVyYXRlIGxlc3NvbiBwbGFuIHJlcG9ydDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZVN1YnN0aXR1dGVQbGFuUmVwb3J0KGxlc3NvbklkOiBzdHJpbmcpOiBQcm9taXNlPFN1YnN0aXR1dGVQbGFuUmVwb3J0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGxlc3NvbiA9IGF3YWl0IHByaXNtYS5lVEZPTGVzc29uUGxhbi5maW5kVW5pcXVlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IGxlc3NvbklkIH0sXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICB1bml0UGxhbjoge1xuICAgICAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgICAgICBsb25nUmFuZ2VQbGFuOiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlc291cmNlczogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIWxlc3Nvbikge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0xlc3NvbiBwbGFuIG5vdCBmb3VuZCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIWxlc3Nvbi5pc1N1YkZyaWVuZGx5KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTGVzc29uIHBsYW4gaXMgbm90IG1hcmtlZCBhcyBzdWJzdGl0dXRlLWZyaWVuZGx5Jyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRpdGxlOiBsZXNzb24udGl0bGUsXG4gICAgICAgIGJhc2ljSW5mbzoge1xuICAgICAgICAgIHN1YmplY3Q6IGxlc3Nvbi51bml0UGxhbi5sb25nUmFuZ2VQbGFuLnN1YmplY3QgfHwgJ05vdCBzcGVjaWZpZWQnLFxuICAgICAgICAgIGdyYWRlOiBsZXNzb24udW5pdFBsYW4ubG9uZ1JhbmdlUGxhbi5ncmFkZSB8fCAwLFxuICAgICAgICAgIGR1cmF0aW9uOiBsZXNzb24uZHVyYXRpb24sXG4gICAgICAgICAgZGF0ZTogbGVzc29uLmRhdGUsXG4gICAgICAgIH0sXG4gICAgICAgIG1hdGVyaWFsczogQXJyYXkuaXNBcnJheShsZXNzb24ubWF0ZXJpYWxzKSA/IGxlc3Nvbi5tYXRlcmlhbHMgYXMgc3RyaW5nW10gOiBbXSxcbiAgICAgICAgYWN0aXZpdGllczoge1xuICAgICAgICAgIG9wZW5pbmc6IGxlc3Nvbi5taW5kc09uIHx8ICcnLFxuICAgICAgICAgIG1haW46IGxlc3Nvbi5hY3Rpb24gfHwgJycsXG4gICAgICAgICAgY2xvc2luZzogbGVzc29uLmNvbnNvbGlkYXRpb24gfHwgJycsXG4gICAgICAgIH0sXG4gICAgICAgIHNwZWNpYWxOb3RlczogbGVzc29uLnN1Yk5vdGVzIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgcmVzb3VyY2VzOiBsZXNzb24ucmVzb3VyY2VzLm1hcChyZXNvdXJjZSA9PiAoe1xuICAgICAgICAgIGlkOiByZXNvdXJjZS5pZCxcbiAgICAgICAgICB0aXRsZTogcmVzb3VyY2UudGl0bGUsXG4gICAgICAgICAgdHlwZTogcmVzb3VyY2UudHlwZSxcbiAgICAgICAgICBjb250ZW50OiByZXNvdXJjZS5jb250ZW50IHx8IHVuZGVmaW5lZCxcbiAgICAgICAgfSkpLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gZ2VuZXJhdGUgc3Vic3RpdHV0ZSBwbGFuIHJlcG9ydDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICBhc3luYyBnZW5lcmF0ZVVuaXRPdmVydmlld1JlcG9ydCh1bml0SWQ6IHN0cmluZyk6IFByb21pc2U8VW5pdE92ZXJ2aWV3UmVwb3J0PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVuaXQgPSBhd2FpdCBwcmlzbWEudW5pdFBsYW4uZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkOiB1bml0SWQgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIGxvbmdSYW5nZVBsYW46IHRydWUsXG4gICAgICAgICAgZXhwZWN0YXRpb25zOiB7XG4gICAgICAgICAgICBpbmNsdWRlOiB7XG4gICAgICAgICAgICAgIGV4cGVjdGF0aW9uOiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGxlc3NvblBsYW5zOiB0cnVlLFxuICAgICAgICAgIHJlc291cmNlczogdHJ1ZSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAoIXVuaXQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbml0IHBsYW4gbm90IGZvdW5kJyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHRvdGFsRHVyYXRpb24gPSB1bml0Lmxlc3NvblBsYW5zLnJlZHVjZSgoc3VtLCBsZXNzb24pID0+IHN1bSArIGxlc3Nvbi5kdXJhdGlvbiwgMCk7XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVuaXQ6IHtcbiAgICAgICAgICBpZDogdW5pdC5pZCxcbiAgICAgICAgICB0aXRsZTogdW5pdC50aXRsZSxcbiAgICAgICAgICBkZXNjcmlwdGlvbjogdW5pdC5kZXNjcmlwdGlvbiB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgYmlnSWRlYXM6IHVuaXQuYmlnSWRlYXMgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgIHN0YXJ0RGF0ZTogdW5pdC5zdGFydERhdGUsXG4gICAgICAgICAgZW5kRGF0ZTogdW5pdC5lbmREYXRlLFxuICAgICAgICAgIGVzdGltYXRlZEhvdXJzOiB1bml0LmVzdGltYXRlZEhvdXJzLFxuICAgICAgICB9LFxuICAgICAgICBoaWVyYXJjaHk6IHtcbiAgICAgICAgICBsb25nUmFuZ2VQbGFuOiB7XG4gICAgICAgICAgICBpZDogdW5pdC5sb25nUmFuZ2VQbGFuLmlkLFxuICAgICAgICAgICAgdGl0bGU6IHVuaXQubG9uZ1JhbmdlUGxhbi50aXRsZSxcbiAgICAgICAgICAgIHN1YmplY3Q6IHVuaXQubG9uZ1JhbmdlUGxhbi5zdWJqZWN0IHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGdyYWRlOiB1bml0LmxvbmdSYW5nZVBsYW4uZ3JhZGUgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGN1cnJpY3VsdW1BbGlnbm1lbnQ6IHVuaXQuZXhwZWN0YXRpb25zLm1hcChleHAgPT4gKHtcbiAgICAgICAgICBpZDogZXhwLmV4cGVjdGF0aW9uLmlkLFxuICAgICAgICAgIGNvZGU6IGV4cC5leHBlY3RhdGlvbi5jb2RlLFxuICAgICAgICAgIGRlc2NyaXB0aW9uOiBleHAuZXhwZWN0YXRpb24uZGVzY3JpcHRpb24sXG4gICAgICAgICAgc3RyYW5kOiBleHAuZXhwZWN0YXRpb24uc3RyYW5kLFxuICAgICAgICB9KSksXG4gICAgICAgIGxlc3NvblN1bW1hcnk6IHtcbiAgICAgICAgICB0b3RhbExlc3NvbnM6IHVuaXQubGVzc29uUGxhbnMubGVuZ3RoLFxuICAgICAgICAgIHRvdGFsRHVyYXRpb24sXG4gICAgICAgICAgbGVzc29uczogdW5pdC5sZXNzb25QbGFucy5tYXAobGVzc29uID0+ICh7XG4gICAgICAgICAgICBpZDogbGVzc29uLmlkLFxuICAgICAgICAgICAgdGl0bGU6IGxlc3Nvbi50aXRsZSxcbiAgICAgICAgICAgIGRhdGU6IGxlc3Nvbi5kYXRlLFxuICAgICAgICAgICAgZHVyYXRpb246IGxlc3Nvbi5kdXJhdGlvbixcbiAgICAgICAgICB9KSksXG4gICAgICAgIH0sXG4gICAgICAgIHJlc291cmNlczogdW5pdC5yZXNvdXJjZXMubWFwKHJlc291cmNlID0+ICh7XG4gICAgICAgICAgaWQ6IHJlc291cmNlLmlkLFxuICAgICAgICAgIHRpdGxlOiByZXNvdXJjZS50aXRsZSxcbiAgICAgICAgICB0eXBlOiByZXNvdXJjZS50eXBlLFxuICAgICAgICB9KSksXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBnZW5lcmF0ZSB1bml0IG92ZXJ2aWV3IHJlcG9ydDonLCBlcnJvcik7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IHJlcG9ydEdlbmVyYXRvclNlcnZpY2UgPSBuZXcgUmVwb3J0R2VuZXJhdG9yU2VydmljZSgpOyJdLCJ2ZXJzaW9uIjozfQ==