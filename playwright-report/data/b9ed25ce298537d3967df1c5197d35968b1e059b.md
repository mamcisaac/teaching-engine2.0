# Test info

- Name: debug login network
- Location: /Users/michaelmcisaac/GitHub/teaching-engine2.0/tests/e2e/debug-login-network.spec.ts:4:5

# Error details

```
TimeoutError: page.waitForURL: Timeout 10000ms exceeded.
=========================== logs ===========================
waiting for navigation to "**/subjects" until "load"
  navigated to "http://localhost:5173/"
============================================================
    at /Users/michaelmcisaac/GitHub/teaching-engine2.0/tests/e2e/debug-login-network.spec.ts:56:16
```

# Page snapshot

```yaml
- heading "Welcome to Teaching Engine" [level=2]
- list:
    - listitem: Auto-fill your week plan.
    - listitem: Prepare materials.
    - listitem: Send a newsletter.
- button "Got it"
- textbox: 2025-06-09
- button "Auto Fill"
- checkbox "Preserve daily buffer block" [checked]
- text: Preserve daily buffer block
- checkbox "Skip lowest priority activity on short weeks" [checked]
- text: Skip lowest priority activity on short weeks Mon Plant Parts 1 + 1 Tue Animal Habitats 2 + 3 Wed Healthy Bodies Subtraction Basics Thu H1749864472950 Number Patterns Fri Healthy Minds Math Games
- button "Download Printables"
- heading "Suggestions" [level=2]
- list:
    - button "Activity 1"
    - button "Activity M"
    - button "Activity 2"
    - button "1 + 1"
    - button "2 + 3"
    - button "Subtraction Basics"
    - button "Number Patterns"
    - button "Math Games"
    - button "Plant Parts"
    - button "Animal Habitats"
    - button "Life Cycles"
    - button "Ecosystems"
    - button "Science Experiment"
    - button "Healthy Bodies"
    - button "Healthy Minds"
    - button "Nutrition"
    - button "Exercise"
    - button "Mindfulness"
    - button "Reading Short Stories"
    - button "Creative Writing"
    - button "Spelling Practice"
    - button "Reading Comprehension"
    - button "Show and Tell"
    - button "Community Helpers"
    - button "Cultural Celebrations"
    - button "Map Skills"
    - button "Historical Figures"
    - button "Current Events"
    - button "Math Worksheet"
    - button "Science Experiment"
    - button "Health Discussion"
    - button "Free Reading"
    - button "Current Events"
    - button "LongAct"
    - button "ShortAct"
    - button "HA"
- status
- button "+ Add Event"
- text: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30
- region "Notifications alt+T"
```

# Test source

```ts
   1 | // This file is used for debugging login network requests
   2 | import { test, expect } from '@playwright/test';
   3 |
   4 | test('debug login network', async ({ page }) => {
   5 |   // Enable request interception
   6 |   await page.route('**/*', route => {
   7 |     console.log(`Request: ${route.request().method()} ${route.request().url()}`);
   8 |     route.continue();
   9 |   });
  10 |
  11 |   // Listen to all responses
  12 |   page.on('response', response => {
  13 |     console.log(`Response: ${response.status()} ${response.statusText()} - ${response.url()}`);
  14 |     if (response.status() >= 400) {
  15 |       console.log('Error response:', response.status(), response.statusText());
  16 |       response.text().then(body => {
  17 |         console.log('Response body:', body);
  18 |       }).catch(e => console.log('Could not read response body:', e));
  19 |     }
  20 |   });
  21 |
  22 |   // First try to login via API
  23 |   console.log('Making API login request to port 3001...');
  24 |   const loginResponse = await fetch('http://localhost:3001/api/login', {
  25 |     method: 'POST',
  26 |     headers: {
  27 |       'Content-Type': 'application/json'
  28 |     },
  29 |     body: JSON.stringify({
  30 |       email: 'teacher@example.com',
  31 |       password: 'password123'
  32 |     })
  33 |   });
  34 |
  35 |   console.log('Login response status:', loginResponse.status);
  36 |   const loginData = await loginResponse.json().catch(() => ({}));
  37 |   console.log('Login response data:', JSON.stringify(loginData, null, 2));
  38 |
  39 |   if (!loginResponse.ok) {
  40 |     throw new Error(`Login failed with status ${loginResponse.status}`);
  41 |   }
  42 |
  43 |   // Navigate to the login page
  44 |   console.log('Navigating to login page...');
  45 |   await page.goto('http://localhost:5173/login', { waitUntil: 'networkidle' });
  46 |
  47 |   console.log('Page loaded. Filling login form...');
  48 |   await page.fill('#email-address', 'teacher@example.com');
  49 |   await page.fill('#password', 'password123');
  50 |
  51 |   console.log('Submitting form...');
  52 |   await page.click('button[type="submit"]');
  53 |
  54 |   // Wait for navigation or error
  55 |   try {
> 56 |     await page.waitForURL('**/subjects', { timeout: 10000 });
     |                ^ TimeoutError: page.waitForURL: Timeout 10000ms exceeded.
  57 |     console.log('Successfully navigated to subjects page');
  58 |   } catch (error) {
  59 |     console.error('Navigation to subjects page failed. Current URL:', page.url());
  60 |     console.error('Page title:', await page.title());
  61 |
  62 |     // Check for error messages
  63 |     const errorMessages = await page.$$eval('*', elements =>
  64 |       elements
  65 |         .filter(el => {
  66 |           const text = el.textContent?.trim() || '';
  67 |           return text.length > 0 && text.length < 200 &&
  68 |                  (text.toLowerCase().includes('error') ||
  69 |                   text.toLowerCase().includes('fail') ||
  70 |                   text.toLowerCase().includes('invalid'));
  71 |         })
  72 |         .map(el => ({
  73 |           text: el.textContent?.trim(),
  74 |           tag: el.tagName,
  75 |           id: el.id,
  76 |           class: el.className
  77 |         }))
  78 |     );
  79 |
  80 |     if (errorMessages.length > 0) {
  81 |       console.error('Error messages on page:', JSON.stringify(errorMessages, null, 2));
  82 |     }
  83 |
  84 |     throw error;
  85 |   }
  86 | });
  87 |
```
